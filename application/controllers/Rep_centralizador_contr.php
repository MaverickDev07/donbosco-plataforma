<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class Rep_centralizador_contr extends CI_Controller {

	  

	public function __construct()
	{
		parent::__construct();		
		//$this->load->helper(array('url', 'form'));
		$this->load->helper('url');
		$this->load->model('Rep_centralizador_model','estud');
		//$this->load->model('Config_curso_model','curso');
		$this->load->library('excel');
		$this->load->library('drawing');
 
		if(!$this->session->userdata("login")) 
		{
			$bu='http://'.$_SERVER['HTTP_HOST'].'/donbosco/';			
			header("Location: ".$bu);
		}
	} 

	public function index()
	{ 
		$this->load->helper('url');
		$this->vista();		
	}
 
	public function vista()
	{
		$this->load->view('layouts/inicio');
		$this->load->view('layouts/encabezado');
		$this->load->view('Rep_centralizador_view');
		$this->load->view('layouts/fin');
	}
	// public function ajax_get_id()
	// {
	// 	//valores enviados 
	// 	$table=$this->input->post('table');
	// 	$cod=$this->input->post('cod');

	// 	$codgen='';
	// 	$num_rows=$this->curso->get_count_rows($table);
	// 	if($num_rows!=0)
	// 	{
	// 		$n=strlen($cod);		
	// 		$list = $this->curso->get_idcod_table($table);
	// 		$may=0;
				
	// 		foreach ($list as $codigo) {	
	// 			$idcod=$codigo->idcurso;//considerar nombre del id;				
	// 			$newcod=substr($idcod,$n,strlen($idcod));
	// 	        if($newcod>=$may)
	// 	        {
	// 	            $may=$newcod;    
	// 	        }
	// 		}
	// 		$may=$may+1;
	// 		$codgen=$cod."".$may;
	// 	}
	// 	else
	// 	{
	// 		$codgen=$cod.'1';	
	// 	}
		
	// 	echo json_encode(array("status"=>TRUE,"codgen"=>$codgen));
	// }

	public function ajax_cerrar()
	{
		$this->session->sess_destroy();
		$bu='http://'.$_SERVER['HTTP_HOST'].'/donbosco/';			
		header("Location: ".$bu);
		//echo json_encode(array("status" => TRUE));

	}
	
	/*
	public function ajax_list()
	{
		
		$list=$this->estud->get_datatables();
		$data = array();
		$no = $_POST['start'];
		//print_r($list);
		
		foreach ($list as $estudiante) {
			$no++;
			$row = array();
			$row[] = $estudiante->idest;
			$row[] = $estudiante->rude;
			$row[] = $estudiante->ci;
			$row[] = $estudiante->appaterno;
			$row[] = $estudiante->apmaterno;
			$row[] = $estudiante->nombres;
			$row[] = $estudiante->genero;
			$row[] = $estudiante->idcurso;	
			$row[] = $estudiante->codigo;
			//$row[] = "<img src='".$estudiante->foto."' width='100' height='100'>";

			//add html for action
			$row[] = '<a class="btn btn-sm bg-green-800" href="javascript:void(0)" title="Edit" onclick="edit_estud('."'".$estudiante->idest."'".')"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
				<a class="btn btn-sm btn-danger" href="javascript:void(0)" title="Hapus" onclick="delete_estud('."'".$estudiante->idest."'".')"><i class="glyphicon glyphicon-trash"></i> Eliminar</a>';
		
			$data[] = $row;

		}

		$output = array(
						"draw" => $_POST['draw'],
						"recordsTotal" => $this->estud->count_all(),
						"recordsFiltered" => $this->estud->count_filtered(),
						"data" => $data,
				);

		echo json_encode($output);

	}
*/
	public function ajax_get_gestion()
	{
		$table=$this->input->post('table');//recibe
		$list=$this->estud->get_rows_gestion($table); //envia
		$data=array();
		foreach ($list as $gestion) {			
			$data[] =$gestion->gestion;					 
		}
		$output = array(
						"status" => TRUE,
						"data" => $data,
				);
		echo json_encode($output);
	}

	public function ajax_delete($id)
	{
		$this->estud->delete_by_id($id);
		echo json_encode(array("status"=>TRUE));
	}

	public function ajax_edit_estud($id)
	{
		//print_r($id);
		$data=$this->estud->get_by_id($id);
		echo json_encode($data);
	}

	public function ajax_update_estud()
	{
		//valores enviados 
		$data=array(
			//'idest'=>$this->input->post('idest'),
			'rude'=>$this->input->post('rude'),
			'ci'=>$this->input->post('ci'),
			'appaterno'=>$this->input->post('appaterno'),
			'apmaterno'=>$this->input->post('apmaterno'),
			'nombres'=>$this->input->post('nombre'),
			'genero'=>$this->input->post('genero'),
			'codigo'=>$this->input->post('codigo'),
			'foto'=>$this->input->post('foto'),
		);

		
		$this->estud->update(array('idest'=>$this->input->post('idest')),$data);

		echo json_encode(array("status"=>TRUE));
	}

	public function ajax_get_nivel()
	{
		$table=$this->input->post('table');//recibe
		$list=$this->estud->get_rows_nivel($table); //envia
		$data=array();
		foreach ($list as $nivel) {			
			$data[] =$nivel->nivel." ".$nivel->turno;					 
		}
		$output = array(
						"status" => TRUE,
						"data" => $data,
				);
		echo json_encode($output);
	}
	public function migra($id)
	{
		if($this->session->userdata("id1")=='US-188'){	
			$ids=explode('_', $id, -1);
			$bi=$ids[0];
			$codigo=$ids[1];
			$nivel=$ids[3];
			$materia=$this->estud->get_materias();
			$bimestre=$this->estud->get_bimestres();
			$estudiante=$this->estud->get_estudiantes($nivel);
			//print_r($estudiante);exit();
			
			foreach ($estudiante as $estudiantes) {	
				foreach ($materia as $materias) {	
				foreach ($bimestre as $bimestres) {	
					
					if($bimestres->id_bi==6){  		
						$notas=$this->estud->promedio_nota1($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);  
					}  
					if($bimestres->id_bi==7){  	
						$notas=$this->estud->promedio_nota2($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);  
						
					}
					/* secundaria 3ros
					if($materias->id_mat!=1 and $materias->id_mat!=14 and $materias->id_mat!=21 ){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);  
						}

						if($materias->id_mat==21){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,21,2020,$bimestres->id_bi,$estudiantes->id_est);  
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,22,2020,$bimestres->id_bi,$estudiantes->id_est);   
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,23,2020,$bimestres->id_bi,$estudiantes->id_est);    
						} 

						if($materias->id_mat==1){	
							$notas=$this->estud->promedio_nota1(2,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$final2=round(($final+$final1)/2);
							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,1,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==14){	
							$notas=$this->estud->promedio_nota1(15,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$notas=$this->estud->promedio_nota1(16,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final3=0;
							}else{
								$final3=$notas->final;
							}
							$final2=round(($final+$final1+$final3)/3);  
							$notas=$this->estud->promedio_nota11(18,$estudiantes->id_est);
							if($notas->final!=0){

							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,18,2020,$bimestres->id_bi,$estudiantes->id_est);
							}  
							$notas=$this->estud->promedio_nota11(19,$estudiantes->id_est);
							if($notas->final!=0){

							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,19,2020,$bimestres->id_bi,$estudiantes->id_est);
							} */
					/*secudaria 5 B


						if($materias->id_mat!=12){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);
						}

						if($materias->id_mat==12){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,12,2020,$bimestres->id_bi,$estudiantes->id_est);  
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,26,2020,$bimestres->id_bi,$estudiantes->id_est);    
						} */
					//print_r($estudiante);
					//exit();
					/*if(is_null($notas))
					{
						$final=0;
					}else{
						$final=$notas->final;
					}*/
					/*
					SECUDARIA PRIMERO
					if($bimestres->id_bi==6){  		
						$notas=$this->estud->promedio_nota1($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						if($materias->id_mat!=13 or $materias->id_mat!=20 or $materias->id_mat!=25 or $materias->id_mat!=3 or $materias->id_mat!=1){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 

						if($materias->id_mat==1){	
							$notas=$this->estud->promedio_nota1(3,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$final2=round(($final+$final1)/2);
							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,1,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 

						if($materias->id_mat==3){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,4,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==13){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,14,2020,$bimestres->id_bi,$estudiantes->id_est);  
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,15,2020,$bimestres->id_bi,$estudiantes->id_est); 
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,16,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==20){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,21,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==25){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,24,2020,$bimestres->id_bi,$estudiantes->id_est);   
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,25,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
					}  
					if($bimestres->id_bi==7){  	
						$notas=$this->estud->promedio_nota2($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						if($materias->id_mat!=13 or $materias->id_mat!=20 or $materias->id_mat!=25 or $materias->id_mat!=3 or $materias->id_mat!=1){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 

						if($materias->id_mat==1){	
							$notas=$this->estud->promedio_nota2(3,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$final2=round(($final+$final1)/2);



			//print_r($final2);
			//exit();	
							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,1,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 

						if($materias->id_mat==3){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,4,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==13){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,14,2020,$bimestres->id_bi,$estudiantes->id_est);  
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,15,2020,$bimestres->id_bi,$estudiantes->id_est); 
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,16,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==20){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,21,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						if($materias->id_mat==25){	
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,24,2020,$bimestres->id_bi,$estudiantes->id_est);   
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,25,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
					}
					*/
					/*SECUNDARIA 4to
					if($bimestres->id_bi==6){  		
						$notas=$this->estud->promedio_nota1($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						if($materias->id_mat!=1){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);
						}   

						if($materias->id_mat==1){	
							$notas=$this->estud->promedio_nota1(2,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$final2=round(($final+$final1)/2);
							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,1,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 

					}  
					if($bimestres->id_bi==7){  	
						$notas=$this->estud->promedio_nota2($materias->id_mat,$estudiantes->id_est); 
						if(is_null($notas))
						{
							$final=0;
						}else{
							$final=$notas->final;
						}
						if($materias->id_mat!=1){
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bimestres->id_bi,$estudiantes->id_est);  
						}  

						if($materias->id_mat==1){	
							$notas=$this->estud->promedio_nota2(2,$estudiantes->id_est); 
							if(is_null($notas))
							{
								$final1=0;
							}else{
								$final1=$notas->final;
							}
							$final2=round(($final+$final1)/2);
							$modificar=$this->estud->nota_bimestre($final2,$estudiantes->codigo,1,2020,$bimestres->id_bi,$estudiantes->id_est);   
						} 
						
					}*/
					/*if($materias->id_mat!=14 or $materias->id_mat!=21){
						
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,$materias->id_mat,2020,$bi,$estudiantes->id_est); 
					} 

					if($materias->id_mat==14){	
						$electronica=$this->estud->nota_materias(19,$estudiantes->id_est,2020);
						$sistemas=$this->estud->nota_materias(18,$estudiantes->id_est,2020);
						print_r($sistemas);
						print_r($electronica);
						exit();
						if($electronica->notabi1!=0)
						{
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,19,2020,$bi,$estudiantes->id_est);  
						} 
						if($sistemas->notabi1!=0)
						{
							$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,18,2020,$bi,$estudiantes->id_est);  
						}  
					} 
					if($materias->id_mat==21){	
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,21,2020,$bi,$estudiantes->id_est);  
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,22,2020,$bi,$estudiantes->id_est); 
						$modificar=$this->estud->nota_bimestre($final,$estudiantes->codigo,23,2020,$bi,$estudiantes->id_est);   
					}*/ 
				}	
		    	}	    
	    	}

			print_r($estudiante);
			exit();
		}
	}

	public function ajax_get_level()
	{
		$table=$this->input->post('table');//recibe
		$lvl=$this->input->post('lvl');

		
		$list=$this->estud->get_rows_level($table,$lvl); //envia

		$data=array();
		foreach ($list as $level) {			
			$data[] =$level->gestion;					 
			$data[] =$level->colegio;
			$data[]	=$level->idcurso;
			$data[]	=$level->curso;				 				 
		}
		$output = array(
						"status" => TRUE,
						"data" => $data,
				);
		echo json_encode($output);
	}


	public function ajax_get_curso()
	{
		$tablecur=$this->input->post('TablaCur');
		$nivel=$this->input->post("nivel");

		//print_r($tablecur."-".$nivel);

		$list=$this->estud->get_rows_curso($tablecur,$nivel);

		$data=array();
		foreach ($list as $curso){
			$data[]=$curso->curso;
		}
		$output=array(
			"status"=>TRUE,
			"data"=>$data,
		);

		echo json_encode($output);
	}

	public function ajax_get_idcurso()
	{		
		$nivel=$this->input->post('nivel');
		$curso=$this->input->post('curso');
		$list=$this->estud->get_idcurso($nivel,$curso);

		$data=array();
		foreach($list as $idcur)
		{
			$data[]=$idcur->idcurso;
		}
		$output=array(
			"status"=>TRUE,
			"data"=>$data,
		);

		echo json_encode($output);
		//print_r($nivel."-".$gestion."-".$colegio."-".$curso);	
	}



	public function ajax_load_sql()
	{

		$notlimit=$this->input->post('notlimit');
		$idcur=$this->input->post('idcur');
		$bimes=$this->input->post('bimes');
		$gestion=$this->input->post('gestion');
		$nivel=$this->input->post('nivel');
		$curso=$this->input->post('curso');

		if(($nivel=='PRIMARIA MAÑANA')OR($nivel=='PRIMARIA TARDE'))
		{
			$idsql="primaria";
		
			$list=$this->estud->ejec_sql($notlimit,$idcur,$bimes,$gestion,$idsql,$curso);
		
			$data = array();
					
			foreach ($list as $centr) {

				$row = array();

				$row[] = $centr->idest;
				$row[] = $centr->appat;
				$row[] = $centr->apmat;
				$row[] = $centr->nombres;
				$row[] = "<input  type='text' class='form-control'  value='".$centr->LENGUAJE."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->INGLES."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".round((($centr->LENGUAJE+$centr->INGLES)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";			
				$row[] = "<input  type='text' class='form-control'  value='".$centr->SOCIALES."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->EDUFISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->MUSICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->ARTPLAST."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->MATEMATICAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->INFORMATICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->CIENCIAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".$centr->RELIGION."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
				$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->LENGUAJE+$centr->INGLES)/2),0)+$centr->SOCIALES+$centr->EDUFISICA+ $centr->MUSICA+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+$centr->RELIGION)/9),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

				$data[] = $row;

			}
			$output=array(
						"status"=>TRUE,
						"data"=>$data,
					);
			echo json_encode($output);
		}

		if(($nivel=='SECUNDARIA MAÑANA')OR($nivel=='SECUNDARIA TARDE'))
		{
			$idsql="secundaria";

			if(($curso=='PRIMERO A')OR($curso=='PRIMERO B')OR($curso=='SEGUNDO A')OR($curso=='SEGUNDO B'))
			{		
				$list=$this->estud->ejec_sql($notlimit,$idcur,$bimes,$gestion,$idsql,$curso);				

				$data = array();
						
				foreach ($list as $centr) {

					$row = array();

					$row[] = $centr->idest;
					$row[] = $centr->appat;
					$row[] = $centr->apmat;
					$row[] = $centr->nombres;
					$row[] = "<input  type='text' class='form-control'  value='".$centr->LENGUAJE."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUECHUA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->INGLES1+$centr->INGLES2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";		
					$row[] = "<input  type='text' class='form-control'  value='".$centr->SOCIALES."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->EDUFISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->MUSICA1+$centr->MUSICA2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->ARTPLAST."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2)+$centr->ARTPLAST)/6),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->MATEMATICAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->INFORMATICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->MATEMATICAS+$centr->INFORMATICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->CIENCIAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->FISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUIMICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->FISICA+$centr->QUIMICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->CIENCIAS)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->COSMO."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->RELIGION."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->COSMO+$centr->RELIGION)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$row[] = "<input  type='text' class='form-control'  value='".round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2)+$centr->ARTPLAST+$centr->MATEMATICAS+round((($centr->INFORMATICA+$centr->FISICA+$centr->QUIMICA)/3),0)+$centr->CIENCIAS+$centr->COSMO+$centr->RELIGION)/11,0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$data[] = $row;					

				}
				$output=array(
						"status"=>TRUE,
						"data"=>$data,
					);
				echo json_encode($output);
			}

			if(($curso=='TERCERO A')OR($curso=='TERCERO B'))
			{		
				$list=$this->estud->ejec_sql($notlimit,$idcur,$bimes,$gestion,$idsql,$curso);				

				$data = array();
						
				foreach ($list as $centr) {

					$row = array();

					$row[] = $centr->idest;
					$row[] = $centr->appat;
					$row[] = $centr->apmat;
					$row[] = $centr->nombres;
					$row[] = "<input  type='text' class='form-control'  value='".$centr->LENGUAJE."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUECHUA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->INGLES1+$centr->INGLES2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";		
					$row[] = "<input  type='text' class='form-control'  value='".$centr->SOCIALES."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->EDUFISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->ARTPLAST."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST)/6),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->MATEMATICAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->INFORMATICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->MATEMATICAS+$centr->INFORMATICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->CIENCIAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->FISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUIMICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->FISICA+$centr->QUIMICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->CIENCIAS)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->COSMO."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->RELIGION."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->COSMO+$centr->RELIGION)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$row[] = "<input  type='text' class='form-control'  value='".round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$data[] = $row;					

				}
				$output=array(
						"status"=>TRUE,
						"data"=>$data,
					);
				echo json_encode($output);
			}
			if(($curso=='CUARTO A')OR($curso=='CUARTO B'))
			{		
				$list=$this->estud->ejec_sql($notlimit,$idcur,$bimes,$gestion,$idsql,$curso);				

				$data = array();
						
				foreach ($list as $centr) {

					$row = array();

					$row[] = $centr->idest;
					$row[] = $centr->appat;
					$row[] = $centr->apmat;
					$row[] = $centr->nombres;
					$row[] = "<input  type='text' class='form-control'  value='".$centr->LENGUAJE."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->INGLES1+$centr->INGLES2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";		
					$row[] = "<input  type='text' class='form-control'  value='".$centr->SOCIALES."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->EDUFISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->ARTPLAST."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST)/6),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->MATEMATICAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->INFORMATICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->MATEMATICAS+$centr->INFORMATICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->CIENCIAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->FISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUIMICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->FISICA+$centr->QUIMICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->CIENCIAS)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->COSMO."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->RELIGION."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->COSMO+$centr->RELIGION)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$row[] = "<input  type='text' class='form-control'  value='".$notafinal=round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$data[] = $row;					

				}
				$output=array(
						"status"=>TRUE,
						"data"=>$data,
					);
				echo json_encode($output);
			}
			if(($curso=='QUINTO A')OR($curso=='QUINTO B')OR($curso=='SEXTO A')OR($curso=='SEXTO B'))
			{		
				$list=$this->estud->ejec_sql($notlimit,$idcur,$bimes,$gestion,$idsql,$curso);				

				$data = array();
						
				foreach ($list as $centr) {

					$row = array();

					$row[] = $centr->idest;
					$row[] = $centr->appat;
					$row[] = $centr->apmat;
					$row[] = $centr->nombres;
					$row[] = "<input  type='text' class='form-control'  value='".$centr->LENGUAJE."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->INGLES1+$centr->INGLES2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";		
					$row[] = "<input  type='text' class='form-control'  value='".$centr->HISTORIA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->CIVICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->HISTORIA+$centr->CIVICA)/2),0)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->EDUFISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->ARTPLAST."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+round((($centr->HISTORIA+$centr->CIVICA)/2),0)+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST)/6),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->MATEMATICAS."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".($centr->INFORMATICA1+$centr->INFORMATICA2)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->MATEMATICAS+($centr->INFORMATICA1+$centr->INFORMATICA2))/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->BIOLOGIA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->GEOGRAFIA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->BIOLOGIA+$centr->GEOGRAFIA)/2),0)."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->FISICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->QUIMICA."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->FISICA+$centr->QUIMICA)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round(((round((($centr->FISICA+$centr->QUIMICA)/2),0)+round((($centr->BIOLOGIA+$centr->GEOGRAFIA)/2),0))/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->COSMO."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".$centr->RELIGION."' style='width: 60px; border:1px solid #FFB74D;' readonly='true'>";
					$row[] = "<input  type='text' class='form-control'  value='".round((($centr->COSMO+$centr->RELIGION)/2),0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					$row[] = "<input  type='text' class='form-control'  value='".round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+(($centr->HISTORIA+$centr->CIVICA)/2)+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+($centr->INFORMATICA1+$centr->INFORMATICA2)+(($centr->FISICA+$centr->QUIMICA)/2)+(($centr->BIOLOGIA+$centr->GEOGRAFIA)/2)+$centr->COSMO+$centr->RELIGION)/12,0)."'  style='width: 60px; border:1px solid #64B5F6;' readonly='true'>";

					
					$data[] = $row;					

				}
				$output=array(
						"status"=>TRUE,
						"data"=>$data,
					);
				echo json_encode($output);
			}
		}

	}
	/*boletines*/
	public function boletines($id) //impresion centralizador
	{
		$this->load->library('pdf');
		// $this->pdf=new FPDF('P','cm','Legal');
		ob_start();
		$this->pdf=new FPDF('L','mm',array(215.9,333.0));
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		//$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		$list=$this->estud->gest_est($codigo,$gestion);
		
		$ni=$this->estud->get_niveles($nivel);
		foreach ($ni as $nis) {
			$niveles=$nis->nivel;
			$turno=$nis->turno;
			$ninombre=$nis->nombrec;
			$id_col=$nis->id_col;
		}
		$col=$this->estud->get_colegio($id_col);
		foreach ($col as $cols) 
		{
			$colegio=$cols->nombre;
		}
		$bim=$this->estud->get_bimestre($bi);
		foreach ($bim as $bims) 
		{
			$bimestre=$bims->nombre;
		}
		$cur1=$this->estud->get_cursos($cur);
		foreach ($cur1 as $curs) 
		{
			$cursos=$curs->nombre;
		}
		if($nivel=='PM' OR $nivel=='PT'  ){
			foreach ($list as $estud) {
				$mate=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,5,$gestion);
				$mate2=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,6,$gestion);
				//print_r($mate2);
				//exit();
				$mate3=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,7,$gestion);
				//$mate4=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,4,$gestion);
				$this->pdf->AddPage('L',array(215.9,333.0)); 
					//$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        $this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
				$this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
				$this->pdf->Cell(30);
				$this->pdf->setXY(80,20);
				$this->pdf->SetFont('Arial','B',18);
				$this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
				$this->pdf->Line(10,30,320,30);
				$this->pdf->Ln('15');
				$this->pdf->Cell(30);
				$this->pdf->setXY(15,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
				$this->pdf->setXY(60,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');
				
				$this->pdf->setXY(165,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
				$this->pdf->setXY(180,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');
				
				$this->pdf->setXY(230,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
				$this->pdf->setXY(250,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');
				
				$this->pdf->setXY(15,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
				$this->pdf->setXY(60,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');
				
				$this->pdf->setXY(130,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
				$this->pdf->setXY(178,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

	   		$this->pdf->setXY(0,60);
	   		$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Ln(5);
				$this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
				$this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
				$this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
				$this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Ln(7);

				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 10);
				$this->pdf->Cell(60,49,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
				$this->pdf->Cell(60,14,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
				$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,14,round(($mate[1]->ingles+$mate[0]->lenguaje)/2),'TBLR',0,'C','1');
				if($bi>=6){
					$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,14,round(($mate2[1]->ingles+$mate2[0]->lenguaje)/2),'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,14,round(($mate3[1]->ingles+$mate3[0]->lenguaje)/2),'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
				}
				// if ($bi>=4) {
				// 	$this->pdf->Cell(16.3,7,$mate4[0]->lenguaje,'TBLR',0,'C','1');
				// 	$this->pdf->Cell(16.3,14,round(($mate4[1]->ingles+$mate4[0]->lenguaje)/2),'TBLR',0,'C','1');
				// } else {
				// 	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				// 	$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
				// }
				$this->pdf->Ln(7);
				$this->pdf->SetX(130);
				$this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
				$this->pdf->SetX(222.6);
				if($bi>=6){
					$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
				} else {
	    		$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
	    	$this->pdf->SetX(255.2);
				if($bi>=7){
					$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
				} else {
	    		$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	}
	    	$this->pdf->SetX(287.8);

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,14,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[6]->matematicas,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[6]->matematicas,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[6]->matematicas,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[6]->matematicas,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[6]->matematicas,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[6]->matematicas,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'TECNICA TECNOLOGICA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[7]->informatica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[7]->informatica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[7]->informatica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[7]->informatica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				if($bi>=7){
					$this->pdf->Cell(16.3,7,$mate3[7]->informatica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[7]->informatica,'TBLR',0,'C','1');
	    	} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,7,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[8]->maturales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[8]->maturales,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[8]->maturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[8]->maturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[8]->maturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[8]->maturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,7,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'V. ESPI. Y RELIGION','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'VALORES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[9]->religion,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[9]->religion,'TBLR',0,'C','1');
				
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[9]->religion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[9]->religion,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	}

	    	if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[9]->religion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[9]->religion,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
        
				$this->pdf->Line(10,48,320,48);
				$this->pdf->Ln('12');
	    	/*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
				$this->pdf->AddPage(); 
				$this->pdf->Line(10,12,320,12);
				$this->pdf->AliasNbPages();
				
				//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->setXY(10,2);
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
				$this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');
				
				$kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
				//$reprobados=$ids[5];
				//print_r($kardex);
				//exit();
				$this->pdf->SetFont('Arial', '', 13);
				$this->pdf->setXY(10,15);
				$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
				$this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
				$this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
				$this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 13);
				
				$i=0;
				foreach ($kardex as $kardexs){
					$i++;
					$this->pdf->Ln(7);
					$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
					$this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
					$this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
					$this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
				}

				if($i>=25){
					$this->pdf->AddPage(); 
					//$this->pdf->Line(10,12,320,12);
				}
			}
			
			$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
			ob_end_flush();
    }
  	
		if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ) {
			//&&$pdf->AddPage('P','Legal'); 
    	foreach ($list as $estud) {
				$mate=$this->estud->get_mate($estud->id_est,1,27,4,5,9,10,11,12,14,15,16,21,24,25,5,$gestion);	
				$mate2=$this->estud->get_mate($estud->id_est,1,27,4,5,9,10,11,12,14,15,16,21,24,25,6,$gestion);	
				$mate3=$this->estud->get_mate($estud->id_est,1,27,4,5,9,10,11,12,14,15,16,21,24,25,7,$gestion);	
				//$this->pdf->AddPage('L',array(215.9,333.0)); 
				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        $this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
				$this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
				$this->pdf->Cell(30);            
				$this->pdf->setXY(80,20);
				$this->pdf->SetFont('Arial','B',18);
				$this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
				$this->pdf->Line(10,30,320,30);		
				$this->pdf->Ln('15');            
				$this->pdf->Cell(30);            
				$this->pdf->setXY(15,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
				$this->pdf->setXY(60,32);
				$this->pdf->SetFont('Arial','',10);
	   		$this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

				$this->pdf->setXY(165,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
				$this->pdf->setXY(180,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

				$this->pdf->setXY(230,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
				$this->pdf->setXY(250,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

				$this->pdf->setXY(15,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
				$this->pdf->setXY(60,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');


				$this->pdf->setXY(130,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
				$this->pdf->setXY(178,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

				$this->pdf->setXY(0,60);
				$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Ln(5);
				$this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
				$this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
				$this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
				$this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Ln(7);

				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 10);
				$this->pdf->Cell(60,49,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
				$this->pdf->Cell(60,14,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
				$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');

	    	if ($gestion==2020) {
		    	$this->pdf->Cell(16.3,14,round($mate[0]->lenguaje),'TBLR',0,'C','1');
					if ($bi>=6) {
						$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round($mate2[0]->lenguaje),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
					if ($bi>=7) {
						$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round($mate3[0]->lenguaje),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
	    	} else {
					$this->pdf->Cell(16.3,14,round(($mate[13]->gramatica+$mate[0]->lenguaje)/2),'TBLR',0,'C','1');
					if ($bi>=6) {
						$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round(($mate2[13]->gramatica+$mate2[0]->lenguaje)/2),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
					if ($bi>=7) {
						$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round(($mate3[13]->gramatica+$mate3[0]->lenguaje)/2),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
	    	}

				$this->pdf->Ln(7);
				$this->pdf->SetX(130);
				$this->pdf->Cell(60,7,'GRAMATICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[13]->gramatica,'TBLR',0,'C','1');
				$this->pdf->SetX(222.6);
				
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[13]->gramatica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				$this->pdf->SetX(255.2);
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[13]->gramatica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,28,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,21,'TECNICA TECNOLOGICA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[7]->infromatica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,21,round(($mate[9]->quimica+$mate[8]->fisica+$mate[7]->infromatica)/3),'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[7]->infromatica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,21,round(($mate2[9]->quimica+$mate2[8]->fisica+$mate2[7]->infromatica)/3),'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,21,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[7]->infromatica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,21,round(($mate3[9]->quimica+$mate3[8]->fisica+$mate3[7]->infromatica)/3),'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,21,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(130);
				$this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[8]->fisica,'TBLR',0,'C','1');
				$this->pdf->SetX(222.6);

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[8]->fisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->SetX(255.2);

				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[8]->fisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(130);
				$this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[9]->quimica,'TBLR',0,'C','1');
				$this->pdf->SetX(222.6);

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[9]->quimica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->SetX(255.2);

				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[9]->quimica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,7,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[11]->filosofia,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[11]->filosofia,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[11]->filosofia,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[11]->filosofia,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[11]->filosofia,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[11]->filosofia,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[12]->religuion,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[12]->religuion,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[12]->religuion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[12]->religuion,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[12]->religuion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[12]->religuion,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

        $this->pdf->Line(10,48,320,48);		            
	    	$this->pdf->Ln('12');
	    	/*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
	    	$this->pdf->AddPage(); 
	    	$this->pdf->Line(10,12,320,12);	
				$this->pdf->AliasNbPages();

				//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->setXY(10,2);
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
	    	$this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');

	   		$kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
				 
				$this->pdf->SetFont('Arial', '', 13);
				$this->pdf->setXY(10,15);
				$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
				$this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
				$this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
				$this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 13);
				$i=0;

				foreach ($kardex as $kardexs) {
					$i++;
					$this->pdf->Ln(7);
					$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
					$this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
					$this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
					$this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
				}

				if ($i>=25) {
					$this->pdf->AddPage(); 
					//$this->pdf->Line(10,12,320,12);
				}
			}
			$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
			ob_end_flush();
		}
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
    	//$pdf->AddPage('P','Legal'); 
			foreach ($list as $estud) {
				$mate=$this->estud->get_mate4($estud->id_est,1,27,4,5,9,10,11,12,18,19,21,22,23,24,25,5,$gestion);
				$mate2=$this->estud->get_mate4($estud->id_est,1,27,4,5,9,10,11,12,18,19,21,22,23,24,25,6,$gestion);
				$mate3=$this->estud->get_mate4($estud->id_est,1,27,4,5,9,10,11,12,18,19,21,22,23,24,25,7,$gestion);
    		//print_r($mate);exit();
				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
				$this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
				$this->pdf->Cell(30);            
				$this->pdf->setXY(80,20);
				$this->pdf->SetFont('Arial','B',18);
				$this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
				$this->pdf->Line(10,30,320,30);		
				$this->pdf->Ln('15');            
				$this->pdf->Cell(30);            
				$this->pdf->setXY(15,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
				$this->pdf->setXY(60,32);
				$this->pdf->SetFont('Arial','',10);
	   		$this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');
				 
				$this->pdf->setXY(165,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
				$this->pdf->setXY(180,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   		$this->pdf->setXY(230,32);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
				$this->pdf->setXY(250,32);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');
				
				$this->pdf->setXY(15,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
				$this->pdf->setXY(60,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');
				
				$this->pdf->setXY(130,40);
				$this->pdf->SetFont('Arial','B',10);
				$this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
				$this->pdf->setXY(178,40);
				$this->pdf->SetFont('Arial','',10);
				$this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');
				
				$this->pdf->setXY(0,60);
				$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Ln(5);
				$this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
				$this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
				$this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
				$this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
				$this->pdf->Ln(7);
				$this->pdf->SetX(190);
				$this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
				$this->pdf->Ln(7);

				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 10);
				$this->pdf->Cell(60,49,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
				$this->pdf->Cell(60,14,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
				$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');

				if ($gestion==2020) {
					$this->pdf->Cell(16.3,14,round($mate[0]->lenguaje),'TBLR',0,'C','1');
					if ($bi>=6) {
						$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round($mate2[0]->lenguaje),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
					if ($bi>=7) {
						$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round($mate3[0]->lenguaje),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}	
				} else {
					$this->pdf->Cell(16.3,14,round(($mate[15]->gramatica+$mate[0]->lenguaje)/2),'TBLR',0,'C','1');
					if ($bi>=6) {
						$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round(($mate2[15]->gramatica+$mate2[0]->lenguaje)/2),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
					if ($bi>=7) {
						$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,round(($mate3[15]->gramatica+$mate3[0]->lenguaje)/2),'TBLR',0,'C','1');
					} else {
						$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
						$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
					}
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(130);
				$this->pdf->Cell(60,7,'GRAMATICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[15]->gramatica,'TBLR',0,'C','1');
				$this->pdf->SetX(222.6);

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[15]->gramatica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
	    	$this->pdf->SetX(255.2);
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[15]->gramatica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if($bi>=7){
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
				}else{
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[5]->artes,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

	    	if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[5]->artes,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,14,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');

				if($bi>=6){
					$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				if ($mate[8]->sistemas==0) {
						$siste=$mate[9]->electronica;
				}
        if ($mate[9]->electronica==0)
        {
        	$siste=$mate[8]->sistemas;
        }
				if ($bi>=6) {
					if ($mate2[8]->sistemas==0) {
						$siste2=$mate2[9]->electronica;
					}
					if ($mate2[9]->electronica==0) {
						$siste2=$mate2[8]->sistemas;
					}
				}

	    	if ($bi>=7) {
					if ($mate3[8]->sistemas==0) {
						$siste3=$mate3[9]->electronica;
					}
					if ($mate3[9]->electronica==0) {
						$siste3=$mate3[8]->sistemas;
					}
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'TECNICA TECNOLOGICA GEN.','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,21,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[11]->fisica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[11]->fisica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[11]->fisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[11]->fisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[11]->fisica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[11]->fisica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[12]->quimica,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[12]->quimica,'TBLR',0,'C','1');

				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[12]->quimica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[12]->quimica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[12]->quimica,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[12]->quimica,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[13]->filosofia,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[13]->filosofia,'TBLR',0,'C','1');
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[13]->filosofia,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[13]->filosofia,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[13]->filosofia,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[13]->filosofia,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

				$this->pdf->Ln(7);
				$this->pdf->SetX(70);
				$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
				$this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
				$this->pdf->Cell(16.3,7,$mate[14]->religuion,'TBLR',0,'C','1');
				$this->pdf->Cell(16.3,7,$mate[14]->religuion,'TBLR',0,'C','1');
				if ($bi>=6) {
					$this->pdf->Cell(16.3,7,$mate2[14]->religuion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate2[14]->religuion,'TBLR',0,'C','1');
				} else{ 
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}
				if ($bi>=7) {
					$this->pdf->Cell(16.3,7,$mate3[14]->religuion,'TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,$mate3[14]->religuion,'TBLR',0,'C','1');
				} else {
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
					$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
				}

        $this->pdf->Line(10,48,320,48);		            
				$this->pdf->Ln('12');
				$this->pdf->AddPage(); 
				$this->pdf->Line(10,12,320,12);	
				$this->pdf->AliasNbPages();
				//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->setXY(10,2);
				$this->pdf->SetFont('Arial','BU',25);
				$this->pdf->Cell(30);
				$this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');
				
				$kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
				$this->pdf->SetFont('Arial', '', 13);
				$this->pdf->setXY(10,15);
				$this->pdf->SetLeftMargin(10);
				$this->pdf->SetRightMargin(10);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->SetFont('Arial', 'B', 10);
				$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
				$this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
				$this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
				$this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
				$this->pdf->SetFillColor(255,255,255);
				$this->pdf->SetFont('Arial', '', 13);
				$i=0;
				foreach ($kardex as $kardexs) {
					$i++;
					$this->pdf->Ln(7);
					$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
					$this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
					$this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
					$this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
				}

				if ($i>=25) {
					$this->pdf->AddPage(); 
					//$this->pdf->Line(10,12,320,12);
				}
			}
			$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
			ob_end_flush();
    }
		
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
   	foreach ($list as $estud) {
    	$mate=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,5,$gestion);
    	$mate2=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,6,$gestion);
    	$mate3=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,7,$gestion);
    	//$mate4=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
    	$this->pdf->AddPage();
		$this->pdf->AliasNbPages();
		$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(80,20);
		$this->pdf->SetFont('Arial','B',18);
	    $this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
	    $this->pdf->Line(10,30,320,30);		
	    $this->pdf->Ln('15');            
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(15,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
	    $this->pdf->setXY(60,32);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

	    $this->pdf->setXY(165,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
	    $this->pdf->setXY(180,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   	$this->pdf->setXY(230,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
	    $this->pdf->setXY(250,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

	   	$this->pdf->setXY(15,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
	    $this->pdf->setXY(60,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');


	   $this->pdf->setXY(130,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
	    $this->pdf->setXY(178,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

	   $this->pdf->setXY(0,60);
	   $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Ln(5);
	    $this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
	    $this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
	    $this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
	    $this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Ln(7);

	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 10);
	    $this->pdf->Cell(60,42,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
	    $this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	  	if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[3]->edfisica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[3]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[3]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[4]->edmusica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[4]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[4]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7, $mate[5]->artes,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7, $mate[5]->artes,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7, $mate2[5]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate2[5]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7, $mate3[5]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate3[5]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->mate,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[6]->mate,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[6]->mate,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    if($mate[8]->sistemas==0)
    	{
    		$siste=$mate[9]->electronica;
    	}
    	if($mate[9]->electronica==0)
    	{
    		$siste=$mate[8]->sistemas;
    	}
	    if($bi>=6){
	    	if($mate2[8]->sistemas==0)
	    	{
	    		$siste2=$mate2[9]->electronica;
	    	}
	    	if($mate2[9]->electronica==0)
	    	{
	    		$siste2=$mate2[8]->sistemas;
	    	}
	    }
	    if($bi>=7){
	    	if($mate3[8]->sistemas==0)
	    	{
	    		$siste3=$mate3[9]->electronica;
	    	}
	    	if($mate3[9]->electronica==0)
	    	{
	    		$siste3=$mate3[8]->sistemas;
	    	}
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'TECNICA TECNOLOGICA GEN.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7); 
	    $this->pdf->Cell(60,21,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
	   	$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[10]->naturales,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[10]->naturales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[10]->naturales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

		$this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[11]->fisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[11]->fisica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[11]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[11]->fisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[11]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[11]->fisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->quimica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->quimica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[12]->quimica,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7,$mate2[12]->quimica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[12]->quimica,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7,$mate3[12]->quimica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->filosofia,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->filosofia,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[13]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[13]->filosofia,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[13]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[13]->filosofia,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->religuion,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->religuion,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[14]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[14]->religuion,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[14]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[14]->religuion,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

        $this->pdf->Line(10,48,320,48);		            
	    $this->pdf->Ln('12');
	  	    /*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
	    $this->pdf->AddPage(); 
	    $this->pdf->Line(10,12,320,12);	
		$this->pdf->AliasNbPages();

		//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->setXY(10,2);
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');

	   $kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
	   	$this->pdf->SetFont('Arial', '', 13);
	   	$this->pdf->setXY(10,15);
	    $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    $this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
	    $this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
	    $this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 13);
	    $i=0;
	   foreach ($kardex as $kardexs){
	   	$i++;
	   	$this->pdf->Ln(7);
	    $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
	    $this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
	    $this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
	    $this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
	   }
	   if($i>=25){
	   	$this->pdf->AddPage(); 
	    //$this->pdf->Line(10,12,320,12);
	   }
   
}
$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
ob_end_flush();
      
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){

    	foreach ($list as $estud) {
    	$mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,5,$gestion);
    	$mate2=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,6,$gestion);
    	$mate3=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,7,$gestion);
    	//$mate4=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
    	$this->pdf->AddPage();
		$this->pdf->AliasNbPages();
		$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(80,20);
		$this->pdf->SetFont('Arial','B',18);
	    $this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
	    $this->pdf->Line(10,30,320,30);		
	    $this->pdf->Ln('15');            
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(15,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
	    $this->pdf->setXY(60,32);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

	    $this->pdf->setXY(165,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
	    $this->pdf->setXY(180,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   	$this->pdf->setXY(230,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
	    $this->pdf->setXY(250,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

	   	$this->pdf->setXY(15,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
	    $this->pdf->setXY(60,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');


	   $this->pdf->setXY(130,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
	    $this->pdf->setXY(178,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

	   $this->pdf->setXY(0,60);
	   $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Ln(5);
	    $this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
	    $this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
	    $this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
	    $this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Ln(7);

	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 10);
	    $this->pdf->Cell(60,42,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
	    $this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    if($bi>=5){
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    if($bi>=5){
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	   		$this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[9]->mate,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[9]->mate,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
		if($mate[10]->sistemas==0)
    	{
    		$siste=$mate[11]->electronica;
    	}
    	if($mate[11]->electronica==0)
    	{
    		$siste=$mate[10]->sistemas;
    	}
	    if($bi>=6){
	    	if($mate2[10]->sistemas==0)
	    	{
	    		$siste2=$mate2[11]->electronica;
	    	}
	    	if($mate2[11]->electronica==0)
	    	{
	    		$siste2=$mate2[10]->sistemas;
	    	}
	    }
	    if($bi>=7){
	    	if($mate3[10]->sistemas==0)
	    	{
	    		$siste3=$mate3[11]->electronica;
	    	}
	    	if($mate3[11]->electronica==0)
	    	{
	    		$siste3=$mate3[10]->sistemas;
	    	}
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'TECNICA TECNOLOGICA GEN.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,21,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
	   	$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
		$this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

        $this->pdf->Line(10,48,320,48);		            
	    $this->pdf->Ln('12');

	    	    /*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
	    $this->pdf->AddPage(); 
	    $this->pdf->Line(10,12,320,12);	
		$this->pdf->AliasNbPages();

		//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->setXY(10,2);
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');

	   $kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
	   	$this->pdf->SetFont('Arial', '', 13);
	   	$this->pdf->setXY(10,15);
	    $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    $this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
	    $this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
	    $this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 13);
	    $i=0;
	   foreach ($kardex as $kardexs){
	   	$i++;
	   	$this->pdf->Ln(7);
	    $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
	    $this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
	    $this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
	    $this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
	   }
	  
   if($i>=25){
	   	$this->pdf->AddPage(); 
	    //$this->pdf->Line(10,12,320,12);
	   }
}
$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
ob_end_flush();

   
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){

    	foreach ($list as $estud) {
    	$mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,5,$gestion);
    	$mate2=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,6,$gestion);
    	$mate3=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,7,$gestion);
    	//$mate4=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,4,$gestion);
    	$this->pdf->AddPage();
		$this->pdf->AliasNbPages();
		$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(80,20);
		$this->pdf->SetFont('Arial','B',18);
	    $this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
	    $this->pdf->Line(10,30,320,30);		
	    $this->pdf->Ln('15');            
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(15,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
	    $this->pdf->setXY(60,32);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

	    $this->pdf->setXY(165,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
	    $this->pdf->setXY(180,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   	$this->pdf->setXY(230,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
	    $this->pdf->setXY(250,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

	   	$this->pdf->setXY(15,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
	    $this->pdf->setXY(60,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');

	   $this->pdf->setXY(130,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
	    $this->pdf->setXY(178,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

	   $this->pdf->setXY(0,60);
	   $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Ln(5);
	    $this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
	    $this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
	    $this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
	    $this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Ln(7);

	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 10);
	    $this->pdf->Cell(60,42,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
	    $this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    if($bi>=6){
	    	 $this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	 $this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[2]->sociales,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[2]->sociales,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,21,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
	    $this->pdf->Cell(60,14,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[9]->mate,'TBLR',0,'C','1');
	    if($gestion==2020){
		    $this->pdf->Cell(16.3,14,round($mate[9]->mate),'TBLR',0,'C','1');
		    if($bi>=6){
		    	$this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,round($mate2[9]->mate),'TBLR',0,'C','1');
		    }else{
		    	 $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
		    }
		    if($bi>=7){
		    	$this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,round($mate3[9]->mate),'TBLR',0,'C','1');
		    }else{
		    	 $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
		    }
	    }else{


		    $this->pdf->Cell(16.3,14,round(($mate[17]->estadisticas+$mate[9]->mate)/2),'TBLR',0,'C','1');
		    if($bi>=6){
		    	$this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,round(($mate2[17]->estadisticas+$mate2[9]->mate)/2),'TBLR',0,'C','1');
		    }else{
		    	 $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
		    }
		    if($bi>=7){
		    	$this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,round(($mate3[17]->estadisticas+$mate3[9]->mate)/2),'TBLR',0,'C','1');
		    }else{
		    	 $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    	$this->pdf->Cell(16.3,14,'','TBLR',0,'C','1');
		    }
		}
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(130);
	    $this->pdf->Cell(60,7,'ESTADISTICAS','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[17]->estadisticas,'TBLR',0,'C','1');
	    $this->pdf->SetX(222.6);
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$mate2[17]->estadisticas,'TBLR',0,'C','1');
	    
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->SetX(255.2);
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$mate3[17]->estadisticas,'TBLR',0,'C','1');
	    }else{
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

		if($mate[10]->sistemas==0)
    	{
    		$siste=$mate[11]->electronica;
    	}
    	if($mate[11]->electronica==0)
    	{
    		$siste=$mate[10]->sistemas;
    	}
	    if($bi>=6){
	    	if($mate2[10]->sistemas==0)
        	{
        		$siste2=$mate2[11]->electronica;
        	}
        	if($mate2[11]->electronica==0)
        	{
        		$siste2=$mate2[10]->sistemas;
        	}
	    }
	    if($bi>=7){
	    	if($mate3[10]->sistemas==0)
        	{
        		$siste3=$mate3[11]->electronica;
        	}
        	if($mate3[11]->electronica==0)
        	{
        		$siste3=$mate3[10]->sistemas;
        	}
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'TECNICA TECNOLOGICA GEN.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    if($bi>=6){
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);	    
	    $this->pdf->Cell(60,21,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
	   	$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

		$this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }	    

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

        $this->pdf->Line(10,48,320,48);		            
	    $this->pdf->Ln('12');

	    /*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
	    $this->pdf->AddPage(); 
	    $this->pdf->Line(10,12,320,12);	
		$this->pdf->AliasNbPages();

		//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->setXY(10,2);
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');

	   $kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
	   	$this->pdf->SetFont('Arial', '', 13);
	   	$this->pdf->setXY(10,15);
	    $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    $this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
	    $this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
	    $this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');
	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 13);
	    $i=0;
	   foreach ($kardex as $kardexs){
	   	$i++;
	   	$this->pdf->Ln(7);
	    $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
	    $this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
	    $this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
	    $this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
	   }
	if($i>=25){
	   	$this->pdf->AddPage(); 
	    //$this->pdf->Line(10,12,320,12);
	   }
   
}
$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
ob_end_flush();


      
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        foreach ($list as $estud) {
    	$mate=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,5,$gestion);
    	$mate2=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,6,$gestion);
    	$mate3=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,7,$gestion);
    	//$mate4=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
    	$this->pdf->AddPage();
		$this->pdf->AliasNbPages();
		$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('RENDIMIENTO ACADÉMICO -  '.$bimestre),0,0,'C');
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(80,20);
		$this->pdf->SetFont('Arial','B',18);
	    $this->pdf->Cell(200,5,utf8_decode(''.$ninombre),0,0,'L');
	    $this->pdf->Line(10,30,320,30);		
	    $this->pdf->Ln('15');            
	    $this->pdf->Cell(30);            
		$this->pdf->setXY(15,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
	    $this->pdf->setXY(60,32);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

	    $this->pdf->setXY(165,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
	    $this->pdf->setXY(180,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   	$this->pdf->setXY(230,32);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
	    $this->pdf->setXY(250,32);
	    $this->pdf->SetFont('Arial','',10);
	   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

	   	$this->pdf->setXY(15,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
	    $this->pdf->setXY(60,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');


	   $this->pdf->setXY(130,40);
		$this->pdf->SetFont('Arial','B',10);
	    $this->pdf->Cell(35,5,utf8_decode('APELLIDOS Y NOMBRES : '),0,0,'L');
	    $this->pdf->setXY(178,40);
	    $this->pdf->SetFont('Arial','',10);
	   $this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

	   $this->pdf->setXY(0,60);
	   $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Ln(5);
	    $this->pdf->Cell(60,21,'CAMPOS DE SABER Y CONOC.','TBL',0,'L','1');
	    $this->pdf->Cell(60,21,'AREAS CURRICULARES','TBL',0,'C','1');
	    $this->pdf->Cell(60,21,utf8_decode('MATERIAS'),'TBL',0,'C','1');
	    $this->pdf->Cell(97.8,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(32.6,7,'1ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'2DO TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Cell(32.6,7,'3ER TRIMESTRE','TBLR',0,'C','1');
	    $this->pdf->Ln(7);
	    $this->pdf->SetX(190);
	    $this->pdf->Cell(16.3,7,'1ER','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'2DO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'3RO','TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,'P.A.','TBLR',0,'C','1');
	    $this->pdf->Ln(7);

	    $this->pdf->SetFillColor(255,255,255);
	    $this->pdf->SetFont('Arial', '', 10);
	    $this->pdf->Cell(60,56,'COMUNIDAD Y SOCIEDAD','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'COMUNICACION Y LENGUAJE','TBLR',0,'C','1');
	    $this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[0]->lenguaje,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[0]->lenguaje,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'LENGUAJE EXTRANJERA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[1]->ingles,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[1]->ingles,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[1]->ingles,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,21,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'HISTORIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[3]->historia,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,21,round(($mate[5]->geografia+$mate[4]->civica+$mate[3]->historia)/3),'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[3]->historia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,21,round(($mate2[5]->geografia+$mate2[4]->civica+$mate2[3]->historia)/3),'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,21,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[3]->historia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,21,round(($mate3[5]->geografia+$mate3[4]->civica+$mate3[3]->historia)/3),'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,21,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(130);
	    $this->pdf->Cell(60,7,'CIVICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[4]->civica,'TBLR',0,'C','1');
	    $this->pdf->SetX(222.6);
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[4]->civica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->SetX(255.2);
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[4]->civica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(130);
	    $this->pdf->Cell(60,7,'GEOGRAFIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[5]->geografia,'TBLR',0,'C','1');
	    $this->pdf->SetX(222.6);
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[5]->geografia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    $this->pdf->SetX(255.2);
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[5]->geografia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION FISICA Y DEPORTES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[6]->edfisica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[6]->edfisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[6]->edfisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'EDUCACION MUSICAL','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[7]->edmusica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[7]->edmusica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[7]->edmusica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'ARTES PLASTICAS Y VISUALES','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7, $mate[8]->artes,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate2[8]->artes,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7, $mate3[8]->artes,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'CIENCIAS TECNOLOGIA Y PROD.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'MATEMATICAS','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[9]->mate,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[9]->mate,'TBLR',0,'C','1');
	    if($bi>=6){
		     $this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[9]->mate,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		     $this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[9]->mate,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

		if($mate[10]->sistemas==0)
    	{
    		$siste=$mate[11]->electronica;
    	}
    	if($mate[11]->electronica==0)
    	{
    		$siste=$mate[10]->sistemas;
    	}
	    if($bi>=6){
	    	if($mate2[10]->sistemas==0)
			{
				$siste2=$mate2[11]->electronica;
			}
			if($mate2[11]->electronica==0)
			{
				$siste2=$mate2[10]->sistemas;
			}
	    }
	    if($bi>=7){
	    	if($mate3[10]->sistemas==0)
			{
				$siste3=$mate3[11]->electronica;
			}
			if($mate3[11]->electronica==0)
			{
				$siste3=$mate3[10]->sistemas;
			}
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'TECNICA TECNOLOGICA GEN.','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'INFORMATICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$siste,'TBLR',0,'C','1');
	    if($bi>=6){
		     $this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste2,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		     $this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$siste3,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,21,'VIDA TIERRA TERRITORIO','TBL',0,'L','1');
	   	$this->pdf->Cell(60,7,'CIENCIAS NATURALES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'BIOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[12]->naturales,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[12]->naturales,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[12]->naturales,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

		$this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	     $this->pdf->Cell(60,7,'FISICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[13]->fisica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[13]->fisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[13]->fisica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'QUIMICA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[14]->quimica,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[14]->quimica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[14]->quimica,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->Cell(60,14,'COSMOS Y PENSAMIENTO','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'C. FILOSOFIA Y  PSICOLOGIA','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'FILOSOFIA','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[15]->filosofia,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[15]->filosofia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[15]->filosofia,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }

	    $this->pdf->Ln(7);
	    $this->pdf->SetX(70);
	    $this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
	    $this->pdf->Cell(60,7,'RELIGION','TBL',0,'L','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    $this->pdf->Cell(16.3,7,$mate[16]->religuion,'TBLR',0,'C','1');
	    if($bi>=6){
		    $this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate2[16]->religuion,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
	    if($bi>=7){
		    $this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,$mate3[16]->religuion,'TBLR',0,'C','1');
	    }else{
		    $this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    	$this->pdf->Cell(16.3,7,'','TBLR',0,'C','1');
	    }
        $this->pdf->Line(10,48,320,48);		            
	    $this->pdf->Ln('12');

   	    /*KARDEX POR CADA ESTUDIANTES EN UN CURSO*/
	    $this->pdf->AddPage(); 
	    $this->pdf->Line(10,12,320,12);	
		$this->pdf->AliasNbPages();

		//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
        //$this->pdf->Image('assets/images/logo.png',6,2,22,0);
		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
		$this->pdf->setXY(10,2);
		$this->pdf->SetFont('Arial','BU',25);
		$this->pdf->Cell(30);
	    $this->pdf->Cell(250,8,utf8_decode('KARDEX '.$bimestre),0,0,'C');

	   $kardex=$this->estud->kardex($estud->id_est,$gestion,$bi);
	   	$this->pdf->SetFont('Arial', '', 13);
	   	$this->pdf->setXY(10,15);
	    $this->pdf->SetLeftMargin(10);
	    $this->pdf->SetRightMargin(10);
	    $this->pdf->SetFillColor(192,192,192);
	    $this->pdf->SetFont('Arial', 'B', 10);
	    $this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    $this->pdf->Cell(33,7,'FECHA','TBL',0,'C','1');
	    $this->pdf->Cell(70,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
	    $this->pdf->Cell(200,7,'DESCRIPCION','TBL',0,'C','1');

	    $i=0;
	   foreach ($kardex as $kardexs){
	   	$i++;
	   	$this->pdf->Ln(7);
	    $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
	    $this->pdf->Cell(33,7,$kardexs->fecha,'TBL',0,'L','1');
	    $this->pdf->Cell(70,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
	    $this->pdf->Cell(200,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
	   }

	   if($i>=25){
	   	$this->pdf->AddPage(); 
	    //$this->pdf->Line(10,12,320,12);
	   }
}
$this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
ob_end_flush();   

    }
	}
	/********************************************************************************/
	public function kardexs($id) //impresion centralizador
	{
		$this->load->library('pdf');
		// $this->pdf=new FPDF('P','cm','Legal');
		ob_start();
		$this->pdf=new FPDF('P','mm',array(333.0,215.9));
		$ids=explode('_', $id, -1);
		// print_r($ids);
		// exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$list=$this->estud->gest_est($codigo,$gestion);
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$ninombre=$nis->nombrec;
         	$id_col=$nis->id_col;
         }

         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         	$sie=$cols->sie;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }
         foreach ($list as $estud) {
			$this->pdf->AddPage('P',array(333.0,215.9)); 
	    	//$this->pdf->AddPage();
			$this->pdf->AliasNbPages();

			//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
	        $this->pdf->Image('assets/images/logo.png',6,2,22,0);
			$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
			$this->pdf->SetFont('Arial','BU',25);
			$this->pdf->Cell(30);
		    $this->pdf->Cell(150,8,utf8_decode('KARDEX DE ALUMNO'),0,0,'C');
		    $this->pdf->Cell(30);            
			$this->pdf->setXY(42,20);
			$this->pdf->SetFont('Arial','B',18);
		    $this->pdf->Cell(70,5,utf8_decode('ACUMULADO HASTA EL '.$bimestre),0,0,'L');
		    $this->pdf->Line(10,30,205,30);	
		    $this->pdf->Line(10,46,205,46);		
		    $this->pdf->Ln('15');            
		    $this->pdf->Cell(30);            
			$this->pdf->setXY(15,32);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
		    $this->pdf->setXY(60,32);
		    $this->pdf->SetFont('Arial','',10);
		   	$this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

		    $this->pdf->setXY(130,32);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(35,5,utf8_decode('SIE : '),0,0,'L');
		    $this->pdf->setXY(140,32);
		    $this->pdf->SetFont('Arial','',10);
		   	$this->pdf->Cell(15,5,utf8_decode($sie),0,0,'L');

		   	$this->pdf->setXY(130,40);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
		    $this->pdf->setXY(148,40);
		    $this->pdf->SetFont('Arial','',10);
		   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

		    $this->pdf->setXY(160,40);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
		    $this->pdf->setXY(175,40);
		    $this->pdf->SetFont('Arial','',10);
		   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

		   	$this->pdf->setXY(15,40);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
		    $this->pdf->setXY(60,40);
		    $this->pdf->SetFont('Arial','',10);
		   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');

		   $this->pdf->setXY(10,50);
			$this->pdf->SetFont('Arial','B',10);
		    $this->pdf->Cell(50,5,utf8_decode('NOMBRES:'),0,0,'L');
		    $this->pdf->setXY(32,50);
		    $this->pdf->SetFont('Arial','',10);
		   $this->pdf->Cell(15,5,utf8_decode($estud->nombres),0,0,'L');

		   $this->pdf->setXY(0,55);
		   $this->pdf->SetLeftMargin(10);
		    $this->pdf->SetRightMargin(10);
		    $this->pdf->SetFillColor(192,192,192);
		    $this->pdf->SetFont('Arial', 'B', 10);
		    $this->pdf->Ln(5);
		    $this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
		    $this->pdf->Cell(20,7,'FECHA','TBL',0,'C','1');
		    $this->pdf->Cell(50,7,utf8_decode('CATEGORIA'),'TBL',0,'C','1');
		    $this->pdf->Cell(118,7,'DESCRIPCION','TBLR',0,'C','1');
		    $this->pdf->SetFillColor(255,255,255);
		    $this->pdf->SetFont('Arial', '', 10);
		    $i=0;
		    $kardex=$this->estud->kardexn($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
			foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->pdf->Ln(7);
			    $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
			    $this->pdf->Cell(20,7,$kardexs->fecha,'TBL',0,'L','1');
			    $this->pdf->Cell(50,7,utf8_decode($kardexs->categoria),'TBL',0,'L','1');
			    $this->pdf->Cell(118,7,utf8_decode($kardexs->descripcion),'TBLR',0,'C','1');
		   }
		}
	   $this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
ob_end_flush();
     }
	/********************************BONO JUANCITO PINTO************************************/
	public function bonojp($id) //impresion centralizador
	{
		$this->load->library('pdf');
		// $this->pdf=new FPDF('P','cm','Legal');
		ob_start();
		$this->pdf=new FPDF('P','mm',array(333.0,215.9));
		$ids=explode('_', $id, -1);
		
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		
		if (($nivel==="SM" OR $nivel==="ST") AND  ($cur==="5A" OR $cur==="5B" OR $cur==="5C" OR $cur==="6A" OR $cur==="6B" OR $cur==="6C")) 
		{
			$list=$this->estud->bonojp1($nivel,$cur,$gestion);
		}else
		{
			$list=$this->estud->bonojp($codigo,$gestion);
		}
		// print_r($nivel);
  //        exit();
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$ninombre=$nis->nombrec;
         	$id_col=$nis->id_col;
         }

         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         	$sie=$cols->sie;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre." ";
         }
		$curso=explode(' ', $cursos, -1);
// 		$this->pdf->AddPage('P',array(333.0,215.9)); 
//     	//$this->pdf->AddPage();
// 		$this->pdf->AliasNbPages();

// 		//$this->pdf->Image('assets/images/donbosco2.jpg',8,8,15,0);
//         $this->pdf->Image('assets/images/logo.png',6,2,22,0);
// 		$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
// 		$this->pdf->SetFont('Arial','BU',25);
// 		$this->pdf->Cell(30);
// 	    $this->pdf->Cell(150,8,utf8_decode('BONO JUANCITO PINTO'),0,0,'C');
// 	    $this->pdf->Cell(30);            
// 		$this->pdf->setXY(35,20);
// 		$this->pdf->SetFont('Arial','B',18);
// 	    $this->pdf->Cell(70,5,utf8_decode(''.$ninombre),0,0,'L');
// 	    $this->pdf->Line(10,30,320,30);		
// 	    $this->pdf->Ln('15');            
// 	    $this->pdf->Cell(30);            
// 		$this->pdf->setXY(15,32);
// 		$this->pdf->SetFont('Arial','B',10);
// 	    $this->pdf->Cell(35,5,utf8_decode('UNIDAD EDUCATIVA: '),0,0,'L');
// 	    $this->pdf->setXY(60,32);
// 	    $this->pdf->SetFont('Arial','',10);
// 	   	$this->pdf->Cell(15,5,utf8_decode($colegio),0,0,'L');

// 	    $this->pdf->setXY(130,32);
// 		$this->pdf->SetFont('Arial','B',10);
// 	    $this->pdf->Cell(35,5,utf8_decode('SIE : '),0,0,'L');
// 	    $this->pdf->setXY(140,32);
// 	    $this->pdf->SetFont('Arial','',10);
// 	   	$this->pdf->Cell(15,5,utf8_decode($sie),0,0,'L');

// 	   	$this->pdf->setXY(130,40);
// 		$this->pdf->SetFont('Arial','B',10);
// 	    $this->pdf->Cell(35,5,utf8_decode('GESTION: '),0,0,'L');
// 	    $this->pdf->setXY(148,40);
// 	    $this->pdf->SetFont('Arial','',10);
// 	   	$this->pdf->Cell(15,5,utf8_decode($gestion),0,0,'L');

// 	    $this->pdf->setXY(160,40);
// 		$this->pdf->SetFont('Arial','B',10);
// 	    $this->pdf->Cell(35,5,utf8_decode('TURNO: '),0,0,'L');
// 	    $this->pdf->setXY(175,40);
// 	    $this->pdf->SetFont('Arial','',10);
// 	   	$this->pdf->Cell(15,5,utf8_decode($turno),0,0,'L');

	   

// 	   	$this->pdf->setXY(15,40);
// 		$this->pdf->SetFont('Arial','B',10);
// 	    $this->pdf->Cell(35,5,utf8_decode('AÑO DE ESCOLARIDAD: '),0,0,'L');
// 	    $this->pdf->setXY(60,40);
// 	    $this->pdf->SetFont('Arial','',10);
// 	   $this->pdf->Cell(15,5,utf8_decode($cursos),0,0,'L');


	 

// 	   $this->pdf->setXY(0,45);
// 	   $this->pdf->SetLeftMargin(10);
// 	    $this->pdf->SetRightMargin(10);
// 	    $this->pdf->SetFillColor(192,192,192);
// 	    $this->pdf->SetFont('Arial', 'B', 10);
// 	    $this->pdf->Ln(5);
// 	    $this->pdf->Cell(10,14,'NUM','TBL',0,'L','1');
// 	    $this->pdf->Cell(110,14,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
// 	    $this->pdf->Cell(36,7,utf8_decode('BIMESTRE'),'TBL',0,'C','1');
// 	    $this->pdf->Cell(40,14,'OBSERVACIONES','TBLR',0,'C','1');
// 	    $this->pdf->setXY(130,57);
// 	    $this->pdf->Cell(12,7,utf8_decode('1ER'),'TBL',0,'C','1');
// 	    $this->pdf->Cell(12,7,utf8_decode('2DO'),'TBL',0,'C','1');
// 	    $this->pdf->Cell(12,7,utf8_decode('3ER'),'TBL',0,'C','1');
// 	    $this->pdf->SetFillColor(255,255,255);
// 	    $this->pdf->SetFont('Arial', '', 10);
// 	    $i=0;
// 		foreach ($list as $estud) {
// 			$this->pdf->SetX(200);
// 		    $this->pdf->Ln(7);
// 		    $i++;
// 			$this->pdf->Cell(10,7,$i,'TBLR',0,'C','1');
// 	    	$this->pdf->Cell(110,7,utf8_decode($estud->nombres),'TBLR',0,'L','1');
// 	    	$this->pdf->Cell(12,7,round($estud->nota1,0),'TBLR',0,'C','1');
// 	    	$this->pdf->Cell(12,7,round($estud->nota2,0),'TBLR',0,'C','1');
// 	    	$this->pdf->Cell(12,7,round($estud->nota3,0),'TBLR',0,'C','1');
// 	    	if($estud->retirado){
// 	    		$this->pdf->Cell(40,7,"RETIRADO",'TBLR',0,'C','1');
// 	    	}else{
// 	    		$this->pdf->Cell(40,7,"",'TBLR',0,'C','1');
// 	    	}

// 		}
// 	   $this->pdf->Output("BOLETINES ".$cursos." ".$turno.".pdf", 'I');
// ob_end_flush();

    	 $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'e78d03')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f904')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '12c107')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
        'font'  => array(
        'size'  => 10,
        'name'  => 'Calibri'
    ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 11,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        $contador1=3;
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(18);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(10);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(15);
        //$this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(12);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("B{$contador1}:I{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":I".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'REGISTRO DE CALIFICACIONES BIMESTRALES – GESTIÓN '.$gestion);
  //     	$contador1++;
		// $this->excel->getActiveSheet()->getStyle("B{$contador1}:F{$contador1}")->applyFromArray($negra);
  //     	$this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":F".($contador1));
  //     	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $ninombre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'U.E.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":E".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $colegio);

      	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'SIE:');
      	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", ' '.$sie);

      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GRADO:');
      	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $curso[0]);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":E".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $ninombre);

      	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'TURNO:');
      	$this->excel->getActiveSheet()->setCellValue("G{$contador1}",$turno);

      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'PARL:');
      	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $curso[1]);
        $contador1++;
        $contador1++;

        $this->excel->getActiveSheet()->getStyle("A{$contador1}:I{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":A".($contador1+1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1)."", 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":E".($contador1+1));
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'APELLIDOS Y NOMBRES');
        $this->excel->setActiveSheetIndex(0)->mergeCells("F".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'BIMESTRE');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":I".($contador1+1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'OBS.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:I{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", '1ER');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", '2DO');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", '3ER');
        $i=0;
        foreach ($list as $estud) {
			$contador1++;
		    $i++;
		    $this->excel->getActiveSheet()->getStyle("A{$contador1}:I{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		    $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":E".($contador1));
	        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $estud->nombres);
	        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", round($estud->nota1,0));
	        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", round($estud->nota2,0));
	        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", round($estud->nota3,0));
	        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", '');
	        if($estud->retirado){
	    		$this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'TRASPASO');
	    	}
		}
		$contador1++;
		$contador1++;
		$contador1++;
		$this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":D".($contador1));
	    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", "...........................................");
	    $this->excel->setActiveSheetIndex(0)->mergeCells("F".($contador1).":H".($contador1));
	    $this->excel->getActiveSheet()->setCellValue("F{$contador1}", "...........................................");
	    $contador1++;
	    $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":D".($contador1));
	    $this->excel->getActiveSheet()->getStyle("B{$contador1}:D{$contador1}")->applyFromArray($negra);
	    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", "        DIRECTOR (A)");
	    $this->excel->setActiveSheetIndex(0)->mergeCells("F".($contador1).":H".($contador1));
	    $this->excel->getActiveSheet()->getStyle("F{$contador1}:H{$contador1}")->applyFromArray($negra);
	    $this->excel->getActiveSheet()->setCellValue("F{$contador1}", "         MAESTRO (A)");
	    $contador1++;
	    $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":D".($contador1));
	    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", "Fimar y aclaracion de sello");
	    $this->excel->setActiveSheetIndex(0)->mergeCells("F".($contador1).":H".($contador1));
	    $this->excel->getActiveSheet()->setCellValue("F{$contador1}", "Fimar y aclaracion de sello");
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
     
    
  		
	}
	/****************************CENTRALIZADOR  ***************************************/
public function estadisticas_apro($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		// print_r($ids);
		// exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		$list=$this->estud->cursos();

		
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f50202')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'e78d03')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f904')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '12c107')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 15,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        $contador1=3;
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(20);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(25);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(25);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(20);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(10);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:G{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'ESTADISTICA DE APROVECHAMIENTO '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GESTION:');
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);

      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $colegio);
      	
       	$contador1++;
        $contador1++;
        $contador1++;

        $this->excel->getActiveSheet()->getStyle("A{$contador1}:G{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NUM');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'CURSO');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'COMU. Y SOC.');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'CIENCIAS TEC. Y PROD.');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'VIDA TIERRA Y TERR.O');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'COSMOS Y PENS.');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'TOTAL');

		$contador1++;
    
        $x = 1;
        if($nivel=='PM' OR $nivel=='PT' )
        {
        	$clmat=5;
        	$vttmat=1;
        	$cpmat=1;

        }
        if($nivel=='SM' OR $nivel=='ST' )
        {
        	$clmat=6;
        	$vttmat=3;
        	$cpmat=2;
        }
        $sumacl=0;
        $sumactp=0;
        $sumavtt=0;
        $sumacp=0;
        $sumatotal=0;
		 foreach ($list as $estud) {

		 if(($nivel=='SM' OR $nivel=='ST') AND ($estud->codigo=='1A' OR $estud->codigo=='1B'  OR $estud->codigo=='2A'  OR $estud->codigo=='2B') )
        {
        	$vttmat=1;
        	
        }else{
        	$vttmat=3;
        }
        
		 $suma_area_cl=$this->estud->suma_area_cl($estud->codigo."-".$nivel,$clmat);
         foreach ($suma_area_cl as $suma_area_cls) 
         {
         	$cl=round($suma_area_cls->cl);
         }
         $suma_area_ctp=$this->estud->suma_area_ctp($estud->codigo."-".$nivel);
         foreach ($suma_area_ctp as $suma_area_ctps) 
         {
         	$ctp=round($suma_area_ctps->ctp);
         }
         // print_r($vttmat);
        	// exit();
         $suma_area_vtt=$this->estud->suma_area_vtt($estud->codigo."-".$nivel,$vttmat);
         foreach ($suma_area_vtt as $suma_area_vtts) 
         {
         	$vtt=round($suma_area_vtts->vtt);
         }
         $suma_area_cp=$this->estud->suma_area_cp($estud->codigo."-".$nivel,$cpmat);
         foreach ($suma_area_cp as $suma_area_cps) 
         {
         	$cp=round($suma_area_cps->cp);
         }
         if(($nivel=='PM' OR $nivel=='PT') AND $estud->codigo!='6C')
        {
         $total=round(($cl+$ctp+$vtt+$cp)/4);
         $sumatotal=$sumatotal+$total;
         $sumacl=$sumacl+$cl;
         $sumactp=$sumactp+$ctp;
         $sumavtt=$sumavtt+$vtt;
         $sumacp=$sumacp+$cp;
         	$this->excel->getActiveSheet()->getStyle("A{$contador1}:G{$contador1}")->applyFromArray($estilobor);
			$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
        	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $estud->curso);
        	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cl);
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ctp);
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $vtt);
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $cp);
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $total);
        	$contador1++;
        	$x++;
        }
        if(($nivel=='SM' OR $nivel=='ST'))
        {
         $total=round(($cl+$ctp+$vtt+$cp)/4);
         $sumatotal=$sumatotal+$total;
         $sumacl=$sumacl+$cl;
         $sumactp=$sumactp+$ctp;
         $sumavtt=$sumavtt+$vtt;
         $sumacp=$sumacp+$cp;
         	$this->excel->getActiveSheet()->getStyle("A{$contador1}:G{$contador1}")->applyFromArray($estilobor);
			$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
        	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $estud->curso);
        	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cl);
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ctp);
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $vtt);
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $cp);
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $total);
        	$contador1++;
        	$x++;
        }
		 }
		 $contador1++;
        $contador1++;
        $contador1++;
        $x--;
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:G{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'COMU. Y SOC.');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'CIENCIAS TEC. Y PROD.');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'VIDA TIERRA Y TERR.O');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'COSMOS Y PENS.');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'TOTAL');
         $contador1++;
         $this->excel->getActiveSheet()->getStyle("C{$contador1}:G{$contador1}")->applyFromArray($estilobor);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", round($sumacl/$x));
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", round($sumactp/$x));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", round($sumavtt/$x));
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", round($sumacp/$x));
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", round($sumatotal/$x));
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    
     }
	public function excel_centralizador($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($cur);
		//exit();
		$list=$this->estud->gest_est_5to_6to($cur,$nivel,$bi,$gestion);

		
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f50202')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'e78d03')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f904')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '12c107')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        $contador1=3;
        if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A' OR $cur=='5B'  OR $cur=='6B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'QUI');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ARTES PLASTICAS');   
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'BIOLOGIA');  
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'RELIGION');   
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA'); 
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	
		 $mate=$this->estud->get_5to_6to($estud->id_est,1,4,5,6,7,8,9,10,11,12,26,18,19,21,22,23,24,25,$bi,$gestion);
		 //print_r($mate);
		 //print_r($mate[0]->lenguaje);
		 //exit();
		 
		 
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	if($mate[2]->sociales!=0)
        	{
        		$sociales=$mate[2]->sociales;
        		$historia=$mate[2]->sociales;
        		$geografia=$mate[2]->sociales;
        		$civica=$mate[2]->sociales;
        	}
        	if($mate[2]->sociales==0)
        	{
        		$sociales=round(($mate[3]->historia+$mate[4]->civica+$mate[5]->geografia)/3);
        		$historia=$mate[3]->historia;
        		$geografia=$mate[4]->civica;
        		$civica=$mate[5]->geografia;
        	}
		    if($historia<=50){$estilo3=$rojo;}
		    if($historia>=51 ){$estilo3=$naranja;}
		    if($historia>=70 ){$estilo3=$amarillo;}
		    if($historia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $historia);

		    if($geografia<=50){$estilo3=$rojo;}
		    if($geografia>=51 ){$estilo3=$naranja;}
		    if($geografia>=70 ){$estilo3=$amarillo;}
		    if($geografia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $geografia);
        	
		    if($civica<=50){$estilo3=$rojo;}
		    if($civica>=51 ){$estilo3=$naranja;}
		    if($civica>=70 ){$estilo3=$amarillo;}
		    if($civica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $civica);
        	
		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[8]->artes);
        	if($mate[9]->mate!=0)
        	{
        		$mates=$mate[9]->mate;
        	}
        	if($mate[17]->estadisticas!=0)
        	{
        		$mates=round(($mate[17]->estadisticas+$mate[9]->mate)/2);
        	
        	}
		    if($mates<=50){$estilo3=$rojo;}
		    if($mates>=51 ){$estilo3=$naranja;}
		    if($mates>=70 ){$estilo3=$amarillo;}
		    if($mates>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mates);
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[12]->naturales);

		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[16]->religuion);
$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mates+$siste+$mate[13]->fisica+$mate[14]->quimica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
     }

public function excel_curso($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		if($reprobados==1)
		{
			$list=$this->estud->Peor_estudiantes($codigo,$bi,$gestion);
		}

		if($reprobados==0)
		{
			$list=$this->estud->gest_est($codigo,$gestion);
			// print_r($list);
			// exit();
		}

		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        	$contador1=3;
		if($nivel=='PM' OR $nivel=='PT'  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create

        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'GR. ES.:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":I".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("J".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'V.T.T.');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MAT');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'TT');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:N{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CIENCIAS NATURALES');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("N".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1-2).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,$bi,$gestion);
		 	// print_r($mate);
		 	// exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //
		    //$mate=$this->estud->nota_materia(1,$estud->id_est);
		    //foreach ($mate as $mates) {$nota=$mates->notabi1;}
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
		    // $mate=$this->estud->nota_materia(3,$estud->id_est);
		    // foreach ($mate as $mates) {$nota=$mates->notabi1;}
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
		    // $mate1=$this->estud->nota_materia(1,$estud->id_est);
		    // foreach ($mate1 as $mates) {$nota1=$mates->notabi1;}
		    // $mate2=$this->estud->nota_materia(3,$estud->id_est);
		    // foreach ($mate2 as $mates) {$nota2=$mates->notabi1;}
		    $leng=round(($mate[0]->lenguaje+$mate[1]->ingles)/2);
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$leng);
			 // $this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
      //   	$mate=$this->estud->nota_materia(5,$estud->id_est);
		    // foreach ($mate as $mates) {$sociales=$mates->notabi1;}
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[2]->sociales);
			 // $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[2]->sociales);
      //   	$mate=$this->estud->nota_materia(9,$estud->id_est);
		    // foreach ($mate as $mates) {$edfisica=$mates->notabi1;}
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[3]->edfisica);
			 // $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[3]->edfisica);
      //   	$mate=$this->estud->nota_materia(10,$estud->id_est);
		    // foreach ($mate as $mates) {$edmusica=$mates->notabi1;}
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[4]->edmusica);
			 // $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[4]->edmusica);
      //   	$mate=$this->estud->nota_materia(11,$estud->id_est);
		    // foreach ($mate as $mates) {$artes=$mates->notabi1;}
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[5]->artes);
			 // $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[5]->artes);
      //   	$mate=$this->estud->nota_materia(12,$estud->id_est);
		    // foreach ($mate as $mates) {$matematicas=$mates->notabi1;}
		    if($mate[6]->matematicas<=50){$estilo3=$rojo;}
		    if($mate[6]->matematicas>=51 ){$estilo3=$naranja;}
		    if($mate[6]->matematicas>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->matematicas>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[6]->matematicas);
			 // $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[6]->matematicas);
      //   	$mate=$this->estud->nota_materia(13,$estud->id_est);
		    // foreach ($mate as $mates) {$info=$mates->notabi1;}
		    if($mate[7]->informatica<=50){$estilo3=$rojo;}
		    if($mate[7]->informatica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->informatica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->informatica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[7]->informatica);
			 // $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[7]->informatica);
      //   	$mate=$this->estud->nota_materia(20,$estud->id_est);
		    // foreach ($mate as $mates) {$cnaturales=$mates->notabi1;}
		    if($mate[8]->maturales<=50){$estilo3=$rojo;}
		    if($mate[8]->maturales>=51 ){$estilo3=$naranja;}
		    if($mate[8]->maturales>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->maturales>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[8]->maturales);
			 // $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[8]->maturales);
      //   	$mate=$this->estud->nota_materia(25,$estud->id_est);
		    // foreach ($mate as $mates) {$religuion=$mates->notabi1;}
		    if($mate[9]->religion<=50){$estilo3=$rojo;}
		    if($mate[9]->religion>=51 ){$estilo3=$naranja;}
		    if($mate[9]->religion>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->religion>=90 ){$estilo3=$verde;}


			// $data_area= array(
			//  'notabi3'=>$mate[9]->religion);
			//  $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[9]->religion);
        	$final=round(($leng+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->matematicas+$mate[7]->informatica+$mate[8]->maturales+$mate[9]->religion)/9);
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}

		  //      $data_nota_prom= array(
			 // 'prom3'=>($leng+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->matematicas+$mate[7]->informatica+$mate[8]->maturales+$mate[9]->religion)/9);
			 // $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $final);
        	$x++;
		 }
		//$this->excel->getActiveSheet()->setTitle(0);
		 
		$n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'GRAMATICA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate($estud->id_est,1,27,4,5,9,10,11,12,14,15,16,21,24,25,$bi,$gestion);
		//print_r($mate);
		//print_r($mate[1]->ingles);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    // print_r($mate); exit();
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);

		    if($mate[13]->gramatica<=50){$estilo3=$rojo;}
		    if($mate[13]->gramatica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->gramatica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->gramatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[13]->gramatica);
		    if($gestion==2020)
		    {
		    	$leng=$mate[0]->lenguaje;
		    }else{
		    	$leng=round(($mate[13]->gramatica+$mate[0]->lenguaje)/2);
		    }
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}
		 // 	$data_area= array(
			// 'notabi3'=>$leng);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);
		
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[2]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[3]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}


		 //    $data_area= array(
			// 'notabi3'=>$mate[4]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[5]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[6]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[7]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[6]->mate);
        	
        	if($mate[7]->infromatica<=50){$estilo3=$rojo;}
		    if($mate[7]->infromatica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->infromatica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->infromatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[7]->infromatica);

		    if($mate[8]->fisica<=50){$estilo3=$rojo;}
		    if($mate[8]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[8]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[8]->fisica);
        	// print_r($mate); exit();
		    if($mate[9]->quimica<=50){$estilo3=$rojo;}
		    if($mate[9]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[9]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[9]->quimica);

        	$sistemas=round(($mate[9]->quimica+$mate[8]->fisica+$mate[7]->infromatica)/3);
        	if($sistemas<=50){$estilo3=$rojo;}
		    if($sistemas>=51 ){$estilo3=$naranja;}
		    if($sistemas>=70 ){$estilo3=$amarillo;}
		    if($sistemas>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$sistemas);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $sistemas);

        	if($mate[12]->religuion<=50){$estilo3=$rojo;}
		    if($mate[12]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[12]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[12]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[12]->religuion);

        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[10]->naturales);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);


		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[10]->naturales);

        	if($mate[11]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[11]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[11]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[11]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $mate[11]->filosofia);

$final=round(($leng+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$sistemas+$mate[10]->naturales+$mate[11]->filosofia+$mate[12]->religuion)/11);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //   $data_nota_prom= array(
			// 'prom3'=>($leng+$mate[2]->ingles+$mate[3]->sociales+$mate[4]->edfisica+$mate[5]->edmusica+$mate[6]->artes+$mate[7]->mate+$sistemas+$mate[11]->naturales+$mate[12]->filosofia+$mate[13]->religuion)/11);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}",$final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
		$siste=0;
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'GRAMATICA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'RELIGION');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate4($estud->id_est,1,27,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		//print_r($mate);
		 //print_r($mate[0]->lenguaje);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);

		    if($mate[15]->gramatica<=50){$estilo3=$rojo;}
		    if($mate[15]->gramatica>=51 ){$estilo3=$naranja;}
		    if($mate[15]->gramatica>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->gramatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->gramatica);
		    if($gestion==2020)
		    {
		    	$leng=$mate[0]->lenguaje;
		    }else{
		    	$leng=round(($mate[15]->gramatica+$mate[0]->lenguaje)/2);
		    }
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$leng);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);
			
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->artes);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[7]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[6]->mate);
        	if($mate[8]->sistemas==0)
        	{
        		$siste=$mate[9]->electronica;
        	}
        	if($mate[9]->electronica==0)
        	{
        		$siste=$mate[8]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

			if($mate[11]->fisica<=50){$estilo3=$rojo;}
		    if($mate[11]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[11]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->fisica>=90 ){$estilo3=$verde;}
		    
        	

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[11]->fisica);
        	
		    if($mate[12]->quimica<=50){$estilo3=$rojo;}
		    if($mate[12]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[12]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[12]->quimica);


        	if($mate[14]->religuion<=50){$estilo3=$rojo;}
		    if($mate[14]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[14]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[14]->religuion);
        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}
    

		 //    $data_area= array(
			// 'notabi2'=>$mate[10]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

				$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[10]->naturales);
       	

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   if($mate[13]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[13]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[13]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->filosofia>=90 ){$estilo3=$verde;}

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[13]->filosofia);

$final=round(($leng+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[11]->fisica+$mate[12]->quimica+$mate[10]->naturales+$mate[13]->filosofia+$mate[14]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom2'=>($leng+$mate[2]->ingles+$mate[3]->sociales+$mate[4]->edfisica+$mate[5]->edmusica+$mate[6]->artes+$mate[7]->mate+$siste+$mate[10]->fisica+$mate[11]->quimica+$mate[9]->naturales+$mate[12]->filosofia+$mate[13]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
   		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
       
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		 //print_r($mate);
		 //exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);


		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[4]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[6]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[6]->mate);
        	if($mate[8]->sistemas==0)
        	{
        		$siste=$mate[9]->electronica;
        	}
        	if($mate[9]->electronica==0)
        	{
        		$siste=$mate[8]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

		    if($mate[11]->fisica<=50){$estilo3=$rojo;}
		    if($mate[11]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[11]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[11]->fisica);
        	
		    if($mate[12]->quimica<=50){$estilo3=$rojo;}
		    if($mate[12]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[12]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[12]->quimica);


        	if($mate[14]->religuion<=50){$estilo3=$rojo;}
		    if($mate[14]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[14]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[14]->religuion);

        	

        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[10]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[10]->naturales);

        	if($mate[13]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[13]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[13]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->filosofia>=90 ){$estilo3=$verde;}

		   // $data_area= array(
		//	'notabi2'=>$mate[13]->filosofia);
		//	$this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[13]->filosofia);
$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[11]->fisica+$mate[12]->quimica+$mate[10]->naturales+$mate[13]->filosofia+$mate[14]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			//  'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[9]->fisica+$mate[10]->quimica+$mate[8]->naturales+$mate[11]->filosofia+$mate[12]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("k".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ARTES PLASTICAS');    
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'BIOLOGIA'); 
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'RELIGION');   
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA'); 
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		 //print_r($mate);
		 //print_r($mate[0]->lenguaje);
		// exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[2]->sociales);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[2]->sociales);
        	
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[2]->sociales);

		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

			// $data_area= array(
			// 'notabi2'=>$mate[6]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[7]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[8]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}


			// $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[12]->naturales);

		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[13]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);



		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[15]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[16]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[16]->religuion);
$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[14]->quimica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[14]->quimica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("O".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX'); 
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("S{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:T{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'ESTADISTICAS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->setCellValue("S{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->getStyle("T".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("T".($contador1-2).":T".($contador1));
        $this->excel->getActiveSheet()->setCellValue("T".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,$bi,$gestion);
		//print_r($mate);
		// print_r($mate[10]->sistemas);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);


		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[2]->sociales);


		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[2]->sociales);



		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[2]->sociales);
        	
		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[6]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[7]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[8]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);

        	if($mate[17]->estadisticas<=50){$estilo3=$rojo;}
		    if($mate[17]->estadisticas>=51 ){$estilo3=$naranja;}
		    if($mate[17]->estadisticas>=70 ){$estilo3=$amarillo;}
		    if($mate[17]->estadisticas>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[17]->estadisticas);
        	//$mateesta=($mate[17]->estadisticas+$mate[9]->mate)/2;        	
        	$mateesta=($mate[9]->mate);
        	if($mateesta<=50){$estilo3=$rojo;}
		    if($mateesta>=51 ){$estilo3=$naranja;}
		    if($mateesta>=70 ){$estilo3=$amarillo;}
		    if($mateesta>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mateesta);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mateesta);
        	//$siste=0;
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[12]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[12]->naturales);

		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[13]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[14]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[15]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[16]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $mate[16]->religuion);
			$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$mateesta+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom3'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$mateesta+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("T{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		   	//$this->excel->getActiveSheet()->setCellValue("S{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
        	$this->excel->getActiveSheet()->setCellValue("T{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        $this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ARTES PLASTICAS');      
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'BIOLOGIA'); 
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA'); 
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
  
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);

		 //print_r($mate);
		 //print_r($mate[0]->lenguaje);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	

		    //$data_area= array(
			//'notabi2'=>$mate[0]->lenguaje);
			//$this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[1]->ingles);
			//$this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[3]->historia<=50){$estilo3=$rojo;}
		    if($mate[3]->historia>=51 ){$estilo3=$naranja;}
		    if($mate[3]->historia>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->historia>=90 ){$estilo3=$verde;}


		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[3]->historia);

        	if($mate[5]->geografia<=50){$estilo3=$rojo;}
		    if($mate[5]->geografia>=51 ){$estilo3=$naranja;}
		    if($mate[5]->geografia>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->geografia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[5]->geografia);

        	if($mate[4]->civica<=50){$estilo3=$rojo;}
		    if($mate[4]->civica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->civica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->civica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[4]->civica);
        	$soci=($mate[5]->geografia+$mate[4]->civica+$mate[3]->historia)/3;
        	
		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[6]->edfisica);
			//$this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[7]->edmusica);
			//$this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[8]->artes);
			//$this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[9]->mate);
			//$this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$siste);
			//$this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[12]->naturales);
			//$this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[12]->naturales);


		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[13]->fisica);
			//$this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[14]->quimica);
			//$this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[15]->filosofia);
			//$this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[16]->religuion);
			//$this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[16]->religuion);
        	$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$soci+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[14]->quimica+$mate[15]->filosofia+$mate[16]->religuion)/13);
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}

		      //$data_nota_prom= array(
			//'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$soci+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[14]->quimica+$mate[15]->filosofia+$mate[16]->religuion)/13);
			//$this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);

    		//$this->excel->getActiveSheet()->setCellValue("T{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
    		
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function centralizador_compl($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		if($reprobados==1)
		{
			$list=$this->estud->Peor_estudiantes($codigo,$bi,$gestion);
		}

		if($reprobados==0)
		{
			$list=$this->estud->gest_est($codigo,$gestion);
			// print_r($list);
			// exit();
		}

		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        	$contador1=3;
		if($nivel=='PM' OR $nivel=='PT'  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create

        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'GR. ES.:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":I".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("J".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'V.T.T.');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MAT');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'TT');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:N{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CIENCIAS NATURALES');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("N".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1-2).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate_primariac($estud->id_est,1,3,5,9,10,11,12,13,20,25,$bi,$gestion);
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);

		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
		   
		    //$leng=round(($mate[0]->lenguaje+$mate[1]->ingles)/2);
		    $leng=$mate[0]->lenguaje;
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}

		 

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
      
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[2]->sociales);
			 // $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[2]->sociales);
      //   	$mate=$this->estud->nota_materia(9,$estud->id_est);
		    // foreach ($mate as $mates) {$edfisica=$mates->notabi1;}
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[3]->edfisica);
			 // $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[3]->edfisica);
      //   	$mate=$this->estud->nota_materia(10,$estud->id_est);
		    // foreach ($mate as $mates) {$edmusica=$mates->notabi1;}
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[4]->edmusica);
			 // $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[4]->edmusica);
      //   	$mate=$this->estud->nota_materia(11,$estud->id_est);
		    // foreach ($mate as $mates) {$artes=$mates->notabi1;}
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[5]->artes);
			 // $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[5]->artes);
      //   	$mate=$this->estud->nota_materia(12,$estud->id_est);
		    // foreach ($mate as $mates) {$matematicas=$mates->notabi1;}
		    if($mate[6]->matematicas<=50){$estilo3=$rojo;}
		    if($mate[6]->matematicas>=51 ){$estilo3=$naranja;}
		    if($mate[6]->matematicas>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->matematicas>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[6]->matematicas);
			 // $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[6]->matematicas);
      //   	$mate=$this->estud->nota_materia(13,$estud->id_est);
		    // foreach ($mate as $mates) {$info=$mates->notabi1;}
		    if($mate[7]->informatica<=50){$estilo3=$rojo;}
		    if($mate[7]->informatica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->informatica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->informatica>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[7]->informatica);
			 // $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[7]->informatica);
      //   	$mate=$this->estud->nota_materia(20,$estud->id_est);
		    // foreach ($mate as $mates) {$cnaturales=$mates->notabi1;}
		    if($mate[8]->maturales<=50){$estilo3=$rojo;}
		    if($mate[8]->maturales>=51 ){$estilo3=$naranja;}
		    if($mate[8]->maturales>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->maturales>=90 ){$estilo3=$verde;}

		  //   $data_area= array(
			 // 'notabi3'=>$mate[8]->maturales);
			 // $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[8]->maturales);
      //   	$mate=$this->estud->nota_materia(25,$estud->id_est);
		    // foreach ($mate as $mates) {$religuion=$mates->notabi1;}
		    if($mate[9]->religion<=50){$estilo3=$rojo;}
		    if($mate[9]->religion>=51 ){$estilo3=$naranja;}
		    if($mate[9]->religion>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->religion>=90 ){$estilo3=$verde;}


			// $data_area= array(
			//  'notabi3'=>$mate[9]->religion);
			//  $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[9]->religion);
        	$final=round(($leng+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->matematicas+$mate[8]->maturales+$mate[9]->religion)/8);
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}

		  //      $data_nota_prom= array(
			 // 'prom3'=>($leng+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->matematicas+$mate[7]->informatica+$mate[8]->maturales+$mate[9]->religion)/9);
			 // $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $final);
        	$x++;
		 }
		//$this->excel->getActiveSheet()->setTitle(0);
		 
		$n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'GRAMATICA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_matec($estud->id_est,1,27,4,5,9,10,11,12,14,15,16,21,24,25,$bi,$gestion);
		//print_r($mate);
		//print_r($mate[1]->ingles);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    // print_r($mate); exit();
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);

		    if($mate[13]->gramatica<=50){$estilo3=$rojo;}
		    if($mate[13]->gramatica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->gramatica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->gramatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[13]->gramatica);
		    if($gestion==2020 && $bi==5)
		    {
		    	$leng=$mate[0]->lenguaje;
		    }else{
		    	$leng=round(($mate[13]->gramatica+$mate[0]->lenguaje)/2);
		    }
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}
		 // 	$data_area= array(
			// 'notabi3'=>$leng);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);
		
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[2]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[3]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}


		 //    $data_area= array(
			// 'notabi3'=>$mate[4]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[5]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[6]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[7]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[6]->mate);
        	
        	if($mate[7]->infromatica<=50){$estilo3=$rojo;}
		    if($mate[7]->infromatica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->infromatica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->infromatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[7]->infromatica);

		    if($mate[8]->fisica<=50){$estilo3=$rojo;}
		    if($mate[8]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[8]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[8]->fisica);
        	// print_r($mate); exit();
		    if($mate[9]->quimica<=50){$estilo3=$rojo;}
		    if($mate[9]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[9]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[9]->quimica);

        	$sistemas=round(($mate[9]->quimica+$mate[8]->fisica+$mate[7]->infromatica)/3);
        	if($sistemas<=50){$estilo3=$rojo;}
		    if($sistemas>=51 ){$estilo3=$naranja;}
		    if($sistemas>=70 ){$estilo3=$amarillo;}
		    if($sistemas>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$sistemas);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $sistemas);

        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[10]->naturales);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[10]->naturales);

        	if($mate[11]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[11]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[11]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[11]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[11]->filosofia);

        	if($mate[12]->religuion<=50){$estilo3=$rojo;}
		    if($mate[12]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[12]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[12]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $mate[12]->religuion);
$final=round(($leng+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$sistemas+$mate[10]->naturales+$mate[11]->filosofia+$mate[12]->religuion)/11);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //   $data_nota_prom= array(
			// 'prom3'=>($leng+$mate[2]->ingles+$mate[3]->sociales+$mate[4]->edfisica+$mate[5]->edmusica+$mate[6]->artes+$mate[7]->mate+$sistemas+$mate[11]->naturales+$mate[12]->filosofia+$mate[13]->religuion)/11);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}",$final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
		$siste=0;
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'GRAMATICA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate4c($estud->id_est,1,27,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		//print_r($mate);
		 //print_r($mate[0]->lenguaje);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);

		    if($mate[15]->gramatica<=50){$estilo3=$rojo;}
		    if($mate[15]->gramatica>=51 ){$estilo3=$naranja;}
		    if($mate[15]->gramatica>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->gramatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[15]->gramatica);
		    if($gestion==2020 && $bi==5)
		    {
		    	$leng=$mate[0]->lenguaje;
		    }else{
		    	$leng=round(($mate[15]->gramatica+$mate[0]->lenguaje)/2);
		    }
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$leng);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);
			
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->artes);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[7]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[6]->mate);
        	if($mate[8]->sistemas==0)
        	{
        		$siste=$mate[9]->electronica;
        	}
        	if($mate[9]->electronica==0)
        	{
        		$siste=$mate[8]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}

		    

		 //    $data_area= array(
			// 'notabi2'=>$mate[10]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

				$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[10]->naturales);

        	if($mate[11]->fisica<=50){$estilo3=$rojo;}
		    if($mate[11]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[11]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->fisica>=90 ){$estilo3=$verde;}
		    
        	

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[11]->fisica);
        	
		    if($mate[12]->quimica<=50){$estilo3=$rojo;}
		    if($mate[12]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[12]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[12]->quimica);

        	

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   if($mate[13]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[13]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[13]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->filosofia>=90 ){$estilo3=$verde;}

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[13]->filosofia);

        	if($mate[14]->religuion<=50){$estilo3=$rojo;}
		    if($mate[14]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[14]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[14]->religuion);
$final=round(($leng+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[11]->fisica+$mate[12]->quimica+$mate[10]->naturales+$mate[13]->filosofia+$mate[14]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom2'=>($leng+$mate[2]->ingles+$mate[3]->sociales+$mate[4]->edfisica+$mate[5]->edmusica+$mate[6]->artes+$mate[7]->mate+$siste+$mate[10]->fisica+$mate[11]->quimica+$mate[9]->naturales+$mate[12]->filosofia+$mate[13]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
   		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
       
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate6c($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		 //print_r($mate);
		 //exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[2]->sociales);
        	
		    if($mate[3]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[3]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[3]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[3]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);


		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[3]->edfisica);
        	
		    if($mate[4]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[4]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[4]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[4]->edmusica);
        	
		    if($mate[5]->artes<=50){$estilo3=$rojo;}
		    if($mate[5]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[5]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[5]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[5]->artes);
        	
		    if($mate[6]->mate<=50){$estilo3=$rojo;}
		    if($mate[6]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[6]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[6]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[6]->mate);
        	if($mate[8]->sistemas==0)
        	{
        		$siste=$mate[9]->electronica;
        	}
        	if($mate[9]->electronica==0)
        	{
        		$siste=$mate[8]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,9,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

        	if($mate[10]->naturales<=50){$estilo3=$rojo;}
		    if($mate[10]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[10]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[10]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[10]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[10]->naturales);

		    if($mate[11]->fisica<=50){$estilo3=$rojo;}
		    if($mate[11]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[11]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[11]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[11]->fisica);
        	
		    if($mate[12]->quimica<=50){$estilo3=$rojo;}
		    if($mate[12]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[12]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[12]->quimica);


        	

        	if($mate[13]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[13]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[13]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->filosofia>=90 ){$estilo3=$verde;}

		    $data_area= array(
			'notabi2'=>$mate[13]->filosofia);
			$this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[13]->filosofia);

        	if($mate[14]->religuion<=50){$estilo3=$rojo;}
		    if($mate[14]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[14]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[14]->religuion);
$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[11]->fisica+$mate[12]->quimica+$mate[10]->naturales+$mate[13]->filosofia+$mate[14]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			//  'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[3]->edfisica+$mate[4]->edmusica+$mate[5]->artes+$mate[6]->mate+$siste+$mate[9]->fisica+$mate[10]->quimica+$mate[8]->naturales+$mate[11]->filosofia+$mate[12]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("k".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate1c($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);
		 //print_r($mate);
		 //print_r($mate[0]->lenguaje);
		// exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[2]->sociales);

		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[2]->sociales);
        	
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);

		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

			// $data_area= array(
			// 'notabi2'=>$mate[6]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[7]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[8]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[9]->mate);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}


			// $data_area= array(
			// 'notabi2'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[12]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[12]->naturales);

		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[13]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);



		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[14]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[15]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi2'=>$mate[16]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[16]->religuion);
$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[14]->quimica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[14]->quimica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("O".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX'); 
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("S{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:T{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:T{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'ESTADISTICAS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FISICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("S{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("T".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("T".($contador1-2).":T".($contador1));
        $this->excel->getActiveSheet()->setCellValue("T".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate3c($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,$bi,$gestion);
		//print_r($mate);
		// print_r($mate[10]->sistemas);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[0]->lenguaje);
			// $this->estud->update_nota_area($estud->id_est,1,$data_area);


		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[1]->ingles);
			// $this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[2]->sociales<=50){$estilo3=$rojo;}
		    if($mate[2]->sociales>=51 ){$estilo3=$naranja;}
		    if($mate[2]->sociales>=70 ){$estilo3=$amarillo;}
		    if($mate[2]->sociales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[2]->sociales);
			// $this->estud->update_nota_area($estud->id_est,3,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[2]->sociales);


		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[2]->sociales);



		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[2]->sociales);
        	
		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[6]->edfisica);
			// $this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[7]->edmusica);
			// $this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[8]->artes);
			// $this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);

        	if($mate[17]->estadisticas<=50){$estilo3=$rojo;}
		    if($mate[17]->estadisticas>=51 ){$estilo3=$naranja;}
		    if($mate[17]->estadisticas>=70 ){$estilo3=$amarillo;}
		    if($mate[17]->estadisticas>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate[17]->estadisticas);
        	//$mateesta=($mate[17]->estadisticas+$mate[9]->mate)/2;        	
        	$mateesta=($mate[9]->mate);
        	if($mateesta<=50){$estilo3=$rojo;}
		    if($mateesta>=51 ){$estilo3=$naranja;}
		    if($mateesta>=70 ){$estilo3=$amarillo;}
		    if($mateesta>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mateesta);
			// $this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mateesta);
        	//$siste=0;
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$siste);
			// $this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[12]->naturales);
			// $this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[12]->naturales);

		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[13]->fisica);
			// $this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[14]->quimica);
			// $this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[15]->filosofia);
			// $this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		 //    $data_area= array(
			// 'notabi3'=>$mate[16]->religuion);
			// $this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}", $mate[16]->religuion);
			$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$mateesta+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}

		 //      $data_nota_prom= array(
			// 'prom3'=>($mate[0]->lenguaje+$mate[1]->ingles+$mate[2]->sociales+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$mateesta+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[15]->filosofia+$mate[16]->religuion)/13);
			// $this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("T{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		   	//$this->excel->getActiveSheet()->setCellValue("S{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
        	$this->excel->getActiveSheet()->setCellValue("T{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        $this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR '.$bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
  
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate2c($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,$bi,$gestion);

		 //print_r($mate);
		 //print_r($mate[0]->lenguaje);
		//exit();
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($mate[0]->lenguaje<=50){$estilo3=$rojo;}
		    if($mate[0]->lenguaje>=51 ){$estilo3=$naranja;}
		    if($mate[0]->lenguaje>=70 ){$estilo3=$amarillo;}
		    if($mate[0]->lenguaje>=90 ){$estilo3=$verde;}	

		    //$data_area= array(
			//'notabi2'=>$mate[0]->lenguaje);
			//$this->estud->update_nota_area($estud->id_est,1,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $mate[0]->lenguaje);
        	
		    if($mate[1]->ingles<=50){$estilo3=$rojo;}
		    if($mate[1]->ingles>=51 ){$estilo3=$naranja;}
		    if($mate[1]->ingles>=70 ){$estilo3=$amarillo;}
		    if($mate[1]->ingles>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[1]->ingles);
			//$this->estud->update_nota_area($estud->id_est,2,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $mate[1]->ingles);
        	
		    if($mate[3]->historia<=50){$estilo3=$rojo;}
		    if($mate[3]->historia>=51 ){$estilo3=$naranja;}
		    if($mate[3]->historia>=70 ){$estilo3=$amarillo;}
		    if($mate[3]->historia>=90 ){$estilo3=$verde;}


		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $mate[3]->historia);

        	if($mate[4]->civica<=50){$estilo3=$rojo;}
		    if($mate[4]->civica>=51 ){$estilo3=$naranja;}
		    if($mate[4]->civica>=70 ){$estilo3=$amarillo;}
		    if($mate[4]->civica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $mate[4]->civica);

        	if($mate[5]->geografia<=50){$estilo3=$rojo;}
		    if($mate[5]->geografia>=51 ){$estilo3=$naranja;}
		    if($mate[5]->geografia>=70 ){$estilo3=$amarillo;}
		    if($mate[5]->geografia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $mate[5]->geografia);
        	$soci=($mate[5]->geografia+$mate[4]->civica+$mate[3]->historia)/3;
        	
		    if($mate[6]->edfisica<=50){$estilo3=$rojo;}
		    if($mate[6]->edfisica>=51 ){$estilo3=$naranja;}
		    if($mate[6]->edfisica>=70 ){$estilo3=$amarillo;}
		    if($mate[6]->edfisica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[6]->edfisica);
			//$this->estud->update_nota_area($estud->id_est,4,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $mate[6]->edfisica);
        	
		    if($mate[7]->edmusica<=50){$estilo3=$rojo;}
		    if($mate[7]->edmusica>=51 ){$estilo3=$naranja;}
		    if($mate[7]->edmusica>=70 ){$estilo3=$amarillo;}
		    if($mate[7]->edmusica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[7]->edmusica);
			//$this->estud->update_nota_area($estud->id_est,5,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate[7]->edmusica);
        	
		    if($mate[8]->artes<=50){$estilo3=$rojo;}
		    if($mate[8]->artes>=51 ){$estilo3=$naranja;}
		    if($mate[8]->artes>=70 ){$estilo3=$amarillo;}
		    if($mate[8]->artes>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[8]->artes);
			//$this->estud->update_nota_area($estud->id_est,6,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $mate[8]->artes);
        	
		    if($mate[9]->mate<=50){$estilo3=$rojo;}
		    if($mate[9]->mate>=51 ){$estilo3=$naranja;}
		    if($mate[9]->mate>=70 ){$estilo3=$amarillo;}
		    if($mate[9]->mate>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[9]->mate);
			//$this->estud->update_nota_area($estud->id_est,7,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate[9]->mate);
        	if($mate[10]->sistemas==0)
        	{
        		$siste=$mate[11]->electronica;
        	}
        	if($mate[11]->electronica==0)
        	{
        		$siste=$mate[10]->sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$siste);
			//$this->estud->update_nota_area($estud->id_est,10,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($mate[12]->naturales<=50){$estilo3=$rojo;}
		    if($mate[12]->naturales>=51 ){$estilo3=$naranja;}
		    if($mate[12]->naturales>=70 ){$estilo3=$amarillo;}
		    if($mate[12]->naturales>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[12]->naturales);
			//$this->estud->update_nota_area($estud->id_est,11,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $mate[12]->naturales);


		    if($mate[13]->fisica<=50){$estilo3=$rojo;}
		    if($mate[13]->fisica>=51 ){$estilo3=$naranja;}
		    if($mate[13]->fisica>=70 ){$estilo3=$amarillo;}
		    if($mate[13]->fisica>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[13]->fisica);
			//$this->estud->update_nota_area($estud->id_est,12,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $mate[13]->fisica);
        	
		    if($mate[14]->quimica<=50){$estilo3=$rojo;}
		    if($mate[14]->quimica>=51 ){$estilo3=$naranja;}
		    if($mate[14]->quimica>=70 ){$estilo3=$amarillo;}
		    if($mate[14]->quimica>=90 ){$estilo3=$verde;}

		   // $data_area= array(
			//'notabi2'=>$mate[14]->quimica);
			//$this->estud->update_nota_area($estud->id_est,13,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $mate[14]->quimica);

        	

        	if($mate[15]->filosofia<=50){$estilo3=$rojo;}
		    if($mate[15]->filosofia>=51 ){$estilo3=$naranja;}
		    if($mate[15]->filosofia>=70 ){$estilo3=$amarillo;}
		    if($mate[15]->filosofia>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[15]->filosofia);
			//$this->estud->update_nota_area($estud->id_est,14,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $mate[15]->filosofia);

        	if($mate[16]->religuion<=50){$estilo3=$rojo;}
		    if($mate[16]->religuion>=51 ){$estilo3=$naranja;}
		    if($mate[16]->religuion>=70 ){$estilo3=$amarillo;}
		    if($mate[16]->religuion>=90 ){$estilo3=$verde;}

		    //$data_area= array(
			//'notabi2'=>$mate[16]->religuion);
			//$this->estud->update_nota_area($estud->id_est,15,$data_area);

		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $mate[16]->religuion);
        	$final=round(($mate[0]->lenguaje+$mate[1]->ingles+$soci+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[14]->quimica+$mate[15]->filosofia+$mate[16]->religuion)/13);
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}

		      //$data_nota_prom= array(
			//'prom2'=>($mate[0]->lenguaje+$mate[1]->ingles+$soci+$mate[6]->edfisica+$mate[7]->edmusica+$mate[8]->artes+$mate[9]->mate+$siste+$mate[13]->fisica+$mate[12]->naturales+$mate[14]->quimica+$mate[15]->filosofia+$mate[16]->religuion)/13);
			//$this->estud->update_nota_prom($estud->id_est,$data_nota_prom);

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);

    		//$this->excel->getActiveSheet()->setCellValue("T{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
    		
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
		 $n=1; 
		 if($reprobados==1){
		
      		$h=1;
		 	foreach ($list as $estud){
		 	$kardex=$this->estud->kardex($estud->appaterno,$estud->apmaterno,$estud->nombre,$gestion,$bi);
		 	$contador1=3;

    		$this->excel->createSheet();
    		$this->excel->setActiveSheetIndex($n); 
    		 $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(15);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(35);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(75);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true);
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex($n)->mergeCells("A".($contador1).":D".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $estud->nombres);
      	$contador1++;
		 $this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilo);
		 $this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'Nro');
        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'FECHA');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CATEGORIA');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'DESCRIPCION');
        
          $contador1++;
    		$i=1;
    		 foreach ($kardex as $kardexs){
			   	$i++;
			   	$this->excel->getActiveSheet()->getStyle("A{$contador1}:D{$contador1}")->applyFromArray($estilobor);
			   	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $i);
		        $this->excel->getActiveSheet()->setCellValue("B{$contador1}", $kardexs->fecha);
		        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $kardexs->categoria);
		        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $kardexs->descripcion);
		        $contador1++;
			}
    		$this->excel->getActiveSheet()->setTitle($h.'-'.$estud->appaterno); //sheetname
    		$h++;
    		$n++;
    		}
    	}
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function acumulador($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		$list=$this->estud->gest_est($codigo,$gestion);
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        	$contador1=3;
		if($nivel=='PM' OR $nivel=='PT'  ){
		$this->excel->getActiveSheet()->setTitle('acumulador'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create

        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'GR. ES.:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":I".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("J".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'V.T.T.');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MAT');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'TT');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:N{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CIENCIAS NATURALES');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("N".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1-2).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,1,$gestion);
		 	$mate2=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,2,$gestion);
		 	$mate3=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,3,$gestion);
		 	$mate4=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,4,$gestion);
		 	$contador1++;
		    if($bi==1){
		    	$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$matematicas=$mate[6]->matematicas;
				$informatica=$mate[7]->informatica;
				$maturales=$mate[8]->maturales;
				$religion=$mate[9]->religion;
		    }
		    if($bi==2){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas)/2);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica)/2);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales)/2);
				$religion=round(($mate[9]->religion+$mate2[9]->religion)/2);
		    }
		    if($bi==3){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas)/3);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica)/3);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales)/3);
				$religion=round(($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion)/3);
		    }
		    if($bi==4){
		    	$lenguaje=($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4;
				$ingles=($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4;
				$leng=($lenguaje+$ingles)/2;
				$sociales=($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4;
				$edfisica=($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4;
				$edmusica=($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4;
				$artes=($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4;
				$matematicas=($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas+$mate4[6]->matematicas)/4;
				$informatica=($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica+$mate4[7]->informatica)/4;
				$maturales=($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales+$mate4[8]->maturales)/4;
				$religion=($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion+$mate4[9]->religion)/4;
		    }

		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);

		    $leng=round(($lenguaje+$ingles)/2);
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);

		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $sociales);

		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edfisica);

		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edmusica);

		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $artes);

		    if($matematicas<=50){$estilo3=$rojo;}
		    if($matematicas>=51 ){$estilo3=$naranja;}
		    if($matematicas>=70 ){$estilo3=$amarillo;}
		    if($matematicas>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $matematicas);

		    if($informatica<=50){$estilo3=$rojo;}
		    if($informatica>=51 ){$estilo3=$naranja;}
		    if($informatica>=70 ){$estilo3=$amarillo;}
		    if($informatica>=90 ){$estilo3=$verde;}
		    $this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $informatica);

		    if($maturales<=50){$estilo3=$rojo;}
		    if($maturales>=51 ){$estilo3=$naranja;}
		    if($maturales>=70 ){$estilo3=$amarillo;}
		    if($maturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $maturales);

		    if($religion<=50){$estilo3=$rojo;}
		    if($religion>=51 ){$estilo3=$naranja;}
		    if($religion>=70 ){$estilo3=$amarillo;}
		    if($religion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $religion);

        	$final=($leng+$sociales+$edfisica+$edmusica+$artes+$matematicas+$informatica+$maturales+$religion)/9;
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}
		    $nota11= array(
			 'promfinal'=>$final);
			 $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $final);
        	$x++;
		 }
		 
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulador'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,1,$gestion);
		 $mate2=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,2,$gestion);
		 $mate3=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,3,$gestion);
		 $mate4=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,4,$gestion);
		 if($bi==1){
		 	$lenguaje=$mate[0]->lenguaje;
			$quechua=$mate[1]->quechua;
			$ingles=$mate[2]->ingles;
			$sociales=$mate[3]->sociales;
			$edfisica=$mate[4]->edfisica;
			$edmusica=$mate[5]->edmusica;
			$artes=$mate[6]->artes;
			$mate1=$mate[7]->mate;
			$infromatica=$mate[8]->infromatica;
			$fisica=$mate[9]->fisica;
			$quimica=$mate[10]->quimica;
			$naturales=$mate[11]->naturales;
			$filosofia=$mate[12]->filosofia;
			$religuion=$mate[13]->religuion;
		 }
		 if($bi==2){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
			$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica)/2);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales)/2);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 }
		 if($bi==3){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica)/3);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales)/3);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 }
		 if($bi==4){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica+$mate4[8]->infromatica)/4);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales+$mate4[11]->naturales)/4);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 }

		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);

		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

		    if($quechua<=50){$estilo3=$rojo;}
		    if($quechua>=51 ){$estilo3=$naranja;}
		    if($quechua>=70 ){$estilo3=$amarillo;}
		    if($quechua>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
		    
		    $leng=round(($quechua+$lenguaje)/2);
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}		
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
        	
		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
        	
        	if($infromatica<=50){$estilo3=$rojo;}
		    if($infromatica>=51 ){$estilo3=$naranja;}
		    if($infromatica>=70 ){$estilo3=$amarillo;}
		    if($infromatica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $infromatica);

		    if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $quimica);

        	$sistemas=round(($quimica+$fisica+$infromatica)/3);
        	if($sistemas<=50){$estilo3=$rojo;}
		    if($sistemas>=51 ){$estilo3=$naranja;}
		    if($sistemas>=70 ){$estilo3=$amarillo;}
		    if($sistemas>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $sistemas);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $naturales);

        	if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}

		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
$final=($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$sistemas+$naturales+$filosofia+$religuion)/11;
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		  //   $nota11= array(
			 // 'promfinal'=>$final);
			 // $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}",$final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
		$siste=0;
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	$contador1++;
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$quechua=$mate[1]->quechua;
				$ingles=$mate[2]->ingles;
				$sociales=$mate[3]->sociales;
				$edfisica=$mate[4]->edfisica;
				$edmusica=$mate[5]->edmusica;
				$artes=$mate[6]->artes;
				$mate1=$mate[7]->mate;
				$sistemas=$mate[14]->sistemas;
				$electronica=$mate[15]->electronica;
				$naturales=$mate[9]->naturales;
				$fisica=$mate[10]->fisica;
				$quimica=$mate[11]->quimica;
				$filosofia=$mate[12]->filosofia;
				$religuion=$mate[13]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
				$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas)/2);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica)/2);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales)/2);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica)/2);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica)/2);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas)/3);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica)/3);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales)/3);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica)/3);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica)/3);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas+$mate4[14]->sistemas)/4);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica+$mate4[15]->electronica)/4);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales+$mate4[9]->naturales)/4);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica+$mate4[10]->fisica)/4);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica+$mate4[11]->quimica)/4);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 	}
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

		    if($quechua<=50){$estilo3=$rojo;}
		    if($quechua>=51 ){$estilo3=$naranja;}
		    if($quechua>=70 ){$estilo3=$amarillo;}
		    if($quechua>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
		    
		    $leng=round(($quechua+$lenguaje)/2);
		    if( $leng<=50){$estilo3=$rojo;}
		    if( $leng>=51 ){$estilo3=$naranja;}
		    if( $leng>=70 ){$estilo3=$amarillo;}
		    if( $leng>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
        	
		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
			$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

        	if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);
        	
		   if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
			$final=($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13;
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		  //    $nota11= array(
			 // 'promfinal'=>$final);
			 // $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
   		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
       
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	$contador1++;
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$mate1=$mate[6]->mate;
				$sistemas=$mate[13]->sistemas;
				$electronica=$mate[14]->electronica;
				$naturales=$mate[8]->naturales;
				$fisica=$mate[9]->fisica;
				$quimica=$mate[10]->quimica;
				$filosofia=$mate[11]->filosofia;
				$religuion=$mate[12]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate)/2);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas)/2);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica)/2);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales)/2);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia)/2);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate)/3);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas)/3);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica)/3);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales)/3);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia)/3);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate+$mate4[6]->mate)/4);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas+$mate4[13]->sistemas)/4);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica+$mate4[14]->electronica)/4);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales+$mate4[8]->naturales)/4);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia+$mate4[11]->filosofia)/4);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion+$mate4[12]->religuion)/4);
		 	}
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
        	
		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

		    if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

        	if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
			$final=($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13;
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		  //    $nota11= array(
			 // 'promfinal'=>$final);
			 // $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
        	
		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

		    if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

        	if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
			$final=($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13;
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		  //   $nota11= array(
			 // 'promfinal'=>$final);
			 // $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ESTADISTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,1,$gestion);
		 	$mate2=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,2,$gestion);
		 	$mate3=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,3,$gestion);
		 	$mate4=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$estadisticas=$mate[17]->estadisticas;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas+$mate4[17]->estadisticas)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}

		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
        	
		    if($sociales<=50){$estilo3=$rojo;}
		    if($sociales>=51 ){$estilo3=$naranja;}
		    if($sociales>=70 ){$estilo3=$amarillo;}
		    if($sociales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);

        	if($estadisticas<=50){$estilo3=$rojo;}
		    if($estadisticas>=51 ){$estilo3=$naranja;}
		    if($estadisticas>=70 ){$estilo3=$amarillo;}
		    if($estadisticas>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $estadisticas);
        	$mateesta=($estadisticas+$mate1)/2;
        	if($mateesta<=50){$estilo3=$rojo;}
		    if($mateesta>=51 ){$estilo3=$naranja;}
		    if($mateesta>=70 ){$estilo3=$amarillo;}
		    if($mateesta>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mateesta);
        	//$siste=0;
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

		    if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);

        	if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
			$final=($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$mateesta+$siste+$fisica+$naturales+$filosofia+$religuion)/13;
			// $nota11= array(
			//  'promfinal'=>$final);
			//  $this->estud->update_nota_prom1($estud->id_est,$nota11);
			if($final<=50){$estilo3=$rojo;}
		    if($final>=51 ){$estilo3=$naranja;}
		    if($final>=70 ){$estilo3=$amarillo;}
		    if($final>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		   	//$this->excel->getActiveSheet()->setCellValue("S{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        $this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
  
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$historia=$mate[3]->historia;
				$civica=$mate[4]->civica;
				$geografia=$mate[5]->geografia;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/$bi);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/$bi);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia+$mate4[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica+$mate4[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia+$mate4[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/$bi);
		 	}
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
		    //foreach ($mate as $mates) {
		    if($lenguaje<=50){$estilo3=$rojo;}
		    if($lenguaje>=51 ){$estilo3=$naranja;}
		    if($lenguaje>=70 ){$estilo3=$amarillo;}
		    if($lenguaje>=90 ){$estilo3=$verde;}	
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
		    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
        	
		    if($ingles<=50){$estilo3=$rojo;}
		    if($ingles>=51 ){$estilo3=$naranja;}
		    if($ingles>=70 ){$estilo3=$amarillo;}
		    if($ingles>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
        	
		    if($historia<=50){$estilo3=$rojo;}
		    if($historia>=51 ){$estilo3=$naranja;}
		    if($historia>=70 ){$estilo3=$amarillo;}
		    if($historia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $historia);

        	if($civica<=50){$estilo3=$rojo;}
		    if($civica>=51 ){$estilo3=$naranja;}
		    if($civica>=70 ){$estilo3=$amarillo;}
		    if($civica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $civica);

        	if($geografia<=50){$estilo3=$rojo;}
		    if($geografia>=51 ){$estilo3=$naranja;}
		    if($geografia>=70 ){$estilo3=$amarillo;}
		    if($geografia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $geografia);
        	$soci=($geografia+$civica+$historia)/3;
        	if($soci<=50){$estilo3=$rojo;}
		    if($soci>=51 ){$estilo3=$naranja;}
		    if($soci>=70 ){$estilo3=$amarillo;}
		    if($soci>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $soci);
        	
		    if($edfisica<=50){$estilo3=$rojo;}
		    if($edfisica>=51 ){$estilo3=$naranja;}
		    if($edfisica>=70 ){$estilo3=$amarillo;}
		    if($edfisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edfisica);
        	
		    if($edmusica<=50){$estilo3=$rojo;}
		    if($edmusica>=51 ){$estilo3=$naranja;}
		    if($edmusica>=70 ){$estilo3=$amarillo;}
		    if($edmusica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $edmusica);
        	
		    if($artes<=50){$estilo3=$rojo;}
		    if($artes>=51 ){$estilo3=$naranja;}
		    if($artes>=70 ){$estilo3=$amarillo;}
		    if($artes>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $artes);
        	
		    if($mate1<=50){$estilo3=$rojo;}
		    if($mate1>=51 ){$estilo3=$naranja;}
		    if($mate1>=70 ){$estilo3=$amarillo;}
		    if($mate1>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate1);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $siste);

        	if($naturales<=50){$estilo3=$rojo;}
		    if($naturales>=51 ){$estilo3=$naranja;}
		    if($naturales>=70 ){$estilo3=$amarillo;}
		    if($naturales>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $naturales);


		    if($fisica<=50){$estilo3=$rojo;}
		    if($fisica>=51 ){$estilo3=$naranja;}
		    if($fisica>=70 ){$estilo3=$amarillo;}
		    if($fisica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $fisica);
        	
		    if($quimica<=50){$estilo3=$rojo;}
		    if($quimica>=51 ){$estilo3=$naranja;}
		    if($quimica>=70 ){$estilo3=$amarillo;}
		    if($quimica>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $quimica);

        	if($filosofia<=50){$estilo3=$rojo;}
		    if($filosofia>=51 ){$estilo3=$naranja;}
		    if($filosofia>=70 ){$estilo3=$amarillo;}
		    if($filosofia>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

        	if($religuion<=50){$estilo3=$rojo;}
		    if($religuion>=51 ){$estilo3=$naranja;}
		    if($religuion>=70 ){$estilo3=$amarillo;}
		    if($religuion>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
        	$final=($lenguaje+$ingles+$soci+$edfisica+$edmusica+$artes+$mate1+$siste+$naturales+$fisica+$quimica+$filosofia+$religuion)/13;
        	if( $final<=50){$estilo3=$rojo;}
		    if( $final>=51 ){$estilo3=$naranja;}
		    if( $final>=70 ){$estilo3=$amarillo;}
		    if( $final>=90 ){$estilo3=$verde;}
		  //   $nota11= array(
			 // 'promfinal'=>$final);
			 // $this->estud->update_nota_prom1($estud->id_est,$nota11);
		   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3); 
    		
		   	$estilo3=$estilo;
        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}", $final);
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function acumulador6to($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		$list=$this->estud->gest_est_6($cur,$nivel,$gestion);
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
    $contador1=3;
    if(($nivel=='ST' OR $nivel=='SM') AND ( $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(20);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:C{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'INFORMATICA');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
		 	}
		 	if($bi==2){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
		 	}
		 	if($bi==3){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
		 	}

		 	if($bi==4){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
		 	}
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:C{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $siste);
		   	$estilo3=$estilo;
        	
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ( $cur=='6B')  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(20);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:C{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'INFORMATICA');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,1,$gestion);
		 	$mate2=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,2,$gestion);
		 	$mate3=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,3,$gestion);
		 	$mate4=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,4,$gestion);
		 	if($bi==1){
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
		 	}
		 	if($bi==2){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
		 	}
		 	if($bi==3){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
		 	}
		 	if($bi==4){
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
		 	}
		 	$contador1++;
		 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:C{$contador1}")->applyFromArray($estilobor);
		    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
		    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
        	if($sistemas==0)
        	{
        		$siste=$electronica;
        	}
        	if($electronica==0)
        	{
        		$siste=$sistemas;
        	}
        	if($siste<=50){$estilo3=$rojo;}
		    if($siste>=51 ){$estilo3=$naranja;}
		    if($siste>=70 ){$estilo3=$amarillo;}
		    if($siste>=90 ){$estilo3=$verde;}
		   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
		   	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $siste);
		   	$estilo3=$estilo;
        	$x++;
        	//}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function acumulador_rep($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		$list=$this->estud->gest_est($codigo,$gestion);
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        	$contador1=3;
		if($nivel=='PM' OR $nivel=='PT'  ){
		$this->excel->getActiveSheet()->setTitle('acumulador reprobados'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create

        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'GR. ES.:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":I".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("J".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'V.T.T.');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MAT');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'TT');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:N{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CIENCIAS NATURALES');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("N".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1-2).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,1,$gestion);
		 	$mate2=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,2,$gestion);
		 	$mate3=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,3,$gestion);
		 	$mate4=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,4,$gestion);
		 	
		    if($bi==1){
		    	$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$matematicas=$mate[6]->matematicas;
				$informatica=$mate[7]->informatica;
				$maturales=$mate[8]->maturales;
				$religion=$mate[9]->religion;
		    }
		    if($bi==2){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas)/2);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica)/2);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales)/2);
				$religion=round(($mate[9]->religion+$mate2[9]->religion)/2);
		    }
		    if($bi==3){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas)/3);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica)/3);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales)/3);
				$religion=round(($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion)/3);
		    }
		    if($bi==4){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas+$mate4[6]->matematicas)/4);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica+$mate4[7]->informatica)/4);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales+$mate4[8]->maturales)/4);
				$religion=round(($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion+$mate4[9]->religion)/4);
		    }
		    if($lenguaje<=50 OR $ingles<=50 OR $leng<=50 OR 
				$sociales<=50 OR $edfisica<=50 OR $edmusica<=50 OR 
				$artes<=50 OR $matematicas<= 50 OR $informatica<= 50 OR 
				$maturales<= 50 OR $religion<=50){
		    	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);

			    $leng=round(($lenguaje+$ingles)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);

			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $sociales);

			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edfisica);

			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edmusica);

			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $artes);

			    if($matematicas<=50){$estilo3=$rojo;}
			    if($matematicas>=51 ){$estilo3=$naranja;}
			    if($matematicas>=70 ){$estilo3=$amarillo;}
			    if($matematicas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $matematicas);

			    if($informatica<=50){$estilo3=$rojo;}
			    if($informatica>=51 ){$estilo3=$naranja;}
			    if($informatica>=70 ){$estilo3=$amarillo;}
			    if($informatica>=90 ){$estilo3=$verde;}
			    $this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $informatica);

			    if($maturales<=50){$estilo3=$rojo;}
			    if($maturales>=51 ){$estilo3=$naranja;}
			    if($maturales>=70 ){$estilo3=$amarillo;}
			    if($maturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $maturales);

			    if($religion<=50){$estilo3=$rojo;}
			    if($religion>=51 ){$estilo3=$naranja;}
			    if($religion>=70 ){$estilo3=$amarillo;}
			    if($religion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $religion);

	        	$final=round(($leng+$sociales+$edfisica+$edmusica+$artes+$matematicas+$informatica+$maturales+$religion)/9);
	        	if( $final<=50){$estilo3=$rojo;}
			    if( $final>=51 ){$estilo3=$naranja;}
			    if( $final>=70 ){$estilo3=$amarillo;}
			    if( $final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $final);
	        	$x++;
        	}
		 }
		 
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulador'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,1,$gestion);
		 $mate2=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,2,$gestion);
		 $mate3=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,3,$gestion);
		 $mate4=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,4,$gestion);
		 if($bi==1){
		 	$lenguaje=$mate[0]->lenguaje;
			$quechua=$mate[1]->quechua;
			$ingles=$mate[2]->ingles;
			$sociales=$mate[3]->sociales;
			$edfisica=$mate[4]->edfisica;
			$edmusica=$mate[5]->edmusica;
			$artes=$mate[6]->artes;
			$mate1=$mate[7]->mate;
			$infromatica=$mate[8]->infromatica;
			$fisica=$mate[9]->fisica;
			$quimica=$mate[10]->quimica;
			$naturales=$mate[11]->naturales;
			$filosofia=$mate[12]->filosofia;
			$religuion=$mate[13]->religuion;
		 }
		 if($bi==2){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
			$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica)/2);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales)/2);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 }
		 if($bi==3){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica)/3);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales)/3);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 }
		 if($bi==4){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica+$mate4[8]->infromatica)/4);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales+$mate4[11]->naturales)/4);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 }
		 if($lenguaje<=50 OR$quechua<=50 OR $ingles<=50 OR $sociales<=50 OR
			$edfisica<=50 OR $edmusica<=50 OR $artes<=50 OR $mate1<=50 OR
			$infromatica<=50 OR $fisica<=50 OR $quimica<=50 OR
			$naturales<=50 OR $filosofia<=50 OR $religuion<=50){

			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);

			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($quechua<=50){$estilo3=$rojo;}
			    if($quechua>=51 ){$estilo3=$naranja;}
			    if($quechua>=70 ){$estilo3=$amarillo;}
			    if($quechua>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
			    
			    $leng=round(($quechua+$lenguaje)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}		
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
	        	
	        	if($infromatica<=50){$estilo3=$rojo;}
			    if($infromatica>=51 ){$estilo3=$naranja;}
			    if($infromatica>=70 ){$estilo3=$amarillo;}
			    if($infromatica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $infromatica);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $quimica);

	        	$sistemas=round(($quimica+$fisica+$infromatica)/3);
	        	if($sistemas<=50){$estilo3=$rojo;}
			    if($sistemas>=51 ){$estilo3=$naranja;}
			    if($sistemas>=70 ){$estilo3=$amarillo;}
			    if($sistemas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $sistemas);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $naturales);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}

			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
	$final=round(($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$sistemas+$naturales+$filosofia+$religuion)/11);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}",$final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulado reprobados'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
		$siste=0;
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$quechua=$mate[1]->quechua;
				$ingles=$mate[2]->ingles;
				$sociales=$mate[3]->sociales;
				$edfisica=$mate[4]->edfisica;
				$edmusica=$mate[5]->edmusica;
				$artes=$mate[6]->artes;
				$mate1=$mate[7]->mate;
				$sistemas=$mate[14]->sistemas;
				$electronica=$mate[15]->electronica;
				$naturales=$mate[9]->naturales;
				$fisica=$mate[10]->fisica;
				$quimica=$mate[11]->quimica;
				$filosofia=$mate[12]->filosofia;
				$religuion=$mate[13]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
				$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas)/2);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica)/2);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales)/2);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica)/2);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica)/2);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas)/3);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica)/3);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales)/3);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica)/3);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica)/3);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas+$mate4[14]->sistemas)/4);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica+$mate4[15]->electronica)/4);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales+$mate4[9]->naturales)/4);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica+$mate4[10]->fisica)/4);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica+$mate4[11]->quimica)/4);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 	}
		 	if( $lenguaje<=50 OR $quechua<=50 OR $ingles<=50 OR $sociales<=50 OR $edfisica<=50 OR
				$edmusica<=50 OR $artes<=50 OR $mate1<=50 OR ($sistemas<=50 AND  $electronica==0) OR ($electronica<=50 AND $sistemas==50 )OR
				$naturales<=50 OR $fisica<=50 OR $quimica<=50 OR $filosofia<=50 OR $religuion<=50)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($quechua<=50){$estilo3=$rojo;}
			    if($quechua>=51 ){$estilo3=$naranja;}
			    if($quechua>=70 ){$estilo3=$amarillo;}
			    if($quechua>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
			    
			    $leng=round(($quechua+$lenguaje)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
				$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

	        	if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);
	        	
			   if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
				$final=round(($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
   		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
       
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$mate1=$mate[6]->mate;
				$sistemas=$mate[13]->sistemas;
				$electronica=$mate[14]->electronica;
				$naturales=$mate[8]->naturales;
				$fisica=$mate[9]->fisica;
				$quimica=$mate[10]->quimica;
				$filosofia=$mate[11]->filosofia;
				$religuion=$mate[12]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate)/2);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas)/2);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica)/2);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales)/2);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia)/2);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate)/3);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas)/3);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica)/3);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales)/3);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia)/3);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate+$mate4[6]->mate)/4);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas+$mate4[13]->sistemas)/4);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica+$mate4[14]->electronica)/4);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales+$mate4[8]->naturales)/4);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia+$mate4[11]->filosofia)/4);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion+$mate4[12]->religuion)/4);
		 	}
		 	if( $lenguaje<=50 OR $ingles<=50 OR $sociales<=50 OR $edfisica<=50 OR $edmusica<=50 OR
				$artes<=50 OR $mate1<=50 OR ($sistemas<=50 AND  $electronica==0) OR ($electronica<=50 AND $sistemas==50 )
				 OR $naturales<=50 OR $fisica<=50 OR $quimica<=50 OR $filosofia<=50 OR $religuion<=50)
			{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	if(	$lenguaje<=50 OR $ingles<=50 OR $sociales<=50 OR $edfisica<=50 OR $edmusica<=50 OR
				$artes<=50 OR $mate1<=50 OR ($sistemas<=50 AND  $electronica==0) OR ($electronica<=50 AND $sistemas==50 )
				 OR $naturales<=50 OR $fisica<=50 OR $quimica<=50 OR $filosofia<=50 OR $religuion<=50)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ESTADISTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,1,$gestion);
		 	$mate2=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,2,$gestion);
		 	$mate3=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,3,$gestion);
		 	$mate4=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$estadisticas=$mate[17]->estadisticas;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas+$mate4[17]->estadisticas)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	if(	$lenguaje<=50 OR $ingles<=50 OR $sociales<=50 OR $edfisica<=50 OR $edmusica<=50 OR $artes<=50 OR 
		 		$mate1<=50 OR $estadisticas<=50 OR($sistemas<=50 AND  $electronica==0) OR ($electronica<=50 AND $sistemas==50 ) OR
				$naturales<=50 OR $fisica<=50 OR $quimica<=50 OR $filosofia<=50 OR $religuion<=50)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}

			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);

	        	if($estadisticas<=50){$estilo3=$rojo;}
			    if($estadisticas>=51 ){$estilo3=$naranja;}
			    if($estadisticas>=70 ){$estilo3=$amarillo;}
			    if($estadisticas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $estadisticas);
	        	$mateesta=($estadisticas+$mate1)/2;
	        	if($mateesta<=50){$estilo3=$rojo;}
			    if($mateesta>=51 ){$estilo3=$naranja;}
			    if($mateesta>=70 ){$estilo3=$amarillo;}
			    if($mateesta>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mateesta);
	        	//$siste=0;
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$mateesta+$siste+$fisica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			   	//$this->excel->getActiveSheet()->setCellValue("S{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        $this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
  
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$historia=$mate[3]->historia;
				$civica=$mate[4]->civica;
				$geografia=$mate[5]->geografia;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/$bi);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/$bi);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia+$mate4[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica+$mate4[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia+$mate4[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/$bi);
		 	}
		 	if(	$lenguaje<=50 OR $ingles<=50 OR $historia<=50 OR $civica<=50 OR $geografia<=50 OR $edfisica<=50 OR $edmusica<=50 
		 		OR $artes<=50 OR $mate1<=50 OR($sistemas<=50 AND  $electronica==0) OR ($electronica<=50 AND $sistemas==50 ) OR
				$naturales<=50 OR $fisica<=50 OR $quimica<=50 OR $filosofia<=50 OR $religuion<=50)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($historia<=50){$estilo3=$rojo;}
			    if($historia>=51 ){$estilo3=$naranja;}
			    if($historia>=70 ){$estilo3=$amarillo;}
			    if($historia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $historia);

	        	if($civica<=50){$estilo3=$rojo;}
			    if($civica>=51 ){$estilo3=$naranja;}
			    if($civica>=70 ){$estilo3=$amarillo;}
			    if($civica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $civica);

	        	if($geografia<=50){$estilo3=$rojo;}
			    if($geografia>=51 ){$estilo3=$naranja;}
			    if($geografia>=70 ){$estilo3=$amarillo;}
			    if($geografia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $geografia);
	        	$soci=($geografia+$civica+$historia)/3;
	        	if($soci<=50){$estilo3=$rojo;}
			    if($soci>=51 ){$estilo3=$naranja;}
			    if($soci>=70 ){$estilo3=$amarillo;}
			    if($soci>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $soci);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $naturales);


			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
	        	$final=round(($lenguaje+$ingles+$soci+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$filosofia+$religuion)/13);
	        	if( $final<=50){$estilo3=$rojo;}
			    if( $final>=51 ){$estilo3=$naranja;}
			    if( $final>=70 ){$estilo3=$amarillo;}
			    if( $final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3); 
	    		
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function acumulador_rep1($id) //impresion centralizador
	{
		
		$ids=explode('_', $id, -1);
		//print_r($ids);
		//exit();
		$bi=$ids[0]; 
		$codigo=$ids[1];
		$gestion=$ids[2];
		$nivel=$ids[3];
		$cur=$ids[4];
		$reprobados=$ids[5];
		//print_r($ids[5]);
		//exit();
		$list=$this->estud->gest_est($codigo,$gestion);
		$ni=$this->estud->get_niveles($nivel);
		 foreach ($ni as $nis) 
         {
         	$niveles=$nis->nivel;
         	$turno=$nis->turno;
         	$id_col=$nis->id_col;
         }
         $col=$this->estud->get_colegio($id_col);
         foreach ($col as $cols) 
         {
         	$colegio=$cols->nombre;
         }
         $bim=$this->estud->get_bimestre($bi);
         foreach ($bim as $bims) 
         {
         	$bimestre=$bims->nombre;
         }
         $cur1=$this->estud->get_cursos($cur);
         foreach ($cur1 as $curs) 
         {
         	$cursos=$curs->nombre;
         }

         $rojo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fa6737')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $naranja = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'ffb748')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $amarillo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'f9f966')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $verde = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 9,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '95e886')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
         $estilo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => 'ffffff'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => '2080e1')
        ),
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $estilobor = array(
		'borders' => array(
          'allborders' => array(
              'style' => PHPExcel_Style_Border::BORDER_THIN
          )
      ),
		'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'd7eafa')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_GENERAL,
            'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        )
	);
        $titulo = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 20,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID,
            'color' => array('rgb' => 'fbfcf9')
        ),
		'alignment' => array(
            'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        )
	);
        $negra = array(
    	'font'  => array(
        'bold'  => true,
        'size'  => 10,
        'color' => array('rgb' => '000000'),
        //'startcolor' => array('rgb' => '00B050'),
        'name'  => 'Verdana'
    ),
    	'fill' => array(
            'type' => PHPExcel_Style_Fill::FILL_SOLID
         
        )
	);
        	$contador1=3;
		if($nivel=='PM' OR $nivel=='PT'  ){
		$this->excel->getActiveSheet()->setTitle('acumulador reprobados'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create

        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(7);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);
      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'GR. ES.:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("A{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'NIVEL:');
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":I".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("J".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'V.T.T.');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MAT');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'TT');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:N{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'CIENCIAS NATURALES');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("N".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1-2).":N".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,1,$gestion);
		 	$mate2=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,2,$gestion);
		 	$mate3=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,3,$gestion);
		 	$mate4=$this->estud->get_mate_primaria($estud->id_est,1,3,5,9,10,11,12,13,20,25,4,$gestion);
		 	
		    if($bi==1){
		    	$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$matematicas=$mate[6]->matematicas;
				$informatica=$mate[7]->informatica;
				$maturales=$mate[8]->maturales;
				$religion=$mate[9]->religion;
		    }
		    if($bi==2){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas)/2);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica)/2);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales)/2);
				$religion=round(($mate[9]->religion+$mate2[9]->religion)/2);
		    }
		    if($bi==3){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas)/3);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica)/3);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales)/3);
				$religion=round(($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion)/3);
		    }
		    if($bi==4){
		    	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$leng=round(($lenguaje+$ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4);
				$matematicas=round(($mate[6]->matematicas+$mate2[6]->matematicas+$mate3[6]->matematicas+$mate4[6]->matematicas)/4);
				$informatica=round(($mate[7]->informatica+$mate2[7]->informatica+$mate3[7]->informatica+$mate4[7]->informatica)/4);
				$maturales=round(($mate[8]->maturales+$mate2[8]->maturales+$mate3[8]->maturales+$mate4[8]->maturales)/4);
				$religion=round(($mate[9]->religion+$mate2[9]->religion+$mate3[9]->religion+$mate4[9]->religion)/4);
		    }
		    if($lenguaje<=53 OR $ingles<=53 OR $leng<=53 OR 
				$sociales<=53 OR $edfisica<=53 OR $edmusica<=53 OR 
				$artes<=53 OR $matematicas<= 53 OR $informatica<= 53 OR 
				$maturales<= 53 OR $religion<=53){
		    	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);

			    $leng=round(($lenguaje+$ingles)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);

			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $sociales);

			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edfisica);

			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edmusica);

			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $artes);

			    if($matematicas<=50){$estilo3=$rojo;}
			    if($matematicas>=51 ){$estilo3=$naranja;}
			    if($matematicas>=70 ){$estilo3=$amarillo;}
			    if($matematicas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $matematicas);

			    if($informatica<=50){$estilo3=$rojo;}
			    if($informatica>=51 ){$estilo3=$naranja;}
			    if($informatica>=70 ){$estilo3=$amarillo;}
			    if($informatica>=90 ){$estilo3=$verde;}
			    $this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $informatica);

			    if($maturales<=50){$estilo3=$rojo;}
			    if($maturales>=51 ){$estilo3=$naranja;}
			    if($maturales>=70 ){$estilo3=$amarillo;}
			    if($maturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $maturales);

			    if($religion<=50){$estilo3=$rojo;}
			    if($religion>=51 ){$estilo3=$naranja;}
			    if($religion>=70 ){$estilo3=$amarillo;}
			    if($religion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $religion);

	        	$final=round(($leng+$sociales+$edfisica+$edmusica+$artes+$matematicas+$informatica+$maturales+$religion)/9);
	        	if( $final<=50){$estilo3=$rojo;}
			    if( $final>=51 ){$estilo3=$naranja;}
			    if( $final>=70 ){$estilo3=$amarillo;}
			    if( $final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $final);
	        	$x++;
        	}
		 }
		 
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='1A' OR $cur=='1B' OR $cur=='2A' OR $cur=='2B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulador'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":S".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 $mate=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,1,$gestion);
		 $mate2=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,2,$gestion);
		 $mate3=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,3,$gestion);
		 $mate4=$this->estud->get_mate($estud->id_est,1,2,4,5,9,10,11,12,14,15,16,21,24,25,4,$gestion);
		 if($bi==1){
		 	$lenguaje=$mate[0]->lenguaje;
			$quechua=$mate[1]->quechua;
			$ingles=$mate[2]->ingles;
			$sociales=$mate[3]->sociales;
			$edfisica=$mate[4]->edfisica;
			$edmusica=$mate[5]->edmusica;
			$artes=$mate[6]->artes;
			$mate1=$mate[7]->mate;
			$infromatica=$mate[8]->infromatica;
			$fisica=$mate[9]->fisica;
			$quimica=$mate[10]->quimica;
			$naturales=$mate[11]->naturales;
			$filosofia=$mate[12]->filosofia;
			$religuion=$mate[13]->religuion;
		 }
		 if($bi==2){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
			$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica)/2);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales)/2);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 }
		 if($bi==3){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica)/3);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales)/3);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 }
		 if($bi==4){
		 	$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
			$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
			$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
			$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
			$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
			$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
			$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
			$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
			$infromatica=round(($mate[8]->infromatica+$mate2[8]->infromatica+$mate3[8]->infromatica+$mate4[8]->infromatica)/4);
			$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
			$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
			$naturales=round(($mate[11]->naturales+$mate2[11]->naturales+$mate3[11]->naturales+$mate4[11]->naturales)/4);
			$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
			$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 }
		 if($lenguaje<=53 OR$quechua<=53 OR $ingles<=53 OR $sociales<=53 OR
			$edfisica<=53 OR $edmusica<=53 OR $artes<=53 OR $mate1<=53 OR
			$infromatica<=53 OR $fisica<=53 OR $quimica<=53 OR
			$naturales<=53 OR $filosofia<=53 OR $religuion<=53){

			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);

			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($quechua<=50){$estilo3=$rojo;}
			    if($quechua>=51 ){$estilo3=$naranja;}
			    if($quechua>=70 ){$estilo3=$amarillo;}
			    if($quechua>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
			    
			    $leng=round(($quechua+$lenguaje)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}		
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
	        	
	        	if($infromatica<=50){$estilo3=$rojo;}
			    if($infromatica>=51 ){$estilo3=$naranja;}
			    if($infromatica>=70 ){$estilo3=$amarillo;}
			    if($infromatica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $infromatica);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $quimica);

	        	$sistemas=round(($quimica+$fisica+$infromatica)/3);
	        	if($sistemas<=50){$estilo3=$rojo;}
			    if($sistemas>=51 ){$estilo3=$naranja;}
			    if($sistemas>=70 ){$estilo3=$amarillo;}
			    if($sistemas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $sistemas);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $naturales);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}

			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
	$final=round(($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$sistemas+$naturales+$filosofia+$religuion)/11);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}",$final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='3A' OR $cur=='3B')  ){
		$this->excel->getActiveSheet()->setTitle('acumulado reprobados'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
		$siste=0;
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":L".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":R".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":E".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'QUECHUA');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate4($estud->id_est,1,2,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$quechua=$mate[1]->quechua;
				$ingles=$mate[2]->ingles;
				$sociales=$mate[3]->sociales;
				$edfisica=$mate[4]->edfisica;
				$edmusica=$mate[5]->edmusica;
				$artes=$mate[6]->artes;
				$mate1=$mate[7]->mate;
				$sistemas=$mate[14]->sistemas;
				$electronica=$mate[15]->electronica;
				$naturales=$mate[9]->naturales;
				$fisica=$mate[10]->fisica;
				$quimica=$mate[11]->quimica;
				$filosofia=$mate[12]->filosofia;
				$religuion=$mate[13]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua)/2);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles)/2);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales)/2);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica)/2);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica)/2);
				$artes=round(($mate[6]->artes+$mate2[6]->artes)/2);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate)/2);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas)/2);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica)/2);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales)/2);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica)/2);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica)/2);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia)/2);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua)/3);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles)/3);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales)/3);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica)/3);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica)/3);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes)/3);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate)/3);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas)/3);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica)/3);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales)/3);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica)/3);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica)/3);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia)/3);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$quechua=round(($mate[1]->quechua+$mate2[1]->quechua+$mate3[1]->quechua+$mate4[1]->quechua)/4);
				$ingles=round(($mate[2]->ingles+$mate2[2]->ingles+$mate3[2]->ingles+$mate4[2]->ingles)/4);
				$sociales=round(($mate[3]->sociales+$mate2[3]->sociales+$mate3[3]->sociales+$mate4[3]->sociales)/4);
				$edfisica=round(($mate[4]->edfisica+$mate2[4]->edfisica+$mate3[4]->edfisica+$mate4[4]->edfisica)/4);
				$edmusica=round(($mate[5]->edmusica+$mate2[5]->edmusica+$mate3[5]->edmusica+$mate4[5]->edmusica)/4);
				$artes=round(($mate[6]->artes+$mate2[6]->artes+$mate3[6]->artes+$mate4[6]->artes)/4);
				$mate1=round(($mate[7]->mate+$mate2[7]->mate+$mate3[7]->mate+$mate4[7]->mate)/4);
				$sistemas=round(($mate[14]->sistemas+$mate2[14]->sistemas+$mate3[14]->sistemas+$mate4[14]->sistemas)/4);
				$electronica=round(($mate[15]->electronica+$mate2[15]->electronica+$mate3[15]->electronica+$mate4[15]->electronica)/4);
				$naturales=round(($mate[9]->naturales+$mate2[9]->naturales+$mate3[9]->naturales+$mate4[9]->naturales)/4);
				$fisica=round(($mate[10]->fisica+$mate2[10]->fisica+$mate3[10]->fisica+$mate4[10]->fisica)/4);
				$quimica=round(($mate[11]->quimica+$mate2[11]->quimica+$mate3[11]->quimica+$mate4[11]->quimica)/4);
				$filosofia=round(($mate[12]->filosofia+$mate2[12]->filosofia+$mate3[12]->filosofia+$mate4[12]->filosofia)/4);
				$religuion=round(($mate[13]->religuion+$mate2[13]->religuion+$mate3[13]->religuion+$mate4[13]->religuion)/4);
		 	}
		 	if( $lenguaje<=53 OR $quechua<=53 OR $ingles<=53 OR $sociales<=53 OR $edfisica<=53 OR
				$edmusica<=53 OR $artes<=53 OR $mate1<=53 OR ($sistemas<=53 AND  $electronica==0) OR ($electronica<=53 AND $sistemas==53 )OR
				$naturales<=53 OR $fisica<=53 OR $quimica<=53 OR $filosofia<=53 OR $religuion<=53)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);

			    if($quechua<=50){$estilo3=$rojo;}
			    if($quechua>=51 ){$estilo3=$naranja;}
			    if($quechua>=70 ){$estilo3=$amarillo;}
			    if($quechua>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("D{$contador1}", $quechua);
			    
			    $leng=round(($quechua+$lenguaje)/2);
			    if( $leng<=50){$estilo3=$rojo;}
			    if( $leng>=51 ){$estilo3=$naranja;}
			    if( $leng>=70 ){$estilo3=$amarillo;}
			    if( $leng>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $leng);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
				$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

	        	if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);
	        	
			   if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
				$final=round(($leng+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
   if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='4A' OR $cur=='4B')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
   		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
       
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate6($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[3]->edfisica;
				$edmusica=$mate[4]->edmusica;
				$artes=$mate[5]->artes;
				$mate1=$mate[6]->mate;
				$sistemas=$mate[13]->sistemas;
				$electronica=$mate[14]->electronica;
				$naturales=$mate[8]->naturales;
				$fisica=$mate[9]->fisica;
				$quimica=$mate[10]->quimica;
				$filosofia=$mate[11]->filosofia;
				$religuion=$mate[12]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica)/2);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica)/2);
				$artes=round(($mate[5]->artes+$mate2[5]->artes)/2);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate)/2);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas)/2);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica)/2);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales)/2);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica)/2);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica)/2);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia)/2);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica)/3);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica)/3);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes)/3);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate)/3);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas)/3);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica)/3);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales)/3);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica)/3);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica)/3);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia)/3);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[3]->edfisica+$mate2[3]->edfisica+$mate3[3]->edfisica+$mate4[3]->edfisica)/4);
				$edmusica=round(($mate[4]->edmusica+$mate2[4]->edmusica+$mate3[4]->edmusica+$mate4[4]->edmusica)/4);
				$artes=round(($mate[5]->artes+$mate2[5]->artes+$mate3[5]->artes+$mate4[5]->artes)/4);
				$mate1=round(($mate[6]->mate+$mate2[6]->mate+$mate3[6]->mate+$mate4[6]->mate)/4);
				$sistemas=round(($mate[13]->sistemas+$mate2[13]->sistemas+$mate3[13]->sistemas+$mate4[13]->sistemas)/4);
				$electronica=round(($mate[14]->electronica+$mate2[14]->electronica+$mate3[14]->electronica+$mate4[14]->electronica)/4);
				$naturales=round(($mate[8]->naturales+$mate2[8]->naturales+$mate3[8]->naturales+$mate4[8]->naturales)/4);
				$fisica=round(($mate[9]->fisica+$mate2[9]->fisica+$mate3[9]->fisica+$mate4[9]->fisica)/4);
				$quimica=round(($mate[10]->quimica+$mate2[10]->quimica+$mate3[10]->quimica+$mate4[10]->quimica)/4);
				$filosofia=round(($mate[11]->filosofia+$mate2[11]->filosofia+$mate3[11]->filosofia+$mate4[11]->filosofia)/4);
				$religuion=round(($mate[12]->religuion+$mate2[12]->religuion+$mate3[12]->religuion+$mate4[12]->religuion)/4);
		 	}
		 	if( $lenguaje<=53 OR $ingles<=53 OR $sociales<=53 OR $edfisica<=53 OR $edmusica<=53 OR
				$artes<=53 OR $mate1<=53 OR ($sistemas<=53 AND  $electronica==0) OR ($electronica<=53 AND $sistemas==53 )
				 OR $naturales<=53 OR $fisica<=53 OR $quimica<=53 OR $filosofia<=53 OR $religuion<=53)
			{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5A'  OR $cur=='6A')  ){
        //Le aplicamos ancho las columnas.
        //print_r($ids);
		//exit();
		$this->excel->getActiveSheet()->setTitle('acumulado'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":J".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:P{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("P".($contador1-2))->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1-2).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate1($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}

		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	if(	$lenguaje<=53 OR $ingles<=53 OR $sociales<=53 OR $edfisica<=53 OR $edmusica<=53 OR
				$artes<=53 OR $mate1<=53 OR ($sistemas<=53 AND  $electronica==0) OR ($electronica<=53 AND $sistemas==53 )
				 OR $naturales<=53 OR $fisica<=53 OR $quimica<=53 OR $filosofia<=53 OR $religuion<=53)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5B' OR $cur=='6B')  ){
		$this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":L".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("M".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("P".($contador1).":Q".($contador1));
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'APLV');
        $this->excel->setActiveSheetIndex(0)->mergeCells("I".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'TTG');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:R{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CIENCIAS SOCIALES');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ESTADISTICAS');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'FISICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'QUIMICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'RELIGION');
        $this->excel->getActiveSheet()->getStyle("R".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("R".($contador1-2).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("R".($contador1-2), 'FINAL');
    
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,1,$gestion);
		 	$mate2=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,2,$gestion);
		 	$mate3=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,3,$gestion);
		 	$mate4=$this->estud->get_mate3($estud->id_est,1,4,5,9,10,11,12,18,19,21,22,23,24,25,26,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$sociales=$mate[2]->sociales;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$estadisticas=$mate[17]->estadisticas;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/2);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/2);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales)/2);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/2);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/2);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/2);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/2);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas)/2);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/2);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/2);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/2);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/2);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/2);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/2);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/2);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/3);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/3);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales)/3);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/3);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/3);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/3);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/3);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas)/3);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/3);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/3);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/3);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/3);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/3);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/3);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/3);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/4);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/4);
				$sociales=round(($mate[2]->sociales+$mate2[2]->sociales+$mate3[2]->sociales+$mate4[2]->sociales)/4);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/4);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/4);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/4);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/4);
				$estadisticas=round(($mate[17]->estadisticas+$mate2[17]->estadisticas+$mate3[17]->estadisticas+$mate4[17]->estadisticas)/4);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/4);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/4);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/4);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/4);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/4);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/4);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/4);
		 	}
		 	if(	$lenguaje<=53 OR $ingles<=53 OR $sociales<=53 OR $edfisica<=53 OR $edmusica<=53 OR $artes<=53 OR 
		 		$mate1<=53 OR $estadisticas<=53 OR($sistemas<=53 AND  $electronica==0) OR ($electronica<=53 AND $sistemas==53 ) OR
				$naturales<=53 OR $fisica<=53 OR $quimica<=53 OR $filosofia<=53 OR $religuion<=53)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:P{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}

			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($sociales<=50){$estilo3=$rojo;}
			    if($sociales>=51 ){$estilo3=$naranja;}
			    if($sociales>=70 ){$estilo3=$amarillo;}
			    if($sociales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $sociales);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $mate1);

	        	if($estadisticas<=50){$estilo3=$rojo;}
			    if($estadisticas>=51 ){$estilo3=$naranja;}
			    if($estadisticas>=70 ){$estilo3=$amarillo;}
			    if($estadisticas>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $estadisticas);
	        	$mateesta=($estadisticas+$mate1)/2;
	        	if($mateesta<=50){$estilo3=$rojo;}
			    if($mateesta>=51 ){$estilo3=$naranja;}
			    if($mateesta>=70 ){$estilo3=$amarillo;}
			    if($mateesta>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $mateesta);
	        	//$siste=0;
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $naturales);

			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $religuion);
				$final=round(($lenguaje+$ingles+$sociales+$edfisica+$edmusica+$artes+$mate1+$mateesta+$siste+$fisica+$naturales+$filosofia+$religuion)/13);
				if($final<=50){$estilo3=$rojo;}
			    if($final>=51 ){$estilo3=$naranja;}
			    if($final>=70 ){$estilo3=$amarillo;}
			    if($final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			   	//$this->excel->getActiveSheet()->setCellValue("S{$contador1}", "=ROUND(AVERAGE(C{$contador1}:R{$contador1}),0)"); 
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');
    }
    if(($nivel=='ST' OR $nivel=='SM') AND ($cur=='5C' OR $cur=='6C')  ){
        //Le aplicamos ancho las columnas.
        $this->excel->getActiveSheet()->setTitle('REPROBADOS'); //sheetname
    	$newsheet = $this->excel->createSheet(); //sheet create
        $this->excel->getActiveSheet()->getColumnDimension('A')->setWidth(8);
        $this->excel->getActiveSheet()->getColumnDimension('B')->setWidth(45);
        $this->excel->getActiveSheet()->getColumnDimension('C')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('D')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('E')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('F')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('G')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('H')->setWidth(5);
        $this->excel->getActiveSheet()->getColumnDimension('I')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('J')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('K')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('L')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('M')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('N')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('O')->setWidth(5);
      	$this->excel->getActiveSheet()->getColumnDimension('P')->setWidth(6);
      	$this->excel->getActiveSheet()->getColumnDimension('Q')->setWidth(7);
      	$this->excel->getActiveSheet()->getColumnDimension('R')->setWidth(5);
      	//$this->excel->getActiveSheet()->getColumnDimension('S')->setWidth(5);
      	
      	$this->excel->getActiveSheet()->getProtection()->setPassword('chonchon2022'); 
		$this->excel->getActiveSheet()->getProtection()->setSheet(true); 
      	$this->drawing->setName('Logotipo1');
		$this->drawing->setDescription('Logotipo1');
		$img = imagecreatefrompng('assets/images/logo.png');
		$this->drawing->setImageResource($img);
		$this->drawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_PNG);
		$this->drawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);
		$this->drawing->setHeight(80);
		$this->drawing->setCoordinates('A1');
		$this->drawing->setWorksheet($this->excel->getActiveSheet());
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", 'CENTRALIZADOR ACUMULADO AL');
      	$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:N{$contador1}")->applyFromArray($titulo);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1).":N".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("A{$contador1}", $bimestre);

      	$contador1++;$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'GRADO ESC.:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $cursos);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'GESTION:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", ' '.$gestion);
      	$contador1++;
      	$this->excel->getActiveSheet()->getStyle("B{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("B{$contador1}", 'NIVEL:');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":G".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("C{$contador1}", $niveles.' '.$turno);
      	$this->excel->setActiveSheetIndex(0)->mergeCells("H".($contador1).":J".($contador1));
      	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($negra);
      	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'U.E. ');
      	$this->excel->setActiveSheetIndex(0)->mergeCells("K".($contador1).":P".($contador1));
      	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $colegio);
      	$contador1++;
		$contador1++;
		$this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        $this->excel->setActiveSheetIndex(0)->mergeCells("C".($contador1).":K".($contador1));
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CO.SO.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":M".($contador1));
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'C.T.P.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("N".($contador1).":P".($contador1));
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'V.T.T.');
        $this->excel->setActiveSheetIndex(0)->mergeCells("Q".($contador1).":R".($contador1));
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'C.P.');
        $contador1++;
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilo);
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'CL');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'LEX');
        $this->excel->setActiveSheetIndex(0)->mergeCells("E".($contador1).":H".($contador1));
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'CS');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'EFD');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'ED.M');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'APLV');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MAT');
        //$this->excel->setActiveSheetIndex(0)->mergeCells("L".($contador1).":O".($contador1));
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'TTE');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'CN');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FIS');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUI');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'CFS');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'VER');
        $contador1++;

        //Le aplicamos negrita a los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("A{$contador1}:S{$contador1}")->applyFromArray($estilo);
        //Definimos los títulos de la cabecera.
        $this->excel->getActiveSheet()->getStyle("C{$contador1}:S{$contador1}")->getAlignment()->setTextRotation(90);
        $this->excel->setActiveSheetIndex(0)->mergeCells("A".($contador1-2).":A".($contador1));
        $this->excel->getActiveSheet()->setCellValue("A".($contador1-2), 'NUM');
        $this->excel->setActiveSheetIndex(0)->mergeCells("B".($contador1-2).":B".($contador1));
        $this->excel->getActiveSheet()->setCellValue("B".($contador1-2), 'NOMBRES');
        $this->excel->getActiveSheet()->setCellValue("C{$contador1}", 'LENGUAJE');
        $this->excel->getActiveSheet()->setCellValue("D{$contador1}", 'INGLES');
        $this->excel->getActiveSheet()->setCellValue("E{$contador1}", 'HISTORIA');
        $this->excel->getActiveSheet()->setCellValue("F{$contador1}", 'CIVICA');
        $this->excel->getActiveSheet()->setCellValue("G{$contador1}", 'GEOGRAFIA');
        $this->excel->getActiveSheet()->setCellValue("H{$contador1}", 'PROMEDIO');
        $this->excel->getActiveSheet()->setCellValue("I{$contador1}", 'ED. FISICA');
        $this->excel->getActiveSheet()->setCellValue("J{$contador1}", 'EDUCACION MUSICA');
        $this->excel->getActiveSheet()->setCellValue("K{$contador1}", 'ARTES PLASTICAS');
        $this->excel->getActiveSheet()->setCellValue("L{$contador1}", 'MATEMATICA');
        $this->excel->getActiveSheet()->setCellValue("M{$contador1}", 'INFORMATICA');
        $this->excel->getActiveSheet()->setCellValue("N{$contador1}", 'BIOLOGIA');
        $this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'FISICA');
        $this->excel->getActiveSheet()->setCellValue("P{$contador1}", 'QUIMICA');
        //$this->excel->getActiveSheet()->setCellValue("O{$contador1}", 'TEC.TECNOLOGICA GENERAL ');
        
        $this->excel->getActiveSheet()->setCellValue("Q{$contador1}", 'FILOSOFIA');
        $this->excel->getActiveSheet()->setCellValue("R{$contador1}", 'RELIGION'); 
        $this->excel->getActiveSheet()->getStyle("S".($contador1-2))->getAlignment()->setTextRotation(90);
         $this->excel->setActiveSheetIndex(0)->mergeCells("S".($contador1-2).":S".($contador1));
        $this->excel->getActiveSheet()->setCellValue("S".($contador1-2), 'FINAL');
  
        $x = 1;
		 foreach ($list as $estud) {
		 	$mate=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,1,$gestion);
		 	$mate2=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,2,$gestion);
		 	$mate3=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,3,$gestion);
		 	$mate4=$this->estud->get_mate2($estud->id_est,1,4,6,7,8,9,10,11,12,18,19,21,22,23,24,25,4,$gestion);
		 	if($bi==1){
		 		$lenguaje=$mate[0]->lenguaje;
				$ingles=$mate[1]->ingles;
				$historia=$mate[3]->historia;
				$civica=$mate[4]->civica;
				$geografia=$mate[5]->geografia;
				$edfisica=$mate[6]->edfisica;
				$edmusica=$mate[7]->edmusica;
				$artes=$mate[8]->artes;
				$mate1=$mate[9]->mate;
				$sistemas=$mate[10]->sistemas;
				$electronica=$mate[11]->electronica;
				$naturales=$mate[12]->naturales;
				$fisica=$mate[13]->fisica;
				$quimica=$mate[14]->quimica;
				$filosofia=$mate[15]->filosofia;
				$religuion=$mate[16]->religuion;
		 	}
		 	if($bi==2){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion)/$bi);
		 	}
		 	if($bi==3){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion)/$bi);
		 	}
		 	if($bi==4){
		 		$lenguaje=round(($mate[0]->lenguaje+$mate2[0]->lenguaje+$mate3[0]->lenguaje+$mate4[0]->lenguaje)/$bi);
				$ingles=round(($mate[1]->ingles+$mate2[1]->ingles+$mate3[1]->ingles+$mate4[1]->ingles)/$bi);
				$historia=round(($mate[3]->historia+$mate2[3]->historia+$mate3[3]->historia+$mate4[3]->historia)/$bi);
				$civica=round(($mate[4]->civica+$mate2[4]->civica+$mate3[4]->civica+$mate4[4]->civica)/$bi);
				$geografia=round(($mate[5]->geografia+$mate2[5]->geografia+$mate3[5]->geografia+$mate4[5]->geografia)/$bi);
				$edfisica=round(($mate[6]->edfisica+$mate2[6]->edfisica+$mate3[6]->edfisica+$mate4[6]->edfisica)/$bi);
				$edmusica=round(($mate[7]->edmusica+$mate2[7]->edmusica+$mate3[7]->edmusica+$mate4[7]->edmusica)/$bi);
				$artes=round(($mate[8]->artes+$mate2[8]->artes+$mate3[8]->artes+$mate4[8]->artes)/$bi);
				$mate1=round(($mate[9]->mate+$mate2[9]->mate+$mate3[9]->mate+$mate4[9]->mate)/$bi);
				$sistemas=round(($mate[10]->sistemas+$mate2[10]->sistemas+$mate3[10]->sistemas+$mate4[10]->sistemas)/$bi);
				$electronica=round(($mate[11]->electronica+$mate2[11]->electronica+$mate3[11]->electronica+$mate4[11]->electronica)/$bi);
				$naturales=round(($mate[12]->naturales+$mate2[12]->naturales+$mate3[12]->naturales+$mate4[12]->naturales)/$bi);
				$fisica=round(($mate[13]->fisica+$mate2[13]->fisica+$mate3[13]->fisica+$mate4[13]->fisica)/$bi);
				$quimica=round(($mate[14]->quimica+$mate2[14]->quimica+$mate3[14]->quimica+$mate4[14]->quimica)/$bi);
				$filosofia=round(($mate[15]->filosofia+$mate2[15]->filosofia+$mate3[15]->filosofia+$mate4[15]->filosofia)/$bi);
				$religuion=round(($mate[16]->religuion+$mate2[16]->religuion+$mate3[16]->religuion+$mate4[16]->religuion)/$bi);
		 	}
		 	if(	$lenguaje<=53 OR $ingles<=53 OR $historia<=53 OR $civica<=53 OR $geografia<=53 OR $edfisica<=53 OR $edmusica<=53 
		 		OR $artes<=53 OR $mate1<=53 OR($sistemas<=53 AND  $electronica==0) OR ($electronica<=53 AND $sistemas==53 ) OR
				$naturales<=53 OR $fisica<=53 OR $quimica<=53 OR $filosofia<=53 OR $religuion<=53)
		 	{
			 	$contador1++;
			 	$this->excel->getActiveSheet()->getStyle("A{$contador1}:R{$contador1}")->applyFromArray($estilobor);
			    $this->excel->getActiveSheet()->setCellValue("A{$contador1}", $x);
			    $this->excel->getActiveSheet()->setCellValue("B{$contador1}", ' '.$estud->nombres);
			    //foreach ($mate as $mates) {
			    if($lenguaje<=50){$estilo3=$rojo;}
			    if($lenguaje>=51 ){$estilo3=$naranja;}
			    if($lenguaje>=70 ){$estilo3=$amarillo;}
			    if($lenguaje>=90 ){$estilo3=$verde;}	
			   	$this->excel->getActiveSheet()->getStyle("C{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
			    $this->excel->getActiveSheet()->setCellValue("C{$contador1}", $lenguaje);
	        	
			    if($ingles<=50){$estilo3=$rojo;}
			    if($ingles>=51 ){$estilo3=$naranja;}
			    if($ingles>=70 ){$estilo3=$amarillo;}
			    if($ingles>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("D{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("D{$contador1}", $ingles);
	        	
			    if($historia<=50){$estilo3=$rojo;}
			    if($historia>=51 ){$estilo3=$naranja;}
			    if($historia>=70 ){$estilo3=$amarillo;}
			    if($historia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("E{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("E{$contador1}", $historia);

	        	if($civica<=50){$estilo3=$rojo;}
			    if($civica>=51 ){$estilo3=$naranja;}
			    if($civica>=70 ){$estilo3=$amarillo;}
			    if($civica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("F{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("F{$contador1}", $civica);

	        	if($geografia<=50){$estilo3=$rojo;}
			    if($geografia>=51 ){$estilo3=$naranja;}
			    if($geografia>=70 ){$estilo3=$amarillo;}
			    if($geografia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("G{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("G{$contador1}", $geografia);
	        	$soci=($geografia+$civica+$historia)/3;
	        	if($soci<=50){$estilo3=$rojo;}
			    if($soci>=51 ){$estilo3=$naranja;}
			    if($soci>=70 ){$estilo3=$amarillo;}
			    if($soci>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("H{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("H{$contador1}", $soci);
	        	
			    if($edfisica<=50){$estilo3=$rojo;}
			    if($edfisica>=51 ){$estilo3=$naranja;}
			    if($edfisica>=70 ){$estilo3=$amarillo;}
			    if($edfisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("I{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("I{$contador1}", $edfisica);
	        	
			    if($edmusica<=50){$estilo3=$rojo;}
			    if($edmusica>=51 ){$estilo3=$naranja;}
			    if($edmusica>=70 ){$estilo3=$amarillo;}
			    if($edmusica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("J{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("J{$contador1}", $edmusica);
	        	
			    if($artes<=50){$estilo3=$rojo;}
			    if($artes>=51 ){$estilo3=$naranja;}
			    if($artes>=70 ){$estilo3=$amarillo;}
			    if($artes>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("K{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("K{$contador1}", $artes);
	        	
			    if($mate1<=50){$estilo3=$rojo;}
			    if($mate1>=51 ){$estilo3=$naranja;}
			    if($mate1>=70 ){$estilo3=$amarillo;}
			    if($mate1>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("L{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("L{$contador1}", $mate1);
	        	if($sistemas==0)
	        	{
	        		$siste=$electronica;
	        	}
	        	if($electronica==0)
	        	{
	        		$siste=$sistemas;
	        	}
	        	if($siste<=50){$estilo3=$rojo;}
			    if($siste>=51 ){$estilo3=$naranja;}
			    if($siste>=70 ){$estilo3=$amarillo;}
			    if($siste>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("M{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("M{$contador1}", $siste);

	        	if($naturales<=50){$estilo3=$rojo;}
			    if($naturales>=51 ){$estilo3=$naranja;}
			    if($naturales>=70 ){$estilo3=$amarillo;}
			    if($naturales>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("N{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("N{$contador1}", $naturales);


			    if($fisica<=50){$estilo3=$rojo;}
			    if($fisica>=51 ){$estilo3=$naranja;}
			    if($fisica>=70 ){$estilo3=$amarillo;}
			    if($fisica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("O{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("O{$contador1}", $fisica);
	        	
			    if($quimica<=50){$estilo3=$rojo;}
			    if($quimica>=51 ){$estilo3=$naranja;}
			    if($quimica>=70 ){$estilo3=$amarillo;}
			    if($quimica>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("P{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("P{$contador1}", $quimica);

	        	if($filosofia<=50){$estilo3=$rojo;}
			    if($filosofia>=51 ){$estilo3=$naranja;}
			    if($filosofia>=70 ){$estilo3=$amarillo;}
			    if($filosofia>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("Q{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("Q{$contador1}", $filosofia);

	        	if($religuion<=50){$estilo3=$rojo;}
			    if($religuion>=51 ){$estilo3=$naranja;}
			    if($religuion>=70 ){$estilo3=$amarillo;}
			    if($religuion>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("R{$contador1}")->applyFromArray($estilo3);
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("R{$contador1}", $religuion);
	        	$final=round(($lenguaje+$ingles+$soci+$edfisica+$edmusica+$artes+$mate1+$siste+$fisica+$quimica+$filosofia+$religuion)/13);
	        	if( $final<=50){$estilo3=$rojo;}
			    if( $final>=51 ){$estilo3=$naranja;}
			    if( $final>=70 ){$estilo3=$amarillo;}
			    if( $final>=90 ){$estilo3=$verde;}
			   	$this->excel->getActiveSheet()->getStyle("S{$contador1}")->applyFromArray($estilo3); 
	    		
			   	$estilo3=$estilo;
	        	$this->excel->getActiveSheet()->setCellValue("S{$contador1}", $final);
	        	$x++;
        	}
		 }
        //Le ponemos un nombre al archivo que se va a generar.
        $archivo = "{$codigo}__{$gestion}_{$bi}.xls";
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="'.$archivo.'"');
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');
        //Hacemos una salida al navegador con el archivo Excel.
        $objWriter->save('php://output');

    }
	}
	public function printcentr($id) //impresion centralizador
	{

			$notlimit=substr($id,0,strpos($id,"."));
			$bi2=substr($id,strpos($id,".")+1,1);
			$idcur=substr($id,strpos($id,".")+3,strpos($id,"_")-6);
			$gestion=substr($id,strpos($id,"_")+1,strlen($id));

			// print_r($notlimit."-".$bi2."-".$idcur."-".$gestion);
			// 	exit();		
			$curso=$this->estud->get_print_curso_pdf($idcur);
			
			//$idcur=$id;		
			//$gestion=$curso->gestion;//
			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			if($bi2==1) $bimes="PRIMER BIMESTRE";
			if($bi2==2) $bimes="SEGUNDO BIMESTRE";
			if($bi2==3) $bimes="TERCER BIMESTRE";
			if($bi2==4) $bimes="CUARTO BIMESTRE";

			$this->load->library('pdf');
			$idsql="primaria";
		
		if(($nivel=='PRIMARIA MAÑANA')OR($nivel=='PRIMARIA TARDE'))
		{
			$i=0;
		
			$list2=$this->estud->ejec_sql($notlimit,$idcur,$bi2,$gestion,$idsql,$curso1);
			
			$num=0;
			ob_start();
			$this->pdf=new Pdf('Letter');
			$this->pdf->AddPage();
			$this->pdf->SetAutoPageBreak(false);//rompe el documento en nueva pagina
			$this->pdf->AliasNbPages();
			$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
			$this->pdf->SetFont('Arial','BU',15);
			$this->pdf->Cell(30);
            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
            $this->pdf->Ln('15');            
            $this->pdf->Cell(30);            
			$this->pdf->setXY(15,45);
			$this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
            $this->pdf->setXY(35,45);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
            $this->pdf->setX(55);  
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
            $this->pdf->setX(75);  
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
            $this->pdf->SetX(97);
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
            $this->pdf->SetX(115);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
            $this->pdf->SetX(145);
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(55,5,utf8_decode($bimes),0,0,'C');
            $this->pdf->Ln('6'); 

            $this->pdf->setX(15);
            $this->pdf->SetFont('Arial','B',10);
    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
    		$this->pdf->setX(40);
    		$this->pdf->SetFont('Arial','',10);
    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
            $this->pdf->setX(55); 
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
            $this->pdf->setX(68); 
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(60,5,utf8_decode('PRIMARIA COMUN. VOC.'),0,0,'L');	
            $this->pdf->SetX(115);
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
            $this->pdf->SetX(138);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
            
            //encabezado de tabla
            $this->pdf->Line(10,60,205,60);		            
            $this->pdf->Ln('12');
            $this->pdf->SetLeftMargin(10);
    		$this->pdf->SetRightMargin(10);
    		$this->pdf->SetFillColor(189,215,238); //azul
    		$this->pdf->SetFont('Arial', 'B', 8);
    		$this->pdf->Ln(5);
    		
    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
    		$this->pdf->Cell(84,7,'CENTRALIZADOR','TBLR',0,'C','1');
    		$this->pdf->Ln(7);
    		$this->pdf->SetX(77);
    		
    		$this->pdf->Cell(7,8,'COL','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'IN','TBLR',0,'C','1');
    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'M','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'TT','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'VER','TBLR',0,'C','1');    		
    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
    		$this->pdf->Ln(8);

    		$this->pdf->SetX(77);    		
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->SetX(98);
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

    		$this->pdf->TextWithDirection(15,116,'NUMERO','U');
    		$this->pdf->TextWithDirection(82,116,'LENGUAJE','U');
    		$this->pdf->TextWithDirection(89,116,'INGLES','U');
    		$this->pdf->TextWithDirection(96,116,'PROMEDIO COM-LEN','U');
    		$this->pdf->TextWithDirection(103,116,'CIENCIAS SOCIALES','U');
    		$this->pdf->TextWithDirection(110,116,'EDU.FISICA DEPORT','U');
    		$this->pdf->TextWithDirection(117,116,'EDU. MUSICAL','U');
    		$this->pdf->TextWithDirection(124,116,'ART. PLAST. VISUALES','U');
    		$this->pdf->TextWithDirection(131,116,'MATEMATICAS','U');
    		$this->pdf->TextWithDirection(138,116,'TECN. TECNOLOGICA','U');
    		$this->pdf->TextWithDirection(145,116,'CIENCIAS NATURALES','U');
    		$this->pdf->TextWithDirection(152,116,'VAL./ ESPIRITUALIDAD','U');
    		$this->pdf->SetFont('Arial', 'B', 8);
    		$this->pdf->TextWithDirection(159,116,'PROMEDIO BIMESTRAL','U');
    		$this->pdf->Ln(34);
    		
			$row = array();
				
			foreach ($list2 as $centr) {
				$i++;
				$notafinal=round(((round((($centr->LENGUAJE+$centr->INGLES)/2),0)+$centr->SOCIALES+$centr->EDUFISICA+ $centr->MUSICA+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+$centr->RELIGION)/9),0);//nota final centralizador
				$nf_honor=round(((round((($centr->LENGUAJE+$centr->INGLES)/2),0)+$centr->SOCIALES+$centr->EDUFISICA+ $centr->MUSICA+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+$centr->RELIGION)/9),2);//nota final para cuadro de honor
				$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres))							
						);
				if($i==23)
				{
					 //encabezado de tabla
					$this->pdf->AddPage();
					$this->pdf->SetAutoPageBreak(false);
		    		$this->pdf->SetFillColor(189,215,238); //azul
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->Ln(5);
		    		
		    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
		    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
		    		$this->pdf->Cell(84,7,'CENTRALIZADOR','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(77);
		    		
		    		$this->pdf->Cell(7,8,'COL','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'IN','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'M','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'TT','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,8,'VER','TBLR',0,'C','1');    		
		    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
		    		$this->pdf->Ln(8);

		    		$this->pdf->SetX(77);    		
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->SetX(98);
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

		    		$this->pdf->TextWithDirection(15,86,'NUMERO','U');
		    		$this->pdf->TextWithDirection(82,86,'LENGUAJE','U');
		    		$this->pdf->TextWithDirection(89,86,'INGLES','U');
		    		$this->pdf->TextWithDirection(96,86,'PROMEDIO COL','U');
		    		$this->pdf->TextWithDirection(103,86,'CIENCIAS SOCIALES','U');
		    		$this->pdf->TextWithDirection(110,86,'EDU.FISICA DEPORT','U');
		    		$this->pdf->TextWithDirection(117,86,'EDU. MUSICAL','U');
		    		$this->pdf->TextWithDirection(124,86,'ART. PLAST. VISUALES','U');
		    		$this->pdf->TextWithDirection(131,86,'MATEMATICAS','U');
		    		$this->pdf->TextWithDirection(138,86,'TECN. TECNOLOGICA','U');
		    		$this->pdf->TextWithDirection(145,86,'CIENCIAS NATURALES','U');
		    		$this->pdf->TextWithDirection(152,86,'VAL./ ESPIRITUALIDAD','U');
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->TextWithDirection(159,86,'PROMEDIO BIMESTRAL','U');
		    		$this->pdf->Ln(34);
				}
	
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255);  //blanco
				$num=$num+1;
				$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
				$this->pdf->Cell(60,8,strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres)),'TBLR',0,'L','1');
				$this->pdf->SetFillColor(255,255,205); //amalelo 
				if ($centr->LENGUAJE<51){$this->pdf->SetFillColor(250,104,102);} elseif (($centr->LENGUAJE<61)and($centr->LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->LENGUAJE<76)and($centr->LENGUAJE>60)){$this->pdf->SetFillColor(198,255,175);}
		        $this->pdf->Cell(7,8,$centr->LENGUAJE,'TBLR',0,'C','1');
		        $this->pdf->SetFillColor(255,255,205); //amalelo 
		        if ($centr->INGLES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->INGLES<61)and($centr->INGLES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->INGLES<76)and($centr->INGLES>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->INGLES,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(189,215,238); //azul
    			$this->pdf->Cell(7,8,round((($centr->LENGUAJE+$centr->INGLES)/2),0),'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->SOCIALES<61)and($centr->SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->SOCIALES<76)and($centr->SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->SOCIALES,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->EDUFISICA<61)and($centr->EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->EDUFISICA<76)and($centr->EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
    			
    			$this->pdf->Cell(7,8,$centr->EDUFISICA,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->MUSICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MUSICA<61)and($centr->MUSICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MUSICA<76)and($centr->MUSICA>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->MUSICA,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->ARTPLAST<61)and($centr->ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->ARTPLAST<76)and($centr->ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
    			
    			$this->pdf->Cell(7,8,$centr->ARTPLAST,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MATEMATICAS<61)and($centr->MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MATEMATICAS<76)and($centr->MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->MATEMATICAS,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->INFORMATICA<61)and($centr->INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->INFORMATICA<76)and($centr->INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->INFORMATICA,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->CIENCIAS<61)and($centr->CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->CIENCIAS<76)and($centr->CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->CIENCIAS,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(255,255,205); //amalelo 
    			if ($centr->RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->RELIGION<61)and($centr->RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->RELIGION<76)and($centr->RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}
    			$this->pdf->Cell(7,8,$centr->RELIGION,'TBLR',0,'C','1');
    			$this->pdf->SetFillColor(189,215,238); //azul
    			$this->pdf->SetFont('Arial', 'B', 8);
    			$this->pdf->Cell(7,8,$notafinal,'TBLR',0,'C','1');


			    $this->pdf->Ln(7);

			}
			$j=0;
			$this->pdf->AddPage();
			$this->pdf->SetAutoPageBreak(false);			
			$this->pdf->SetFont('Arial','BU',12);			
            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Ln(7);
            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,utf8_decode($bimes),0,0,'C');
			$this->pdf->Ln(14);
			$this->pdf->SetFont('Arial', 'B', 8);
			$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
			$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
			$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
			$this->pdf->SetFont('Arial', '', 8);
			$this->pdf->SetFillColor(255,255,255); 
			$this->pdf->Ln(7);	
			
			arsort($row);
			foreach ($row as $honor)
			{
				$j++;
				if($j<=3)
				{
					$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
					$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
					$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
					$this->pdf->Ln(7);		
				}
				
			}
	
			$this->pdf->Ln(40);
			$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
			ob_end_flush();
			
		}
		
		if(($nivel=='SECUNDARIA MAÑANA')OR($nivel=='SECUNDARIA TARDE'))
		{
			$idsql="secundaria";

			$curso=$this->estud->get_print_curso_pdf($idcur);
					
			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			
			if(($curso1=='PRIMERO A')OR($curso1=='PRIMERO B')OR($curso1=='SEGUNDO A')OR($curso1=='SEGUNDO B'))
			{		
				$i=0;
				$this->load->library('pdf');							
				$list3=$this->estud->ejec_sql($notlimit,$idcur,$bi2,$gestion,$idsql,$curso1);

				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);//rompe el documento en nueva pagina
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->SetX(145);
            	$this->pdf->SetFont('Arial','B',10);
            	$this->pdf->Cell(55,5,utf8_decode($bimes),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(21,8,'TTG','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(93);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(163);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'QUECHUA','U');	    		
	    		$this->pdf->TextWithDirection(91,116,'PROMEDIO COL','U');
	    		$this->pdf->TextWithDirection(98,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(105,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(154,116,'QUIMICA','U');
	    		$this->pdf->TextWithDirection(161,116,'TEC. TECNOL. GENERAL','U');
	    		$this->pdf->TextWithDirection(168,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(175,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(182,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(189,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);
				
	    		$row = array();
				foreach ($list3 as $centr) {
					
					$notafinal=round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2)+$centr->ARTPLAST+$centr->MATEMATICAS+round((($centr->INFORMATICA+$centr->FISICA+$centr->QUIMICA)/3),0)+$centr->CIENCIAS+$centr->COSMO+$centr->RELIGION)/11,0);

					$nf_honor=round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2)+$centr->ARTPLAST+$centr->MATEMATICAS+round((($centr->INFORMATICA+$centr->FISICA+$centr->QUIMICA)/3),0)+$centr->CIENCIAS+$centr->COSMO+$centr->RELIGION)/11,2);
					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres))							
						);
					$MUSICA=($centr->MUSICA1+$centr->MUSICA2);
					$i++;

					if($i==23)
					{
						
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(21,8,'TTG','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(93);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(163);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'QUECHUA','U');	    		
			    		$this->pdf->TextWithDirection(91,86,'PROMEDIO COL','U');
			    		$this->pdf->TextWithDirection(98,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(105,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(147,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(154,86,'QUIMICA','U');
			    		$this->pdf->TextWithDirection(161,86,'TEC. TECNOL. GENERAL','U');
			    		$this->pdf->TextWithDirection(168,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(175,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(182,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(189,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);																				
					}
					
					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);  //blanco
					$num=$num+1;
					$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
					$this->pdf->Cell(60,8,strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres)),'TBLR',0,'L','1');
					$this->pdf->SetFillColor(255,255,205); //amalelo 
					if ($centr->LENGUAJE<51) {$this->pdf->SetFillColor(250,255,255);} elseif (($centr->LENGUAJE<61)and($centr->LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->LENGUAJE<76)and($centr->LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
			        $this->pdf->Cell(7,8,$centr->LENGUAJE,'TBLR',0,'C','1');
			        $this->pdf->SetFillColor(255,255,205); //amalelo 
			        if ($centr->QUECHUA<51) {$this->pdf->SetFillColor(250,255,255);} elseif (($centr->QUECHUA<61)and($centr->QUECHUA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUECHUA<76)and($centr->QUECHUA>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->QUECHUA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->LENGUAJE+$centr->QUECHUA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			 if (($centr->INGLES1+$centr->INGLES2)<51) {$this->pdf->SetFillColor(255,255,255);} elseif ((($centr->INGLES1+$centr->INGLES2)<61)and(($centr->INGLES1+$centr->INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->INGLES1+$centr->INGLES2)<76)and(($centr->INGLES1+$centr->INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}elseif(($centr->INGLES1+$centr->INGLES2)==0){$this->pdf->SetFillColor(255,255,255);}	
	    			$this->pdf->Cell(7,8,($centr->INGLES1+$centr->INGLES2),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->SOCIALES<61)and($centr->SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->SOCIALES<76)and($centr->SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->SOCIALES,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->EDUFISICA<61)and($centr->EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->EDUFISICA<76)and($centr->EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->EDUFISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($MUSICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MUSICA<61)and($MUSICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MUSICA<76)and($MUSICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$MUSICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->ARTPLAST<61)and($centr->ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->ARTPLAST<76)and($centr->ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->ARTPLAST,'TBLR',0,'C','1');	
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MATEMATICAS<61)and($centr->MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MATEMATICAS<76)and($centr->MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}    			
	    			$this->pdf->Cell(7,8,$centr->MATEMATICAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->INFORMATICA<61)and($centr->INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->INFORMATICA<76)and($centr->INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->INFORMATICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->FISICA<61)and($centr->FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->FISICA<76)and($centr->FISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->FISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->QUIMICA<61)and($centr->QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUIMICA<76)and($centr->QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->QUIMICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->INFORMATICA+$centr->FISICA+$centr->QUIMICA)/3),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->CIENCIAS<61)and($centr->CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->CIENCIAS<76)and($centr->CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->CIENCIAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->COSMO<61)and($centr->COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->COSMO<76)and($centr->COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->COSMO,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 	
	    			if ($centr->RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->RELIGION<61)and($centr->RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->RELIGION<76)and($centr->RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}    			
	    			$this->pdf->Cell(7,8,$centr->RELIGION,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(189,215,238); //azul
	    			$this->pdf->SetFont('Arial', 'B', 8);
	    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
					

				    $this->pdf->Ln(7);

				}

				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($bimes),0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}

				$this->pdf->Ln(40);
				$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}

			if(($curso1=='TERCERO A')OR($curso1=='TERCERO B'))
			{		
				$i=0;		
				$this->load->library('pdf');
							
				$list4=$this->estud->ejec_sql($notlimit,$idcur,$bi2,$gestion,$idsql,$curso1);
			
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->SetX(145);
            	$this->pdf->SetFont('Arial','B',10);
            	$this->pdf->Cell(55,5,utf8_decode($bimes),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(93);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(156);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'QUECHUA','U');	    		
	    		$this->pdf->TextWithDirection(91,116,'PROMEDIO COL','U');
	    		$this->pdf->TextWithDirection(98,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(105,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(154,116,'PROM FIS-QUI','U');
	    		$this->pdf->TextWithDirection(161,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(168,116,'QUIMICA','U');	    	
	    		$this->pdf->TextWithDirection(175,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(182,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(189,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);
				
				$row = array();	
				foreach ($list4 as $centr) {
					$notafinal=round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,0);
					$nf_honor=round((round((($centr->LENGUAJE+$centr->QUECHUA)/2),0)+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,2);
					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres))							
						);
					$i++;
					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(93);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(156);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'QUECHUA','U');	    		
			    		$this->pdf->TextWithDirection(91,86,'PROMEDIO COL','U');
			    		$this->pdf->TextWithDirection(98,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(105,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(147,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(154,86,'PROM FIS-QUI','U');
			    		$this->pdf->TextWithDirection(161,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(168,86,'QUIMICA','U');	    	
			    		$this->pdf->TextWithDirection(175,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(182,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(189,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);
					}
					
					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);  //blanco
					$num=$num+1;
					$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
					$this->pdf->Cell(60,8,strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres)),'TBLR',0,'L','1');
					$this->pdf->SetFillColor(255,255,205); //amalelo 
					if ($centr->LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->LENGUAJE<61)and($centr->LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->LENGUAJE<76)and($centr->LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
			        $this->pdf->Cell(7,8,$centr->LENGUAJE,'TBLR',0,'C','1');
			        $this->pdf->SetFillColor(255,255,205); //amalelo 
			        if ($centr->QUECHUA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->QUECHUA<61)and($centr->QUECHUA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUECHUA<76)and($centr->QUECHUA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->QUECHUA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->LENGUAJE+$centr->QUECHUA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			 if (($centr->INGLES1+$centr->INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->INGLES1+$centr->INGLES2)<61)and(($centr->INGLES1+$centr->INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->INGLES1+$centr->INGLES2)<76)and(($centr->INGLES1+$centr->INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,($centr->INGLES1+$centr->INGLES2),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 	    			
	    			if ($centr->SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->SOCIALES<61)and($centr->SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->SOCIALES<76)and($centr->SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->SOCIALES,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			$this->pdf->Cell(7,8,$centr->EDUFISICA,'TBLR',0,'C','1');
	    			if ($centr->EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->EDUFISICA<61)and($centr->EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->EDUFISICA<76)and($centr->EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if (($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<61)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<76)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->ARTPLAST<61)and($centr->ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->ARTPLAST<76)and($centr->ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->ARTPLAST,'TBLR',0,'C','1');	
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MATEMATICAS<61)and($centr->MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MATEMATICAS<76)and($centr->MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}	    			
	    			$this->pdf->Cell(7,8,$centr->MATEMATICAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->INFORMATICA<61)and($centr->INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->INFORMATICA<76)and($centr->INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->INFORMATICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->CIENCIAS<61)and($centr->CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->CIENCIAS<76)and($centr->CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->CIENCIAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->FISICA+$centr->QUIMICA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->FISICA<61)and($centr->FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->FISICA<76)and($centr->FISICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->FISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->QUIMICA<61)and($centr->QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUIMICA<76)and($centr->QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->QUIMICA,'TBLR',0,'C','1');
	    			
	    			
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->COSMO<61)and($centr->COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->COSMO<76)and($centr->COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}	
	    			$this->pdf->Cell(7,8,$centr->COSMO,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 	    			
	    			$this->pdf->Cell(7,8,$centr->RELIGION,'TBLR',0,'C','1');
	    			if ($centr->RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->RELIGION<61)and($centr->RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->RELIGION<76)and($centr->RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->SetFillColor(189,215,238); //azul
	    			$this->pdf->SetFont('Arial', 'B', 8);
	    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
					

				    $this->pdf->Ln(7);

				}

				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($bimes),0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}


				$this->pdf->Ln(40);
				$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}
			if(($curso1=='CUARTO A')OR($curso1=='CUARTO B'))
			{		
				$i=0;

				$this->load->library('pdf');
							
				$list5=$this->estud->ejec_sql($notlimit,$idcur,$bi2,$gestion,$idsql,$curso1);
			
				$this->load->library('pdf');
							
							
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->SetX(145);
            	$this->pdf->SetFont('Arial','B',10);
            	$this->pdf->Cell(55,5,utf8_decode($bimes),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(112,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(142);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    			    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(91,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(98,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(105,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(112,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(119,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(126,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(133,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(140,116,'PROMEDIO FIS-QUI','U');
	    		$this->pdf->TextWithDirection(147,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(154,116,'QUIMICA','U');	    		
	    		$this->pdf->TextWithDirection(161,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(168,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(175,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);		

				$row = array();						
				foreach ($list5 as $centr) {
				
					$notafinal=round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,0);
					$nf_honor=round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+$centr->SOCIALES+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+$centr->INFORMATICA+$centr->CIENCIAS+round((($centr->FISICA+$centr->QUIMICA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,2);
					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres))							
						);
					$i++;
					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(112,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(142);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(91,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(98,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(105,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(112,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(119,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(126,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(133,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(140,86,'PROMEDIO FIS-QUI','U');
			    		$this->pdf->TextWithDirection(147,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(154,86,'QUIMICA','U');	    		
			    		$this->pdf->TextWithDirection(161,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(168,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(175,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);		
					}

					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);  //blanco
					$num=$num+1;
					$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
					$this->pdf->Cell(60,8,strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres)),'TBLR',0,'L','1');
					$this->pdf->SetFillColor(255,255,205); //amalelo 
					if ($centr->LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->LENGUAJE<61)and($centr->LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->LENGUAJE<76)and($centr->LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
			        $this->pdf->Cell(7,8,$centr->LENGUAJE,'TBLR',0,'C','1');	
			        $this->pdf->SetFillColor(255,255,205); //amalelo 
			        if (($centr->INGLES1+$centr->INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->INGLES1+$centr->INGLES2)<61)and(($centr->INGLES1+$centr->INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->INGLES1+$centr->INGLES2)<76)and(($centr->INGLES1+$centr->INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}    			
	    			$this->pdf->Cell(7,8,($centr->INGLES1+$centr->INGLES2),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->SOCIALES<61)and($centr->SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->SOCIALES<76)and($centr->SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->SOCIALES,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->EDUFISICA<61)and($centr->EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->EDUFISICA<76)and($centr->EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->EDUFISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if (($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<61)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<76)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->ARTPLAST<61)and($centr->ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->ARTPLAST<76)and($centr->ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->ARTPLAST,'TBLR',0,'C','1');	
	    			$this->pdf->SetFillColor(255,255,205); //amalelo   
	    			if ($centr->MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MATEMATICAS<61)and($centr->MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MATEMATICAS<76)and($centr->MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}  			
	    			$this->pdf->Cell(7,8,$centr->MATEMATICAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo   
	    			if ($centr->INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->INFORMATICA<61)and($centr->INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->INFORMATICA<76)and($centr->INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);} 	    			 
	    			$this->pdf->Cell(7,8,$centr->INFORMATICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->CIENCIAS<61)and($centr->CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->CIENCIAS<76)and($centr->CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->CIENCIAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->FISICA+$centr->QUIMICA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->FISICA<61)and($centr->FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->FISICA<76)and($centr->FISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->FISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->QUIMICA<61)and($centr->QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUIMICA<76)and($centr->QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->QUIMICA,'TBLR',0,'C','1');	    				    			
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->COSMO<61)and($centr->COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->COSMO<76)and($centr->COSMO>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->COSMO,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->RELIGION<61)and($centr->RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->RELIGION<76)and($centr->RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);} 	    			
	    			$this->pdf->Cell(7,8,$centr->RELIGION,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(189,215,238); //azul
	    			$this->pdf->SetFont('Arial', 'B', 8);
	    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
					
				    $this->pdf->Ln(7);

				}

				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($bimes),0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}
				
				$this->pdf->Ln(40);
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}
			if(($curso1=='QUINTO A')OR($curso1=='QUINTO B')OR($curso1=='SEXTO A')OR($curso1=='SEXTO B'))
			{		
				$i=0;
				$this->load->library('pdf');
							
				$list6=$this->estud->ejec_sql($notlimit,$idcur,$bi2,$gestion,$idsql,$curso1);
			
											
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->SetX(145);
            	$this->pdf->SetFont('Arial','B',10);
            	$this->pdf->Cell(55,5,utf8_decode($bimes),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(136,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'HIS-CIV','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(14,8,'BIO-GEO','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FIS-QUI','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(10,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(107);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->SetX(170);    		   			    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->SetX(184);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(91,116,'HISTORIA','U');
	    		$this->pdf->TextWithDirection(98,116,'CIVICA','U');
	    		$this->pdf->TextWithDirection(105,116,'PROMD CIENCIAS SOC','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'BIOLOGIA','U');
	    		$this->pdf->TextWithDirection(154,116,'GEOGRAFIA','U');
	    		$this->pdf->TextWithDirection(161,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(168,116,'PROMD FIS-QUI','U');
	    		$this->pdf->TextWithDirection(175,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(182,116,'QUIMICA','U');	    		
	    		$this->pdf->TextWithDirection(189,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(196,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(203,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);	

				$row = array();	
				foreach ($list6 as $centr) {
					$notafinal=round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+(($centr->HISTORIA+$centr->CIVICA)/2)+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+($centr->INFORMATICA1+$centr->INFORMATICA2)+(($centr->FISICA+$centr->QUIMICA)/2)+(($centr->BIOLOGIA+$centr->GEOGRAFIA)/2)+$centr->COSMO+$centr->RELIGION)/12,0);
					
					$nf_honor=round(($centr->LENGUAJE+($centr->INGLES1+$centr->INGLES2)+round((($centr->HISTORIA+$centr->CIVICA)/2),0)+$centr->EDUFISICA+($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)+$centr->ARTPLAST+$centr->MATEMATICAS+($centr->INFORMATICA1+$centr->INFORMATICA2)+round((($centr->FISICA+$centr->QUIMICA)/2),0)+round((($centr->BIOLOGIA+$centr->GEOGRAFIA)/2),0)+$centr->COSMO+$centr->RELIGION)/12,2);

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres))							
						);

					$i++;
					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(136,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'HIS-CIV','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(14,8,'BIO-GEO','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FIS-QUI','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(10,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(107);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->SetX(170);    		   			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->SetX(184);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(91,86,'HISTORIA','U');
			    		$this->pdf->TextWithDirection(98,86,'CIVICA','U');
			    		$this->pdf->TextWithDirection(105,86,'PROMD CIENCIAS SOC','U');
			    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(147,86,'BIOLOGIA','U');
			    		$this->pdf->TextWithDirection(154,86,'GEOGRAFIA','U');
			    		$this->pdf->TextWithDirection(161,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(168,86,'PROMD FIS-QUI','U');
			    		$this->pdf->TextWithDirection(175,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(182,86,'QUIMICA','U');	    		
			    		$this->pdf->TextWithDirection(189,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(196,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(203,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);	
					}
													
				    $this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);  //blanco
					$num=$num+1;
					$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
					$this->pdf->Cell(60,8,strtoupper(utf8_decode($centr->appat." ".$centr->apmat." ".$centr->nombres)),'TBLR',0,'L','1');
					$this->pdf->SetFillColor(255,255,205); //amalelo 
					if ($centr->LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->LENGUAJE<61)and($centr->LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->LENGUAJE<76)and($centr->LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);} 	
			        $this->pdf->Cell(7,8,$centr->LENGUAJE,'TBLR',0,'C','1');	    			
			        $this->pdf->SetFillColor(255,255,205); //amalelo 
			        if (($centr->INGLES1+$centr->INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->INGLES1+$centr->INGLES2)<61)and(($centr->INGLES1+$centr->INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->INGLES1+$centr->INGLES2)<76)and(($centr->INGLES1+$centr->INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,($centr->INGLES1+$centr->INGLES2),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->HISTORIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->HISTORIA<61)and($centr->HISTORIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->HISTORIA<76)and($centr->HISTORIA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->HISTORIA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->CIVICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->CIVICA<61)and($centr->CIVICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->CIVICA<76)and($centr->CIVICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->CIVICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->HISTORIA+$centr->CIVICA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if ($centr->EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->EDUFISICA<61)and($centr->EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->EDUFISICA<76)and($centr->EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,$centr->EDUFISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if (($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<61)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)<76)and(($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);} 
	    			$this->pdf->Cell(7,8,($centr->MUSICA1+$centr->MUSICA2+$centr->MUSICA3),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if ($centr->ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->ARTPLAST<61)and($centr->ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->ARTPLAST<76)and($centr->ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->ARTPLAST,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if ($centr->MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->MATEMATICAS<61)and($centr->MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->MATEMATICAS<76)and($centr->MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}	    				    			
	    			$this->pdf->Cell(7,8,$centr->MATEMATICAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if (($centr->INFORMATICA1+$centr->INFORMATICA2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($centr->INFORMATICA1+$centr->INFORMATICA2)<61)and(($centr->INFORMATICA1+$centr->INFORMATICA2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($centr->INFORMATICA1+$centr->INFORMATICA2)<76)and(($centr->INFORMATICA1+$centr->INFORMATICA2)>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,($centr->INFORMATICA1+$centr->INFORMATICA2),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if ($centr->BIOLOGIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->BIOLOGIA<61)and($centr->BIOLOGIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->BIOLOGIA<76)and($centr->BIOLOGIA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->BIOLOGIA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo
	    			if ($centr->GEOGRAFIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->GEOGRAFIA<61)and($centr->GEOGRAFIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->GEOGRAFIA<76)and($centr->GEOGRAFIA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->GEOGRAFIA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->BIOLOGIA+$centr->GEOGRAFIA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(221,235,247); //azul
	    			$this->pdf->Cell(7,8,round((($centr->FISICA+$centr->QUIMICA)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->FISICA<61)and($centr->FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->FISICA<76)and($centr->FISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->FISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->QUIMICA<61)and($centr->QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->QUIMICA<76)and($centr->QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->QUIMICA,'TBLR',0,'C','1');
	    			
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->COSMO<61)and($centr->COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->COSMO<76)and($centr->COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$centr->COSMO,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($centr->RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($centr->RELIGION<61)and($centr->RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($centr->RELIGION<76)and($centr->RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}	    			
	    			$this->pdf->Cell(7,8,$centr->RELIGION,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(189,215,238); //azul
	    			$this->pdf->SetFont('Arial', 'B', 8);
	    			$this->pdf->Cell(10,8,$notafinal,'TBLR',0,'C','1');
					
				    $this->pdf->Ln(7);					

				}
				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($bimes),0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}
				$this->pdf->Ln(40);
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
			}
		}
	

	}

	//****************************** ACUMULADO ****************************************************************************** ACUMULADOS *************************

	public function printacumulado($id) //impresion centralizador
	{
			$idcur=substr($id,0,strpos($id,"."));
			$gestion=substr($id,strpos($id,".")+1,4);

			//print_r($idcur."-".$gestion);
			
			$curso=$this->estud->get_print_curso_pdf($idcur);

			$numbi=4;  //numero de bimestres

			$nivel=$curso->nivel;
			$curso1=$curso->curso;

			$row[] = array(
							"nota"=>0,
							"nomb"=>'vacio'							
						);

			$est[]=array(
						"comunidad"=>0,
						"ciencia"=>0,
						"vida"=>0,
						"cosmos"=>0
					);
			
			$this->load->library('pdf');
			$idsql="primaria";
			
		
		if(($nivel=='PRIMARIA MAÑANA')OR($nivel=='PRIMARIA TARDE'))
		{
			$i=0;
			
			$num=0;
			ob_start();
			$this->pdf=new Pdf('Letter');
			$this->pdf->AddPage();
			$this->pdf->SetAutoPageBreak(false);//rompe el documento en nueva pagina
			$this->pdf->AliasNbPages();
			$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
			$this->pdf->SetFont('Arial','BU',15);
			$this->pdf->Cell(30);
            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO -  DE 4 BIMESTRES'),0,0,'C');
            $this->pdf->Ln('15');            
            $this->pdf->Cell(30);            
			$this->pdf->setXY(15,45);
			$this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
            $this->pdf->setXY(35,45);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
            $this->pdf->setX(55);  
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
            $this->pdf->setX(75);  
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
            $this->pdf->SetX(97);
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
            $this->pdf->SetX(115);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');

            $this->pdf->Ln('6'); 

            $this->pdf->setX(15);
            $this->pdf->SetFont('Arial','B',10);
    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
    		$this->pdf->setX(40);
    		$this->pdf->SetFont('Arial','',10);
    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
            $this->pdf->setX(55); 
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
            $this->pdf->setX(68); 
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(60,5,utf8_decode('PRIMARIA COMUN. VOC.'),0,0,'L');	
            $this->pdf->SetX(115);
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
            $this->pdf->SetX(138);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
            
            //encabezado de tabla
            $this->pdf->Line(10,60,205,60);		            
            $this->pdf->Ln('12');
            $this->pdf->SetLeftMargin(10);
    		$this->pdf->SetRightMargin(10);
    		$this->pdf->SetFillColor(189,215,238); //azul
    		$this->pdf->SetFont('Arial', 'B', 8);
    		$this->pdf->Ln(5);
    		
    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
    		$this->pdf->Cell(84,7,'CENTRALIZADOR','TBLR',0,'C','1');
    		$this->pdf->Ln(7);
    		$this->pdf->SetX(77);
    		
    		$this->pdf->Cell(7,8,'COL','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'IN','TBLR',0,'C','1');
    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'M','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'TT','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
    		$this->pdf->Cell(7,8,'VER','TBLR',0,'C','1');    		
    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
    		$this->pdf->Ln(8);

    		$this->pdf->SetX(77);    		
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->SetX(98);
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

    		$this->pdf->TextWithDirection(15,116,'NUMERO','U');
    		$this->pdf->TextWithDirection(82,116,'LENGUAJE','U');
    		$this->pdf->TextWithDirection(89,116,'INGLES','U');
    		$this->pdf->TextWithDirection(96,116,'PROMEDIO COM-LEN','U');
    		$this->pdf->TextWithDirection(103,116,'CIENCIAS SOCIALES','U');
    		$this->pdf->TextWithDirection(110,116,'EDU.FISICA DEPORT','U');
    		$this->pdf->TextWithDirection(117,116,'EDU. MUSICAL','U');
    		$this->pdf->TextWithDirection(124,116,'ART. PLAST. VISUALES','U');
    		$this->pdf->TextWithDirection(131,116,'MATEMATICAS','U');
    		$this->pdf->TextWithDirection(138,116,'TECN. TECNOLOGICA','U');
    		$this->pdf->TextWithDirection(145,116,'CIENCIAS NATURALES','U');
    		$this->pdf->TextWithDirection(152,116,'VAL./ ESPIRITUALIDAD','U');
    		$this->pdf->SetFont('Arial', 'B', 8);
    		$this->pdf->TextWithDirection(159,116,'PROMEDIO 3 BIMESTRES','U');
    		$this->pdf->Ln(34);

			$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);

			
			foreach ($estudiante as $list) 
			{			
				$idest=$list->idest;
				
				$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);
				
					$i++;
					
					$LENGUAJE=round((($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/$numbi),0);
					$INGLES=round((($notabi->INGLES1+$notabi->INGLES2+$notabi->INGLES3+$notabi->INGLES4)/$numbi),0);
					$SOCIALES=round((($notabi->SOCIALES1+$notabi->SOCIALES2+$notabi->SOCIALES3+$notabi->SOCIALES4)/$numbi),0);
					$EDUFISICA=round((($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/$numbi),0);
					$MUSICA=round((($notabi->MUSICA1+$notabi->MUSICA2+$notabi->MUSICA3+$notabi->MUSICA4)/$numbi),0);
					$ARTPLAST=round((($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/$numbi),0);
					$MATEMATICAS=round((($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/$numbi),0);
					$INFORMATICA=round((($notabi->INFORMATICA1+$notabi->INFORMATICA2+$notabi->INFORMATICA3+$notabi->INFORMATICA4)/$numbi),0);
					$CIENCIAS=round((($notabi->CIENCIAS1+$notabi->CIENCIAS2+$notabi->CIENCIAS3+$notabi->CIENCIAS4)/$numbi),0);
					$RELIGION=round((($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/$numbi),0);

					$notafinal=round(((round((($LENGUAJE+$INGLES)/2),0)+$SOCIALES+$EDUFISICA+ $MUSICA+$ARTPLAST+$MATEMATICAS+$INFORMATICA+$CIENCIAS+$RELIGION)/9),0);//nota final centralizador

					$comunidad=round((round((($LENGUAJE+$INGLES)/2),0)+$SOCIALES+$EDUFISICA+ $MUSICA+$ARTPLAST)/5,0);
					$ciencia=round(($MATEMATICAS+$INFORMATICA)/2,0);
					$vida=$CIENCIAS;
					$cosmos=$RELIGION;


					$est[]=array(
						"comunidad"=>$comunidad,
						"ciencia"=>$ciencia,
						"vida"=>$vida,
						"cosmos"=>$cosmos
					);

					$nf_honor=round(((round((($LENGUAJE+$INGLES)/2),0)+$SOCIALES+$EDUFISICA+ $MUSICA+$ARTPLAST+$MATEMATICAS+$INFORMATICA+$CIENCIAS+$RELIGION)/9),2);//nota final centralizador

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres))							
						);


					if($i==23)
					{
						 //encabezado de tabla
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(84,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(77);
			    		
			    		$this->pdf->Cell(7,8,'COL','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'IN','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'M','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'TT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VER','TBLR',0,'C','1');    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(77);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(98);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(15,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(82,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(89,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(96,86,'PROMEDIO COL','U');
			    		$this->pdf->TextWithDirection(103,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(110,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(117,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(124,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(131,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(138,86,'TECN. TECNOLOGICA','U');
			    		$this->pdf->TextWithDirection(145,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(152,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(159,86,'PROMEDIO 3 BIMESTRES','U');
			    		$this->pdf->Ln(34);
					}
		
					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);  //blanco
					$num=$num+1;
					$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
					$this->pdf->Cell(60,8,strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres)),'TBLR',0,'L','1');
					$this->pdf->SetFillColor(255,255,205); //amalelo 
					if ($LENGUAJE<51){$this->pdf->SetFillColor(250,104,102);} elseif (($LENGUAJE<61)and($LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($LENGUAJE<76)and($LENGUAJE>60)){$this->pdf->SetFillColor(198,255,175);}
			        $this->pdf->Cell(7,8,$LENGUAJE,'TBLR',0,'C','1');
			        $this->pdf->SetFillColor(255,255,205); //amalelo 

			        if ($INGLES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($INGLES<61)and($INGLES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($INGLES<76)and($INGLES>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$INGLES,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(189,215,238); //azul

	    			$this->pdf->Cell(7,8,round((($LENGUAJE+$INGLES)/2),0),'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 

	    			if ($SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($SOCIALES<61)and($SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($SOCIALES<76)and($SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$SOCIALES,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($EDUFISICA<61)and($EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($EDUFISICA<76)and($EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			
	    			$this->pdf->Cell(7,8,$EDUFISICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($MUSICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MUSICA<61)and($MUSICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MUSICA<76)and($MUSICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$MUSICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 
	    			if ($ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($ARTPLAST<61)and($ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($ARTPLAST<76)and($ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}	    			
	    			$this->pdf->Cell(7,8,$ARTPLAST,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 

	    			if ($MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MATEMATICAS<61)and($MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MATEMATICAS<76)and($MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$MATEMATICAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 

	    			if ($INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($INFORMATICA<61)and($INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($INFORMATICA<76)and($INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$INFORMATICA,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 

	    			if ($CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($CIENCIAS<61)and($CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($CIENCIAS<76)and($CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$CIENCIAS,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(255,255,205); //amalelo 

	    			if ($RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($RELIGION<61)and($RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($RELIGION<76)and($RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}
	    			$this->pdf->Cell(7,8,$RELIGION,'TBLR',0,'C','1');
	    			$this->pdf->SetFillColor(189,215,238); //azul

	    			$this->pdf->SetFont('Arial', 'B', 8);
	    			$this->pdf->Cell(7,8,$notafinal,'TBLR',0,'C','1');


				    $this->pdf->Ln(7);
			}	

			$j=0;
			$this->pdf->AddPage();
			$this->pdf->SetAutoPageBreak(false);			
			$this->pdf->SetFont('Arial','BU',12);			
            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Ln(7);
            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,'4 bimestres',0,0,'C');
			$this->pdf->Ln(14);
			$this->pdf->SetFont('Arial', 'B', 8);
			$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
			$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
			$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
			$this->pdf->SetFont('Arial', '', 8);
			$this->pdf->SetFillColor(255,255,255); 
			$this->pdf->Ln(7);	
			
			arsort($row);
			foreach ($row as $honor)
			{
				$j++;
				if($j<=3)
				{
					$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
					$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
					$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
					$this->pdf->Ln(7);		
				}
				
			}

			$this->pdf->Ln(24);

				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('PROMEDIO POR CAMPOS DE SABERES'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);

	            $this->pdf->SetFillColor(189,215,238); //azul
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CAMPO DE SABERES Y CONOCIMIENTOS','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);
				$k=0;
				$sc1=0;$sc2=0;$sc3=0;$sc4=0;								
				foreach ($est as $campo)
				{
					$k++;
					$sc1=$sc1+$campo['comunidad'];
					$sc2=$sc2+$campo['ciencia'];
					$sc3=$sc3+$campo['vida'];
					$sc4=$sc4+$campo['cosmos'];				
					
				}

				$this->pdf->Cell(12,8,'1','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COMUNIDAD Y SOCIEDAD','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc1/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);	
				$this->pdf->Cell(12,8,'2','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CIENCIA TECNOLOGIA Y PRODUCCION','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc2/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'3','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'VIDA TIERRA TERRITORIO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc3/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'4','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COSMOS Y PENSAMIENTO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc4/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);

			$this->pdf->Ln(40);
			$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
			ob_end_flush();

		
		}


		if(($nivel=='SECUNDARIA MAÑANA')OR($nivel=='SECUNDARIA TARDE'))
		{
			$idsql="secundaria";

			$curso=$this->estud->get_print_curso_pdf($idcur);
			
			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			$this->load->library('pdf');		
			
			if(($curso1=='PRIMERO A')OR($curso1=='PRIMERO B')OR($curso1=='SEGUNDO A')OR($curso1=='SEGUNDO B'))
			{	
				$i=0;										

				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);//rompe el documento en nueva pagina
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("ACUMULADOS de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO -  DE 4 BIMESTRES'),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');;
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(21,8,'TTG','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(93);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(163);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'QUECHUA','U');	    		
	    		$this->pdf->TextWithDirection(91,116,'PROMEDIO COL','U');
	    		$this->pdf->TextWithDirection(98,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(105,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(154,116,'QUIMICA','U');
	    		$this->pdf->TextWithDirection(161,116,'TEC. TECNOL. GENERAL','U');
	    		$this->pdf->TextWithDirection(168,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(175,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(182,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(189,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);
				
	    		$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);

				foreach ($estudiante as $list)
				{
					$idest=$list->idest;				
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$i++;

					$LENGUAJE=round((($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/$numbi),0);
					$QUECHUA=round((($notabi->QUECHUA1+$notabi->QUECHUA2+$notabi->QUECHUA3+$notabi->QUECHUA4)/$numbi),0);
					$INGLES1=round((($notabi->INGLES11+$notabi->INGLES12+$notabi->INGLES13+$notabi->INGLES14)/$numbi),0);
					$INGLES2=round((($notabi->INGLES21+$notabi->INGLES22+$notabi->INGLES23+$notabi->INGLES24)/$numbi),0);
					$SOCIALES=round((($notabi->SOCIALES1+$notabi->SOCIALES2+$notabi->SOCIALES3+$notabi->SOCIALES4)/$numbi),0);
					$EDUFISICA=round((($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/$numbi),0);
					$MUSICA1=round((($notabi->MUSICA11+$notabi->MUSICA12+$notabi->MUSICA13+$notabi->MUSICA14)/$numbi),0);
					$MUSICA2=round((($notabi->MUSICA21+$notabi->MUSICA22+$notabi->MUSICA23+$notabi->MUSICA24)/$numbi),0);
					$MUSICA=$MUSICA1+$MUSICA2;
					$ARTPLAST=round((($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/$numbi),0);
					$MATEMATICAS=round((($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/$numbi),0);
					$INFORMATICA=round((($notabi->INFORMATICA1+$notabi->INFORMATICA2+$notabi->INFORMATICA3+$notabi->INFORMATICA4)/$numbi),0);
					$FISICA=round((($notabi->FISICA1+$notabi->FISICA2+$notabi->FISICA3+$notabi->FISICA4)/3),0);
					$QUIMICA=round((($notabi->QUIMICA1+$notabi->QUIMICA2+$notabi->QUIMICA3+$notabi->QUIMICA4)/3),0);
					$CIENCIAS=round((($notabi->CIENCIAS1+$notabi->CIENCIAS2+$notabi->CIENCIAS3+$notabi->CIENCIAS4)/$numbi),0);
					$COSMO=round((($notabi->COSMO1+$notabi->COSMO2+$notabi->COSMO3+$notabi->COSMO4)/$numbi),0);
					$RELIGION=round((($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/$numbi),0);

					$notafinal=round((round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2)+$ARTPLAST+$MATEMATICAS+round((($INFORMATICA+$FISICA+$QUIMICA)/3),0)+$CIENCIAS+$COSMO+$RELIGION)/11,0);

					$comunidad=round(( round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2)+$ARTPLAST)/6,0);
					$ciencia=round(($MATEMATICAS+round((($INFORMATICA+$FISICA+$QUIMICA)/3),0))/2,0);
					$vida=$CIENCIAS;
					$cosmos=round(($COSMO+$RELIGION)/2,0);

					$nf_honor=round((round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2)+$ARTPLAST+$MATEMATICAS+round((($INFORMATICA+$FISICA+$QUIMICA)/3),0)+$CIENCIAS+$COSMO+$RELIGION)/11,2);

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres))							
						);

					$est[]=array(
						"comunidad"=>$comunidad,
						"ciencia"=>$ciencia,
						"vida"=>$vida,
						"cosmos"=>$cosmos
					);

						if($i==23)
						{
							
							$this->pdf->AddPage();
							$this->pdf->SetAutoPageBreak(false);
				    		$this->pdf->SetFillColor(189,215,238); //azul
				    		$this->pdf->SetFont('Arial', 'B', 8);
				    		$this->pdf->Ln(5);
				    		
				    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
				    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
				    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
				    		$this->pdf->Ln(7);
				    		$this->pdf->SetX(72);
				    		
				    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
				    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
				    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
				    		$this->pdf->Cell(21,8,'TTG','TBLR',0,'C','1');	    	
				    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
				    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

				    		$this->pdf->Ln(8);

				    		$this->pdf->SetX(72);    		
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->SetX(93);
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->SetX(163);
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
				    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

				    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
				    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
				    		$this->pdf->TextWithDirection(84,86,'QUECHUA','U');	    		
				    		$this->pdf->TextWithDirection(91,86,'PROMEDIO COL','U');
				    		$this->pdf->TextWithDirection(98,86,'INGLES','U');
				    		$this->pdf->TextWithDirection(105,86,'CIENCIAS SOCIALES','U');
				    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
				    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
				    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
				    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
				    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
				    		$this->pdf->TextWithDirection(147,86,'FISICA','U');
				    		$this->pdf->TextWithDirection(154,86,'QUIMICA','U');
				    		$this->pdf->TextWithDirection(161,86,'TEC. TECNOL. GENERAL','U');
				    		$this->pdf->TextWithDirection(168,86,'CIENCIAS NATURALES','U');
				    		$this->pdf->TextWithDirection(175,86,'COSMOS,FILOSOFIA..','U');
				    		$this->pdf->TextWithDirection(182,86,'VAL./ ESPIRITUALIDAD','U');
				    		$this->pdf->SetFont('Arial', 'B', 8);
				    		$this->pdf->TextWithDirection(189,86,'PROMEDIO BIMESTRAL','U');
				    		$this->pdf->Ln(34);																				
						}
											
							$this->pdf->SetFont('Arial', '', 8);
							$this->pdf->SetFillColor(255,255,255);  //blanco
							$num=$num+1;
							$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
							$this->pdf->Cell(60,8,strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres)),'TBLR',0,'L','1');
							$this->pdf->SetFillColor(255,255,205); //amalelo 
							if ($LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($LENGUAJE<61)and($LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($LENGUAJE<76)and($LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
					        $this->pdf->Cell(7,8,$LENGUAJE,'TBLR',0,'C','1');
					        $this->pdf->SetFillColor(255,255,205); //amalelo 
					        if ($QUECHUA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUECHUA<61)and($QUECHUA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUECHUA<76)and($QUECHUA>60)) {$this->pdf->SetFillColor(198,255,175);}	
			    			$this->pdf->Cell(7,8,$QUECHUA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(221,235,247); //azul
			    			$this->pdf->Cell(7,8,round((($LENGUAJE+$QUECHUA)/2),0),'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			 if (($INGLES1+$INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($INGLES1+$INGLES2)<61)and(($INGLES1+$INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($INGLES1+$INGLES2)<76)and(($INGLES1+$INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}	
			    			$this->pdf->Cell(7,8,($INGLES1+$INGLES2),'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($SOCIALES<61)and($SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($SOCIALES<76)and($SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}	
			    			$this->pdf->Cell(7,8,$SOCIALES,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($EDUFISICA<61)and($EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($EDUFISICA<76)and($EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
			    			$this->pdf->Cell(7,8,$EDUFISICA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($MUSICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MUSICA<61)and($MUSICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MUSICA<76)and($MUSICA>60)) {$this->pdf->SetFillColor(198,255,175);}
			    			$this->pdf->Cell(7,8,$MUSICA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($ARTPLAST<61)and($ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($ARTPLAST<76)and($ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
			    			$this->pdf->Cell(7,8,$ARTPLAST,'TBLR',0,'C','1');	
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MATEMATICAS<61)and($MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MATEMATICAS<76)and($MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}    			
			    			$this->pdf->Cell(7,8,$MATEMATICAS,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($INFORMATICA<61)and($INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($INFORMATICA<76)and($INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
			    			$this->pdf->Cell(7,8,$INFORMATICA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($FISICA<61)and($FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($FISICA<76)and($FISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
			    			$this->pdf->Cell(7,8,$FISICA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUIMICA<61)and($QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUIMICA<76)and($QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
			    			$this->pdf->Cell(7,8,$QUIMICA,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(221,235,247); //azul
			    			$this->pdf->Cell(7,8,round((($INFORMATICA+$FISICA+$QUIMICA)/3),0),'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($CIENCIAS<61)and($CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($CIENCIAS<76)and($CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);} 
			    			$this->pdf->Cell(7,8,$CIENCIAS,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 
			    			if ($COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($COSMO<61)and($COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($COSMO<76)and($COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}
			    			$this->pdf->Cell(7,8,$COSMO,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(255,255,205); //amalelo 	
			    			if ($RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($RELIGION<61)and($RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($RELIGION<76)and($RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}    			
			    			$this->pdf->Cell(7,8,$RELIGION,'TBLR',0,'C','1');
			    			$this->pdf->SetFillColor(189,215,238); //azul
			    			$this->pdf->SetFont('Arial', 'B', 8);
			    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
							

						    $this->pdf->Ln(7);
						//}
				}
			
				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,'4 bimestres',0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}

				$this->pdf->Ln(24);
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('PROMEDIO POR CAMPOS DE SABERES'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);

				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CAMPO DE SABERES Y CONOCIMIENTOS','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				$k=0;
				$sc1=0;$sc2=0;$sc3=0;$sc4=0;								
				foreach ($est as $campo)
				{
					$k++;
					$sc1=$sc1+$campo['comunidad'];
					$sc2=$sc2+$campo['ciencia'];
					$sc3=$sc3+$campo['vida'];
					$sc4=$sc4+$campo['cosmos'];				
					
				}

				$this->pdf->Cell(12,8,'1','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COMUNIDAD Y SOCIEDAD','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc1/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);	
				$this->pdf->Cell(12,8,'2','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CIENCIA TECNOLOGIA Y PRODUCCION','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc2/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'3','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'VIDA TIERRA TERRITORIO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc3/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'4','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COSMOS Y PENSAMIENTO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc4/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);

				$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
			}


			if(($curso1=='TERCERO A')OR($curso1=='TERCERO B'))
			{		
				$i=0;		
			
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("ACUMULADOS de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO -  DE 4 BIMESTRES'),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(93);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(156);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'QUECHUA','U');	    		
	    		$this->pdf->TextWithDirection(91,116,'PROMEDIO COL','U');
	    		$this->pdf->TextWithDirection(98,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(105,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(154,116,'PROM FIS-QUI','U');
	    		$this->pdf->TextWithDirection(161,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(168,116,'QUIMICA','U');	    	
	    		$this->pdf->TextWithDirection(175,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(182,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(189,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);
				
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);

				foreach ($estudiante as $list)
				{
					$idest=$list->idest;				
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$i++;

					$LENGUAJE=round((($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/$numbi),0);
					$QUECHUA=round((($notabi->QUECHUA1+$notabi->QUECHUA2+$notabi->QUECHUA3+$notabi->QUECHUA4)/$numbi),0);
					$INGLES1=round((($notabi->INGLES11+$notabi->INGLES12+$notabi->INGLES13+$notabi->INGLES14)/$numbi),0);
					$INGLES2=round((($notabi->INGLES21+$notabi->INGLES22+$notabi->INGLES23+$notabi->INGLES24)/$numbi),0);
					$SOCIALES=round((($notabi->SOCIALES1+$notabi->SOCIALES2+$notabi->SOCIALES3+$notabi->SOCIALES4)/$numbi),0);
					$EDUFISICA=round((($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/$numbi),0);
					$MUSICA1=round((($notabi->MUSICA11+$notabi->MUSICA12+$notabi->MUSICA13+$notabi->MUSICA14)/$numbi),0);
					$MUSICA2=round((($notabi->MUSICA21+$notabi->MUSICA22+$notabi->MUSICA23+$notabi->MUSICA24)/$numbi),0);
					$MUSICA3=round((($notabi->MUSICA31+$notabi->MUSICA32+$notabi->MUSICA33+$notabi->MUSICA34)/$numbi),0);
					$ARTPLAST=round((($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/$numbi),0);
					$MATEMATICAS=round((($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/$numbi),0);
					$INFORMATICA=round((($notabi->INFORMATICA1+$notabi->INFORMATICA2+$notabi->INFORMATICA3+$notabi->INFORMATICA4)/$numbi),0);
					$FISICA=round((($notabi->FISICA1+$notabi->FISICA2+$notabi->FISICA3+$notabi->FISICA4)/$numbi),0);
					$QUIMICA=round((($notabi->QUIMICA1+$notabi->QUIMICA2+$notabi->QUIMICA3+$notabi->QUIMICA4)/$numbi),0);
					$CIENCIAS=round((($notabi->CIENCIAS1+$notabi->CIENCIAS2+$notabi->CIENCIAS3+$notabi->CIENCIAS4)/$numbi),0);
					$COSMO=round((($notabi->COSMO1+$notabi->COSMO2+$notabi->COSMO3+$notabi->COSMO4)/$numbi),0);
					$RELIGION=round((($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/$numbi),0);


					$notafinal=round((round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+$INFORMATICA+round((($FISICA+$QUIMICA)/2),0)+$CIENCIAS+$COSMO+$RELIGION)/12,0);

					$nf_honor=round((round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+$INFORMATICA+round((($FISICA+$QUIMICA)/2),0)+$CIENCIAS+$COSMO+$RELIGION)/12,2);


					$comunidad=round((round((($LENGUAJE+$QUECHUA)/2),0)+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST)/6,0);
					$ciencia=round(($MATEMATICAS+$INFORMATICA)/2,0);
					$vida=round((round((($FISICA+$QUIMICA)/2),0)+$CIENCIAS)/2,0);
					$cosmos=round(($COSMO+$RELIGION)/2,0);

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres))							
						);


					$est[]=array(
						"comunidad"=>$comunidad,
						"ciencia"=>$ciencia,
						"vida"=>$vida,
						"cosmos"=>$cosmos
					);



					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(126,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(14,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(93);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(156);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'QUECHUA','U');	    		
			    		$this->pdf->TextWithDirection(91,86,'PROMEDIO COL','U');
			    		$this->pdf->TextWithDirection(98,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(105,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(147,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(154,86,'PROM FIS-QUI','U');
			    		$this->pdf->TextWithDirection(161,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(168,86,'QUIMICA','U');	    	
			    		$this->pdf->TextWithDirection(175,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(182,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(189,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);
					}
					
						$this->pdf->SetFont('Arial', '', 8);
						$this->pdf->SetFillColor(255,255,255);  //blanco
						$num=$num+1;
						$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
						$this->pdf->Cell(60,8,strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres)),'TBLR',0,'L','1');
						$this->pdf->SetFillColor(255,255,205); //amalelo 
						if ($LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($LENGUAJE<61)and($LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($LENGUAJE<76)and($LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
				        $this->pdf->Cell(7,8,$LENGUAJE,'TBLR',0,'C','1');
				        $this->pdf->SetFillColor(255,255,205); //amalelo 
				        if ($QUECHUA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUECHUA<61)and($QUECHUA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUECHUA<76)and($QUECHUA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$QUECHUA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($LENGUAJE+$QUECHUA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			 if (($INGLES1+$INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($INGLES1+$INGLES2)<61)and(($INGLES1+$INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($INGLES1+$INGLES2)<76)and(($INGLES1+$INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,($INGLES1+$INGLES2),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 	    			
		    			if ($SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($SOCIALES<61)and($SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($SOCIALES<76)and($SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$SOCIALES,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			$this->pdf->Cell(7,8,$EDUFISICA,'TBLR',0,'C','1');
		    			if ($EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($EDUFISICA<61)and($EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($EDUFISICA<76)and($EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if (($MUSICA1+$MUSICA2+$MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<61)and(($MUSICA1+$MUSICA2+$MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<76)and(($MUSICA1+$MUSICA2+$MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,($MUSICA1+$MUSICA2+$MUSICA3),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 			
		    			if ($ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($ARTPLAST<61)and($ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($ARTPLAST<76)and($ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$ARTPLAST,'TBLR',0,'C','1');	
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MATEMATICAS<61)and($MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MATEMATICAS<76)and($MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}	    			
		    			$this->pdf->Cell(7,8,$MATEMATICAS,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($INFORMATICA<61)and($INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($INFORMATICA<76)and($INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
		    			$this->pdf->Cell(7,8,$INFORMATICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($CIENCIAS<61)and($CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($CIENCIAS<76)and($CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);}	
		    			$this->pdf->Cell(7,8,$CIENCIAS,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($FISICA+$QUIMICA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($FISICA<61)and($FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($FISICA<76)and($FISICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
		    			$this->pdf->Cell(7,8,$FISICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUIMICA<61)and($QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUIMICA<76)and($QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);}	
		    			$this->pdf->Cell(7,8,$QUIMICA,'TBLR',0,'C','1');
		    			
		    			
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($COSMO<61)and($COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($COSMO<76)and($COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}	
		    			$this->pdf->Cell(7,8,$COSMO,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 	    			
		    			$this->pdf->Cell(7,8,$RELIGION,'TBLR',0,'C','1');
		    			if ($RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($RELIGION<61)and($RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($RELIGION<76)and($RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->SetFillColor(189,215,238); //azul
		    			$this->pdf->SetFont('Arial', 'B', 8);
		    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
					

				    	$this->pdf->Ln(7);
						//}
				}

				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,'4 bimestres',0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}

				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('PROMEDIO POR CAMPOS DE SABERES'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);

				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CAMPO DE SABERES Y CONOCIMIENTOS','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	

				$k=0;
				$sc1=0;$sc2=0;$sc3=0;$sc4=0;								
				foreach ($est as $campo)
				{
					$k++;
					$sc1=$sc1+$campo['comunidad'];
					$sc2=$sc2+$campo['ciencia'];
					$sc3=$sc3+$campo['vida'];
					$sc4=$sc4+$campo['cosmos'];				
					
				}

				$this->pdf->Cell(12,8,'1','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COMUNIDAD Y SOCIEDAD','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc1/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);	
				$this->pdf->Cell(12,8,'2','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CIENCIA TECNOLOGIA Y PRODUCCION','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc2/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'3','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'VIDA TIERRA TERRITORIO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc3/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'4','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COSMOS Y PENSAMIENTO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc4/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);

				$this->pdf->Ln(40);
				$this->pdf->Output("Centra -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}

			if(($curso1=='CUARTO A')OR($curso1=='CUARTO B'))
			{		
				$i=0;			
							
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO -  DE 4 BIMESTRES'),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(112,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(142);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    			    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(91,116,'CIENCIAS SOCIALES','U');
	    		$this->pdf->TextWithDirection(98,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(105,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(112,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(119,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(126,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(133,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(140,116,'PROMEDIO FIS-QUI','U');
	    		$this->pdf->TextWithDirection(147,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(154,116,'QUIMICA','U');	    		
	    		$this->pdf->TextWithDirection(161,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(168,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(175,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);		

				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);

				foreach ($estudiante as $list)
				{
					$idest=$list->idest;				
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$LENGUAJE=round((($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/$numbi),0);
					$INGLES1=round((($notabi->INGLES11+$notabi->INGLES12+$notabi->INGLES13+$notabi->INGLES14)/$numbi),0);
					$INGLES2=round((($notabi->INGLES21+$notabi->INGLES22+$notabi->INGLES23+$notabi->INGLES24)/$numbi),0);
					$SOCIALES=round((($notabi->SOCIALES1+$notabi->SOCIALES2+$notabi->SOCIALES3+$notabi->SOCIALES4)/$numbi),0);
					$EDUFISICA=round((($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/$numbi),0);
					$MUSICA1=round((($notabi->MUSICA11+$notabi->MUSICA12+$notabi->MUSICA13+$notabi->MUSICA14)/$numbi),0);
					$MUSICA2=round((($notabi->MUSICA21+$notabi->MUSICA22+$notabi->MUSICA23+$notabi->MUSICA24)/$numbi),0);
					$MUSICA3=round((($notabi->MUSICA31+$notabi->MUSICA32+$notabi->MUSICA33+$notabi->MUSICA34)/$numbi),0);
					$ARTPLAST=round((($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/$numbi),0);
					$MATEMATICAS=round((($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/$numbi),0);
					$INFORMATICA=round((($notabi->INFORMATICA1+$notabi->INFORMATICA2+$notabi->INFORMATICA3+$notabi->INFORMATICA4)/$numbi),0);
					$FISICA=round((($notabi->FISICA1+$notabi->FISICA2+$notabi->FISICA3+$notabi->FISICA4)/$numbi),0);
					$QUIMICA=round((($notabi->QUIMICA1+$notabi->QUIMICA2+$notabi->QUIMICA3+$notabi->QUIMICA4)/$numbi),0);
					$CIENCIAS=round((($notabi->CIENCIAS1+$notabi->CIENCIAS2+$notabi->CIENCIAS3+$notabi->CIENCIAS4)/$numbi),0);
					$COSMO=round((($notabi->COSMO1+$notabi->COSMO2+$notabi->COSMO3+$notabi->COSMO4)/$numbi),0);
					$RELIGION=round((($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/$numbi),0);


					$notafinal=round(($LENGUAJE+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+$INFORMATICA+$CIENCIAS+round((($FISICA+$QUIMICA)/2),0)+$COSMO+$RELIGION)/12,0);

					$nf_honor=round(($LENGUAJE+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+$INFORMATICA+$CIENCIAS+round((($FISICA+$QUIMICA)/2),0)+$COSMO+$RELIGION)/12,2);

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres))							
						);

					$comunidad=round(($LENGUAJE+($INGLES1+$INGLES2)+$SOCIALES+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST)/6,0);
					$ciencia=round(($MATEMATICAS+$INFORMATICA)/2,0);
					$vida=round(($CIENCIAS+round((($FISICA+$QUIMICA)/2),0)/2),0);
					$cosmos=round(($COSMO+$RELIGION)/2,0);					

					$est[]=array(
						"comunidad"=>$comunidad,
						"ciencia"=>$ciencia,
						"vida"=>$vida,
						"cosmos"=>$cosmos
					);

					
					$i++;
					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(112,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'CN','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FQ','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(14,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(142);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(91,86,'CIENCIAS SOCIALES','U');
			    		$this->pdf->TextWithDirection(98,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(105,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(112,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(119,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(126,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(133,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(140,86,'PROMEDIO FIS-QUI','U');
			    		$this->pdf->TextWithDirection(147,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(154,86,'QUIMICA','U');	    		
			    		$this->pdf->TextWithDirection(161,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(168,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(175,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);		
					}
										
						$this->pdf->SetFont('Arial', '', 8);
						$this->pdf->SetFillColor(255,255,255);  //blanco
						$num=$num+1;
						$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
						$this->pdf->Cell(60,8,strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres)),'TBLR',0,'L','1');
						$this->pdf->SetFillColor(255,255,205); //amalelo 
						if ($LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($LENGUAJE<61)and($LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($LENGUAJE<76)and($LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);}
				        $this->pdf->Cell(7,8,$LENGUAJE,'TBLR',0,'C','1');	
				        $this->pdf->SetFillColor(255,255,205); //amalelo 
				        if (($INGLES1+$INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($INGLES1+$INGLES2)<61)and(($INGLES1+$INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($INGLES1+$INGLES2)<76)and(($INGLES1+$INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);}    			
		    			$this->pdf->Cell(7,8,($INGLES1+$INGLES2),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($SOCIALES<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($SOCIALES<61)and($SOCIALES>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($SOCIALES<76)and($SOCIALES>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$SOCIALES,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($EDUFISICA<61)and($EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($EDUFISICA<76)and($EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$EDUFISICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if (($MUSICA1+$MUSICA2+$MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<61)and(($MUSICA1+$MUSICA2+$MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<76)and(($MUSICA1+$MUSICA2+$MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,($MUSICA1+$MUSICA2+$MUSICA3),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($ARTPLAST<61)and($ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($ARTPLAST<76)and($ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$ARTPLAST,'TBLR',0,'C','1');	
		    			$this->pdf->SetFillColor(255,255,205); //amalelo   
		    			if ($MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MATEMATICAS<61)and($MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MATEMATICAS<76)and($MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}  			
		    			$this->pdf->Cell(7,8,$MATEMATICAS,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo   
		    			if ($INFORMATICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($INFORMATICA<61)and($INFORMATICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($INFORMATICA<76)and($INFORMATICA>60)) {$this->pdf->SetFillColor(198,255,175);} 	    			 
		    			$this->pdf->Cell(7,8,$INFORMATICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($CIENCIAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($CIENCIAS<61)and($CIENCIAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($CIENCIAS<76)and($CIENCIAS>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$CIENCIAS,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($FISICA+$QUIMICA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($FISICA<61)and($FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($FISICA<76)and($FISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$FISICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUIMICA<61)and($QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUIMICA<76)and($QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$QUIMICA,'TBLR',0,'C','1');	    				    			
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($COSMO<61)and($COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($COSMO<76)and($COSMO>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$COSMO,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($RELIGION<61)and($RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($RELIGION<76)and($RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);} 	    			
		    			$this->pdf->Cell(7,8,$RELIGION,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(189,215,238); //azul
		    			$this->pdf->SetFont('Arial', 'B', 8);
		    			$this->pdf->Cell(14,8,$notafinal,'TBLR',0,'C','1');
						
					    $this->pdf->Ln(7);

					//}
				}
					
				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,'4 bimestres',0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=3)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}

				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('PROMEDIO POR CAMPOS DE SABERES'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);

				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CAMPO DE SABERES Y CONOCIMIENTOS','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	

				$k=0;
				$sc1=0;$sc2=0;$sc3=0;$sc4=0;								
				foreach ($est as $campo)
				{
					$k++;
					$sc1=$sc1+$campo['comunidad'];
					$sc2=$sc2+$campo['ciencia'];
					$sc3=$sc3+$campo['vida'];
					$sc4=$sc4+$campo['cosmos'];				
					
				}

				$this->pdf->Cell(12,8,'1','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COMUNIDAD Y SOCIEDAD','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc1/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);	
				$this->pdf->Cell(12,8,'2','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CIENCIA TECNOLOGIA Y PRODUCCION','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc2/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'3','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'VIDA TIERRA TERRITORIO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc3/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'4','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COSMOS Y PENSAMIENTO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc4/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);

				$this->pdf->Ln(40);




				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}
			
			if(($curso1=='QUINTO A')OR($curso1=='QUINTO B')OR($curso1=='SEXTO A')OR($curso1=='SEXTO B'))
			{		
				$i=0;
										
				$num=0;
				ob_start();
				$this->pdf=new Pdf('Letter');
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO -  DE 4 BIMESTRES'),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('NOMBRE: '),0,0,'L');
	            $this->pdf->setX(75);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('CURSO: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(75); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
	            $this->pdf->SetLeftMargin(5);
	    		$this->pdf->SetRightMargin(5);
	    		$this->pdf->SetFillColor(189,215,238); //azul
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		
	    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
	    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(136,7,'CENTRALIZADOR','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(72);
	    		
	    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'HIS-CIV','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');	    	
	    		$this->pdf->Cell(14,8,'BIO-GEO','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(14,8,'FIS-QUI','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
	    		$this->pdf->Cell(10,42,'','TBLR',0,'C','1');

	    		$this->pdf->Ln(8);

	    		$this->pdf->SetX(72);    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->SetX(107);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->SetX(170);    		   			    		
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->SetX(184);
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
	    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

	    		$this->pdf->TextWithDirection(10,116,'NUMERO','U');
	    		$this->pdf->TextWithDirection(77,116,'LENGUAJE','U');
	    		$this->pdf->TextWithDirection(84,116,'INGLES','U');
	    		$this->pdf->TextWithDirection(91,116,'HISTORIA','U');
	    		$this->pdf->TextWithDirection(98,116,'CIVICA','U');
	    		$this->pdf->TextWithDirection(105,116,'PROMD CIENCIAS SOC','U');
	    		$this->pdf->TextWithDirection(112,116,'EDU.FISICA DEPORT','U');
	    		$this->pdf->TextWithDirection(119,116,'EDU. MUSICAL','U');
	    		$this->pdf->TextWithDirection(126,116,'ART. PLAST. VISUALES','U');
	    		$this->pdf->TextWithDirection(133,116,'MATEMATICAS','U');
	    		$this->pdf->TextWithDirection(140,116,'INFORMATICA','U');
	    		$this->pdf->TextWithDirection(147,116,'BIOLOGIA','U');
	    		$this->pdf->TextWithDirection(154,116,'GEOGRAFIA','U');
	    		$this->pdf->TextWithDirection(161,116,'CIENCIAS NATURALES','U');
	    		$this->pdf->TextWithDirection(168,116,'PROMD FIS-QUI','U');
	    		$this->pdf->TextWithDirection(175,116,'FISICA','U');
	    		$this->pdf->TextWithDirection(182,116,'QUIMICA','U');	    		
	    		$this->pdf->TextWithDirection(189,116,'COSMOS,FILOSOFIA..','U');
	    		$this->pdf->TextWithDirection(196,116,'VAL./ ESPIRITUALIDAD','U');
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->TextWithDirection(203,116,'PROMEDIO BIMESTRAL','U');
	    		$this->pdf->Ln(34);	

				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);

				foreach ($estudiante as $list)
				{
					$idest=$list->idest;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$LENGUAJE=round((($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/$numbi),0);
					$INGLES1=round((($notabi->INGLES11+$notabi->INGLES12+$notabi->INGLES13+$notabi->INGLES14)/$numbi),0);
					$INGLES2=round((($notabi->INGLES21+$notabi->INGLES22+$notabi->INGLES23+$notabi->INGLES24)/$numbi),0);
					$HISTORIA=round((($notabi->HISTORIA1+$notabi->HISTORIA2+$notabi->HISTORIA3+$notabi->HISTORIA4)/$numbi),0);
					$CIVICA=round((($notabi->CIVICA1+$notabi->CIVICA2+$notabi->CIVICA3+$notabi->CIVICA4)/$numbi),0);					
					$EDUFISICA=round((($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/$numbi),0);
					$MUSICA1=round((($notabi->MUSICA11+$notabi->MUSICA12+$notabi->MUSICA13+$notabi->MUSICA14)/$numbi),0);
					$MUSICA2=round((($notabi->MUSICA21+$notabi->MUSICA22+$notabi->MUSICA23+$notabi->MUSICA24)/$numbi),0);
					$MUSICA3=round((($notabi->MUSICA31+$notabi->MUSICA32+$notabi->MUSICA33+$notabi->MUSICA34)/$numbi),0);
					$ARTPLAST=round((($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/$numbi),0);
					$MATEMATICAS=round((($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/$numbi),0);
					$INFORMATICA1=round((($notabi->INFORMATICA11+$notabi->INFORMATICA12+$notabi->INFORMATICA13+$notabi->INFORMATICA14)/$numbi),0);
					$INFORMATICA2=round((($notabi->INFORMATICA21+$notabi->INFORMATICA22+$notabi->INFORMATICA23+$notabi->INFORMATICA24)/$numbi),0);
					$FISICA=round((($notabi->FISICA1+$notabi->FISICA2+$notabi->FISICA3+$notabi->FISICA4)/$numbi),0);
					$QUIMICA=round((($notabi->QUIMICA1+$notabi->QUIMICA2+$notabi->QUIMICA3+$notabi->QUIMICA4)/$numbi),0);
					$BIOLOGIA=round((($notabi->BIOLOGIA1+$notabi->BIOLOGIA2+$notabi->BIOLOGIA3+$notabi->BIOLOGIA4)/$numbi),0);
					$GEOGRAFIA=round((($notabi->GEOGRAFIA1+$notabi->GEOGRAFIA2+$notabi->GEOGRAFIA3+$notabi->GEOGRAFIA4)/$numbi),0);					
					$COSMO=round((($notabi->COSMO1+$notabi->COSMO2+$notabi->COSMO3+$notabi->COSMO4)/$numbi),0);
					$RELIGION=round((($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/$numbi),0);

					$notafinal=round(($LENGUAJE+($INGLES1+$INGLES2)+(($HISTORIA+$CIVICA)/2)+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+($INFORMATICA1+$INFORMATICA2)+(($FISICA+$QUIMICA)/2)+(($BIOLOGIA+$GEOGRAFIA)/2)+$COSMO+$RELIGION)/12,0);

					$nf_honor=round(($LENGUAJE+($INGLES1+$INGLES2)+(($HISTORIA+$CIVICA)/2)+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST+$MATEMATICAS+($INFORMATICA1+$INFORMATICA2)+(($FISICA+$QUIMICA)/2)+(($BIOLOGIA+$GEOGRAFIA)/2)+$COSMO+$RELIGION)/12,2);

					$row[] = array(
							"nota"=>$nf_honor,
							"nomb"=>strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres))							
						);

					$comunidad=round(($LENGUAJE+($INGLES1+$INGLES2)+(($HISTORIA+$CIVICA)/2)+$EDUFISICA+($MUSICA1+$MUSICA2+$MUSICA3)+$ARTPLAST)/6,0);
					$ciencia=round(($MATEMATICAS+($INFORMATICA1+$INFORMATICA2))/2,0);
					$vida=round((round(($FISICA+$QUIMICA)/2,0)+round(($BIOLOGIA+$GEOGRAFIA)/2,0))/2,0);
					$cosmos=round(($COSMO+$RELIGION)/2,0);					

					$est[]=array(
						"comunidad"=>$comunidad,
						"ciencia"=>$ciencia,
						"vida"=>$vida,
						"cosmos"=>$cosmos
					);


					$i++;
					if($i==23)
					{
						$this->pdf->AddPage();
						$this->pdf->SetAutoPageBreak(false);
			    		$this->pdf->SetFillColor(189,215,238); //azul
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->Ln(5);
			    		
			    		$this->pdf->Cell(7,49,'','TBL',0,'L','1');		    		
			    		$this->pdf->Cell(60,49,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(136,7,'CENTRALIZADOR','TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    		$this->pdf->SetX(72);
			    		
			    		$this->pdf->Cell(7,8,'LCO','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'LEX','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'HIS-CIV','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EFD','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'EM','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'APV','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(7,8,'MAT','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'INF','TBLR',0,'C','1');	    	
			    		$this->pdf->Cell(14,8,'BIO-GEO','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,42,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(14,8,'FIS-QUI','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,8,'COS','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,8,'VAL','TBLR',0,'C','1');	    			    	
			    		$this->pdf->Cell(10,42,'','TBLR',0,'C','1');

			    		$this->pdf->Ln(8);

			    		$this->pdf->SetX(72);    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->SetX(107);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->SetX(170);    		   			    		
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->SetX(184);
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');	
			    		$this->pdf->Cell(7,34,'','TBLR',0,'C','1');

			    		$this->pdf->TextWithDirection(10,86,'NUMERO','U');
			    		$this->pdf->TextWithDirection(77,86,'LENGUAJE','U');
			    		$this->pdf->TextWithDirection(84,86,'INGLES','U');
			    		$this->pdf->TextWithDirection(91,86,'HISTORIA','U');
			    		$this->pdf->TextWithDirection(98,86,'CIVICA','U');
			    		$this->pdf->TextWithDirection(105,86,'PROMD CIENCIAS SOC','U');
			    		$this->pdf->TextWithDirection(112,86,'EDU.FISICA DEPORT','U');
			    		$this->pdf->TextWithDirection(119,86,'EDU. MUSICAL','U');
			    		$this->pdf->TextWithDirection(126,86,'ART. PLAST. VISUALES','U');
			    		$this->pdf->TextWithDirection(133,86,'MATEMATICAS','U');
			    		$this->pdf->TextWithDirection(140,86,'INFORMATICA','U');
			    		$this->pdf->TextWithDirection(147,86,'BIOLOGIA','U');
			    		$this->pdf->TextWithDirection(154,86,'GEOGRAFIA','U');
			    		$this->pdf->TextWithDirection(161,86,'CIENCIAS NATURALES','U');
			    		$this->pdf->TextWithDirection(168,86,'PROMD FIS-QUI','U');
			    		$this->pdf->TextWithDirection(175,86,'FISICA','U');
			    		$this->pdf->TextWithDirection(182,86,'QUIMICA','U');	    		
			    		$this->pdf->TextWithDirection(189,86,'COSMOS,FILOSOFIA..','U');
			    		$this->pdf->TextWithDirection(196,86,'VAL./ ESPIRITUALIDAD','U');
			    		$this->pdf->SetFont('Arial', 'B', 8);
			    		$this->pdf->TextWithDirection(203,86,'PROMEDIO BIMESTRAL','U');
			    		$this->pdf->Ln(34);	
					}

					    $this->pdf->SetFont('Arial', '', 8);
						$this->pdf->SetFillColor(255,255,255);  //blanco
						$num=$num+1;
						$this->pdf->Cell(7,8,$num,'TBLR',0,'L','1');
						$this->pdf->Cell(60,8,strtoupper(utf8_decode($notabi->appat." ".$notabi->apmat." ".$notabi->nombres)),'TBLR',0,'L','1');
						$this->pdf->SetFillColor(255,255,205); //amalelo 
						if ($LENGUAJE<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($LENGUAJE<61)and($LENGUAJE>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($LENGUAJE<76)and($LENGUAJE>60)) {$this->pdf->SetFillColor(198,255,175);} 	
				        $this->pdf->Cell(7,8,$LENGUAJE,'TBLR',0,'C','1');	    			
				        $this->pdf->SetFillColor(255,255,205); //amalelo 
				        if (($INGLES1+$INGLES2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($INGLES1+$INGLES2)<61)and(($INGLES1+$INGLES2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($INGLES1+$INGLES2)<76)and(($INGLES1+$INGLES2)>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,($INGLES1+$INGLES2),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($HISTORIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($HISTORIA<61)and($HISTORIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($HISTORIA<76)and($HISTORIA>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$HISTORIA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($CIVICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($CIVICA<61)and($CIVICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($CIVICA<76)and($CIVICA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$CIVICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($HISTORIA+$CIVICA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if ($EDUFISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($EDUFISICA<61)and($EDUFISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($EDUFISICA<76)and($EDUFISICA>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,$EDUFISICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if (($MUSICA1+$MUSICA2+$MUSICA3)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<61)and(($MUSICA1+$MUSICA2+$MUSICA3)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($MUSICA1+$MUSICA2+$MUSICA3)<76)and(($MUSICA1+$MUSICA2+$MUSICA3)>60)) {$this->pdf->SetFillColor(198,255,175);} 
		    			$this->pdf->Cell(7,8,($MUSICA1+$MUSICA2+$MUSICA3),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if ($ARTPLAST<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($ARTPLAST<61)and($ARTPLAST>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($ARTPLAST<76)and($ARTPLAST>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$ARTPLAST,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if ($MATEMATICAS<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($MATEMATICAS<61)and($MATEMATICAS>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($MATEMATICAS<76)and($MATEMATICAS>60)) {$this->pdf->SetFillColor(198,255,175);}	    				    			
		    			$this->pdf->Cell(7,8,$MATEMATICAS,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if (($INFORMATICA1+$INFORMATICA2)<51) {$this->pdf->SetFillColor(250,104,102);} elseif ((($INFORMATICA1+$INFORMATICA2)<61)and(($INFORMATICA1+$INFORMATICA2)>50)){$this->pdf->SetFillColor(221,200,255);}elseif ((($INFORMATICA1+$INFORMATICA2)<76)and(($INFORMATICA1+$INFORMATICA2)>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,($INFORMATICA1+$INFORMATICA2),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if ($BIOLOGIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($BIOLOGIA<61)and($BIOLOGIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($BIOLOGIA<76)and($BIOLOGIA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$BIOLOGIA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo
		    			if ($GEOGRAFIA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($GEOGRAFIA<61)and($GEOGRAFIA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($GEOGRAFIA<76)and($GEOGRAFIA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$GEOGRAFIA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($BIOLOGIA+$GEOGRAFIA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(221,235,247); //azul
		    			$this->pdf->Cell(7,8,round((($FISICA+$QUIMICA)/2),0),'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($FISICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($FISICA<61)and($FISICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($FISICA<76)and($FISICA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$FISICA,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($QUIMICA<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($QUIMICA<61)and($QUIMICA>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($QUIMICA<76)and($QUIMICA>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$QUIMICA,'TBLR',0,'C','1');
		    			
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($COSMO<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($COSMO<61)and($COSMO>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($COSMO<76)and($COSMO>60)) {$this->pdf->SetFillColor(198,255,175);}
		    			$this->pdf->Cell(7,8,$COSMO,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(255,255,205); //amalelo 
		    			if ($RELIGION<51) {$this->pdf->SetFillColor(250,104,102);} elseif (($RELIGION<61)and($RELIGION>50)){$this->pdf->SetFillColor(221,200,255);}elseif (($RELIGION<76)and($RELIGION>60)) {$this->pdf->SetFillColor(198,255,175);}	    			
		    			$this->pdf->Cell(7,8,$RELIGION,'TBLR',0,'C','1');
		    			$this->pdf->SetFillColor(189,215,238); //azul
		    			$this->pdf->SetFont('Arial', 'B', 8);
		    			$this->pdf->Cell(10,8,$notafinal,'TBLR',0,'C','1');
						
					    $this->pdf->Ln(7);
					//}				

				}

				$j=0;
				$this->pdf->AddPage();
				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Ln(7);
	            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
	            $this->pdf->Ln(5);
	            $this->pdf->Cell(200,5,'4 bimestres',0,0,'C');
				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	
				
				arsort($row);
				foreach ($row as $honor)
				{
					$j++;
					if($j<=4)
					{
						$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
						$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
						$this->pdf->Cell(14,8,$honor['nota'],'TBLR',0,'R','1');
						$this->pdf->Ln(7);		
					}
					
				}

				$this->pdf->SetAutoPageBreak(false);			
				$this->pdf->SetFont('Arial','BU',12);			
	            $this->pdf->Cell(200,8,utf8_decode('PROMEDIO POR CAMPOS DE SABERES'),0,0,'C');            
	            $this->pdf->SetFont('Arial','B',10);

				$this->pdf->Ln(14);
				$this->pdf->SetFont('Arial', 'B', 8);
				$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CAMPO DE SABERES Y CONOCIMIENTOS','TBLR',0,'C','1');
				$this->pdf->Cell(14,8,'NOTA','TBLR',0,'C','1');
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255); 
				$this->pdf->Ln(7);	

				$k=0;
				$sc1=0;$sc2=0;$sc3=0;$sc4=0;								
				foreach ($est as $campo)
				{
					$k++;
					$sc1=$sc1+$campo['comunidad'];
					$sc2=$sc2+$campo['ciencia'];
					$sc3=$sc3+$campo['vida'];
					$sc4=$sc4+$campo['cosmos'];				
					
				}

				$this->pdf->Cell(12,8,'1','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COMUNIDAD Y SOCIEDAD','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc1/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);	
				$this->pdf->Cell(12,8,'2','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'CIENCIA TECNOLOGIA Y PRODUCCION','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc2/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'3','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'VIDA TIERRA TERRITORIO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc3/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				$this->pdf->Cell(12,8,'4','TBLR',0,'L','1');
				$this->pdf->Cell(80,8,'COSMOS Y PENSAMIENTO','TBLR',0,'L','1');
				$this->pdf->Cell(14,8,round($sc4/$k,0),'TBLR',0,'R','1');
				$this->pdf->Ln(7);
				
				
				$this->pdf->Ln(40);
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
			}

		}
	

	}
/*******************BOLETINES******************************/
	public function printboletin($id)
	{
			//print_r($id);

		$notlimit=substr($id,0,strpos($id,"."));
		$bi2=substr($id,strpos($id,".")+1,1);
		$idcur=substr($id,strpos($id,".")+3,strpos($id,"_")-6);
		$gestion=substr($id,strpos($id,"_")+1,strlen($id));

		//print_r($notlimit."-".$bi2."-".$idcur."-".$gestion);
		
		$curso=$this->estud->get_print_curso_pdf($idcur);
					
		$nivel=$curso->nivel;
		$curso1=$curso->curso;
		
		$this->load->library('pdf');
		$idsql="primaria";
					
		
		if(($nivel=='PRIMARIA MAÑANA')OR($nivel=='PRIMARIA TARDE'))
		{			
			$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
			ob_start();
			$this->pdf=new Pdf('Letter');
			foreach ($estudiante as $list) 
			{
				
				$idest=$list->idest;
				
				$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);	
				
				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
	            $this->pdf->setX(55);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
	            $this->pdf->setX(78);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
	            $this->pdf->SetX(97);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
	    		$this->pdf->setX(38);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
	            $this->pdf->setX(70); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode("PRIMARIA COMUN. VOC."),0,0,'L');	
	            $this->pdf->SetX(115);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
	            $this->pdf->SetX(138);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('AP. PATERNO: '),0,0,'L');
	    		$this->pdf->setX(55);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,strtoupper(utf8_decode($list->appat)),0,0,'L');
	    		$this->pdf->Ln('6');
	            $this->pdf->setX(15); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('AP. MATERNO: '),0,0,'L');		            
	            $this->pdf->setX(55); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,strtoupper(utf8_decode($list->apmat)),0,0,'L');	
	            $this->pdf->Ln('6');
	            $this->pdf->SetX(15);
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(15,5,utf8_decode('NOMBRES:'),0,0,'L');
	            $this->pdf->SetX(55);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(65,5,strtoupper(utf8_decode($list->nombres)),0,0,'L');
	            $this->pdf->Ln('6');

	            $this->pdf->SetLeftMargin(15);
	    		$this->pdf->SetRightMargin(15);
	    		$this->pdf->SetFillColor(192,192,192);
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		$this->pdf->Cell(8,21,'NUM','TBL',0,'L','1');
	    		$this->pdf->Cell(12,21,'SIGLA','TBL',0,'C','1');
	    		$this->pdf->Cell(60,21,utf8_decode('ÁREA'),'TBL',0,'C','1');
	    		$this->pdf->Cell(98,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(95);
	    		$this->pdf->Cell(80,7,'BIMESTRE','TBLR',0,'C','1');
	    		$this->pdf->Cell(18,14,'PRO ANUAL','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetX(95);
	    		$this->pdf->Cell(10,7,'1ER','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'2DO','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'3RO','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'4TO','TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->SetFillColor(255,255,255);
	    		$this->pdf->SetFont('Arial', '', 8);
	    		$this->pdf->Cell(8,7,'1','TBL',0,'L','1');
	    		$this->pdf->Cell(12,14,'LCO','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE1+$notabi->INGLES1)/2),0),'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE2+$notabi->INGLES2)/2),0),'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE3+$notabi->INGLES3)/2),0),'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE4+$notabi->INGLES4)/2),0),'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,14,round((round((($notabi->LENGUAJE1+$notabi->INGLES1)/2),0)+round((($notabi->LENGUAJE2+$notabi->INGLES2)/2),0)+round((($notabi->LENGUAJE3+$notabi->INGLES3)/2),0)+round((($notabi->LENGUAJE4+$notabi->INGLES4)/2)))/4,0),'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'2','TBLR',0,'L','1');
	    		$this->pdf->SetX(35);
	    		$this->pdf->Cell(60,7,'INGLES','TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->INGLES1,'TBLR',0,'C','1');
	    		$this->pdf->SetX(115);
	    		$this->pdf->Cell(10,7,$notabi->INGLES2,'TBLR',0,'C','1');
	    		$this->pdf->SetX(135);
	    		$this->pdf->Cell(10,7,$notabi->INGLES3,'TBLR',0,'C','1');
	    		$this->pdf->SetX(155);
	    		$this->pdf->Cell(10,7,$notabi->INGLES4,'TBLR',0,'C','1');
	    		$this->pdf->SetX(175);
	    		$this->pdf->SetX(195);
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'3','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'LEX','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->SOCIALES1+$notabi->SOCIALES2+$notabi->SOCIALES3+$notabi->SOCIALES4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'4','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'CS','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN FÍSICA Y DEPORTES'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'5','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'EFD','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN MUSICAL'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MUSICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->MUSICA1+$notabi->MUSICA2+$notabi->MUSICA3+$notabi->MUSICA4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'6','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'EM','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('ARTES PLÁSTICAS Y VISUALES'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'7','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'APV','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('MATEMÁTICAS'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'8','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'MAT','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('TÉCNICA TECNOLÓGICA'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->INFORMATICA4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->INFORMATICA1+$notabi->INFORMATICA2+$notabi->INFORMATICA3+$notabi->INFORMATICA4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'9','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'TTG','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,utf8_decode('CIENCIAS NATURALES'),'TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->CIENCIAS1+$notabi->CIENCIAS2+$notabi->CIENCIAS3+$notabi->CIENCIAS4)/4,0),'TBLR',0,'C','1');
	    		
	    		$this->pdf->Ln(7);
	    		$this->pdf->Cell(8,7,'10','TBLR',0,'L','1');
	    		$this->pdf->Cell(12,7,'VER','TBLR',0,'C','1');
	    		$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
	    		$this->pdf->Cell(18,7,round(($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/4,0),'TBLR',0,'C','1');

			    $this->pdf->Ln(40);

			}
			$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
			ob_end_flush();
			
		}
		
		if(($nivel=='SECUNDARIA MAÑANA')OR($nivel=='SECUNDARIA TARDE'))
		{
			$idsql="secundaria";

			$curso=$this->estud->get_print_curso_pdf($idcur);
			
			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			
			if(($curso1=='PRIMERO A')OR($curso1=='PRIMERO B')OR($curso1=='SEGUNDO A')OR($curso1=='SEGUNDO B'))
			{		
				
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				ob_start();
				$this->pdf=new Pdf('Letter');
				foreach ($estudiante as $list) 
				{
				
					$idest=$list->idest;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);			

					$this->pdf->AddPage();
					$this->pdf->AliasNbPages();
					$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
					$this->pdf->SetFont('Arial','BU',15);
					$this->pdf->Cell(30);
		            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
		            $this->pdf->Ln('15');            
		            $this->pdf->Cell(30);            
					$this->pdf->setXY(15,45);
					$this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
		            $this->pdf->setXY(35,45);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
		            $this->pdf->setX(55);  
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(45,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		            $this->pdf->setX(75);  
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
		            $this->pdf->SetX(97);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
		            $this->pdf->Ln('6'); 

		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		    		$this->pdf->setX(35);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
		            $this->pdf->setX(75); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
		            $this->pdf->SetX(138);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
		            
		            $this->pdf->Line(10,60,205,60);		            
		            $this->pdf->Ln('12');
		            
		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AP. PATERNO: '),0,0,'L');
		    		$this->pdf->setX(55);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($list->appat),0,0,'L');
		    		$this->pdf->Ln('6');
		            $this->pdf->setX(15); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('AP. MATERNO: '),0,0,'L');		            
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($list->apmat),0,0,'L');	
		            $this->pdf->Ln('6');
		            $this->pdf->SetX(15);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(15,5,utf8_decode('NOMBRES:'),0,0,'L');
		            $this->pdf->SetX(55);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($list->nombres),0,0,'L');
		            $this->pdf->Ln('6');
		            
		    		$this->pdf->SetLeftMargin(15);
		    		$this->pdf->SetRightMargin(15);
		    		$this->pdf->SetFillColor(192,192,192);
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->Ln(5);
		    		$this->pdf->Cell(8,21,'NUM','TBL',0,'L','1');
		    		$this->pdf->Cell(12,21,'SIGLA','TBL',0,'C','1');
		    		$this->pdf->Cell(60,21,utf8_decode('ÁREA'),'TBL',0,'C','1');
		    		$this->pdf->Cell(98,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(80,7,'BIMESTRE','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'PRO ANUAL','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(10,7,'1ER','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'2DO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'3RO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'4TO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetFillColor(255,255,255);
		    		$this->pdf->SetFont('Arial', '', 8);
		    		$this->pdf->Cell(8,7,'1','TBL',0,'L','1');
		    		$this->pdf->Cell(12,14,'LCO','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE1+$notabi->QUECHUA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE2+$notabi->QUECHUA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE3+$notabi->QUECHUA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE4+$notabi->QUECHUA4)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,round((round((($notabi->LENGUAJE1+$notabi->QUECHUA1)/2),0)+round((($notabi->LENGUAJE2+$notabi->QUECHUA2)/2),0)+round((($notabi->LENGUAJE3+$notabi->QUECHUA3)/2),0)+round((($notabi->LENGUAJE4+$notabi->QUECHUA4)/2),0))/4,0),'TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'2','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,'QUECHUA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA4,'TBLR',0,'C','1');
		    		$this->pdf->SetX(175);		    	
		    		$this->pdf->SetX(195);

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'3','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'LEX','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUA EXTRANJERA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'4','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'5','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EFD','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN FÍSICA Y DEPORTES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'6','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EM','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN MUSICAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'7','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'APV','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('ARTES PLÁSTICAS Y VISUALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'8','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'MAT','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('MATEMÁTICAS'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'9','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,21,'TTG','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('TÉCNICA TECNOLÓGICA GENERAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,21,round((($notabi->INFORMATICA1+$notabi->INFORMATICA1+$notabi->INFORMATICA1)/3),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,21,round((($notabi->FISICA2+$notabi->QUIMICA2+$notabi->INFORMATICA2)/3),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,21,round((($notabi->FISICA3+$notabi->QUIMICA3+$notabi->INFORMATICA3)/3),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,21,round((($notabi->FISICA4+$notabi->QUIMICA4+$notabi->INFORMATICA4)/3),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    				    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'10','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('FISICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->FISICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->FISICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);		    		
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');		    		
		    		$this->pdf->Ln(7);

		    		$this->pdf->Cell(8,7,'11','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('QUIMICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);

		    		$this->pdf->Cell(8,7,'12','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CN','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('CIENCIAS NATURALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'13','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CFS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('COSMOVISIONES, FILOSOFIA Y PSICOLOGIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'14','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'VER','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    				    		

				    $this->pdf->Ln(40);

				}
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}

			if(($curso1=='TERCERO A')OR($curso1=='TERCERO B'))
			{		
												
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				ob_start();
				$this->pdf=new Pdf('Letter');
				foreach ($estudiante as $list) 
				{				
					$idest=$list->idest;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);	
					
					$this->pdf->AddPage();
					$this->pdf->AliasNbPages();
					$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
					$this->pdf->SetFont('Arial','BU',15);
					$this->pdf->Cell(30);
		            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
		            $this->pdf->Ln('15');            
		            $this->pdf->Cell(30);            
					$this->pdf->setXY(15,45);
					$this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
		            $this->pdf->setXY(35,45);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
		            $this->pdf->setX(55);  
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(45,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		            $this->pdf->setX(75);  
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
		            $this->pdf->SetX(97);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
		            $this->pdf->Ln('6'); 

		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		    		$this->pdf->setX(35);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
		            $this->pdf->setX(75); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
		            $this->pdf->SetX(138);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
		            
		            $this->pdf->Line(10,60,205,60);		            
		            $this->pdf->Ln('12');
		            
		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AP. PATERNO: '),0,0,'L');
		    		$this->pdf->setX(55);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($list->appat),0,0,'L');
		    		$this->pdf->Ln('6');
		            $this->pdf->setX(15); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('AP. MATERNO: '),0,0,'L');		            
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($list->apmat),0,0,'L');	
		            $this->pdf->Ln('6');
		            $this->pdf->SetX(15);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(15,5,utf8_decode('NOMBRES:'),0,0,'L');
		            $this->pdf->SetX(55);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($list->nombres),0,0,'L');
		            $this->pdf->Ln('6');

		            
		    		$this->pdf->SetLeftMargin(15);
		    		$this->pdf->SetRightMargin(15);
		    		$this->pdf->SetFillColor(192,192,192);
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->Ln(5);
		    		$this->pdf->Cell(8,21,'NUM','TBL',0,'L','1');
		    		$this->pdf->Cell(12,21,'AREA','TBL',0,'C','1');
		    		$this->pdf->Cell(60,21,'MATERIA','TBL',0,'C','1');
		    		$this->pdf->Cell(98,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(80,7,'BIMESTRE','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'PRO ANUAL','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(10,7,'1ER','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'2DO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'3RO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'4TO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetFillColor(255,255,255);
		    		$this->pdf->SetFont('Arial', '', 8);
		    		$this->pdf->Cell(8,7,'1','TBL',0,'L','1');
		    		$this->pdf->Cell(12,14,'LCO','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE1+$notabi->QUECHUA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE2+$notabi->QUECHUA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->LENGUAJE3+$notabi->QUECHUA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'','TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'2','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,'QUECHUA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUECHUA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'3','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'LEX','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUA EXTRANJERA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'4','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'5','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EFD','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN FÍSICA Y DEPORTES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'6','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EM','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN MUSICAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'7','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'APV','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('ARTES PLÁSTICAS Y VISUALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'8','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'MAT','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('MATEMÁTICAS'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'9','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'TTG','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('TÉCNICA TECNOLÓGICA GENERAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    				    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'10','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,14,'FQ','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('FISICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA1+$notabi->QUIMICA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA2+$notabi->QUIMICA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA3,'TBL|R',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA3+$notabi->QUIMICA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'11','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('QUÍMICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');


		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'12','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CN','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('CIENCIAS NATURALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'13','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CFS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('COSMOVISIONES, FILOSOFIA Y PSICOLOGIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'14','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'VER','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

				    $this->pdf->Ln(40);		

				}
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}
			if(($curso1=='CUARTO A')OR($curso1=='CUARTO B'))
			{		
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				ob_start();
				$this->pdf=new Pdf('Letter');
				foreach ($estudiante as $list) 
				{				
					$idest=$list->idest;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);
					
					
					$this->pdf->AddPage();
					$this->pdf->AliasNbPages();
					$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
					$this->pdf->SetFont('Arial','BU',15);
					$this->pdf->Cell(30);
		            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
		            $this->pdf->Ln('15');            
		            $this->pdf->Cell(30);            
					$this->pdf->setXY(15,45);
					$this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
		            $this->pdf->setXY(35,45);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
		            $this->pdf->setX(55);  
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(45,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		            $this->pdf->setX(75);  
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
		            $this->pdf->SetX(97);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
		            $this->pdf->Ln('6'); 

		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		    		$this->pdf->setX(35);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
		            $this->pdf->setX(75); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
		            $this->pdf->SetX(138);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
		            
		            $this->pdf->Line(10,60,205,60);		            
		            $this->pdf->Ln('12');
		            
		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AP. PATERNO: '),0,0,'L');
		    		$this->pdf->setX(55);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($list->appat),0,0,'L');
		    		$this->pdf->Ln('6');
		            $this->pdf->setX(15); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('AP. MATERNO: '),0,0,'L');		            
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($list->apmat),0,0,'L');	
		            $this->pdf->Ln('6');
		            $this->pdf->SetX(15);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(15,5,utf8_decode('NOMBRES:'),0,0,'L');
		            $this->pdf->SetX(55);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($list->nombres),0,0,'L');
		            $this->pdf->Ln('6');

		            
		    		$this->pdf->SetLeftMargin(15);
		    		$this->pdf->SetRightMargin(15);
		    		$this->pdf->SetFillColor(192,192,192);
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->Ln(5);
		    		$this->pdf->Cell(8,21,'NUM','TBL',0,'L','1');
		    		$this->pdf->Cell(12,21,'SIGLA','TBL',0,'C','1');
		    		$this->pdf->Cell(60,21,utf8_decode('ÁREA'),'TBL',0,'C','1');
		    		$this->pdf->Cell(98,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(80,7,'BIMESTRE','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'PRO ANUAL','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(10,7,'1ER','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'2DO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'3RO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'4TO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetFillColor(255,255,255);
		    		$this->pdf->SetFont('Arial', '', 8);
		    		$this->pdf->Cell(8,7,'1','TBL',0,'L','1');
		    		$this->pdf->Cell(12,7,'LCO','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'','TBLR',0,'C','1');

		    		

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'2','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'LEX','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUA EXTRANJERA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'3','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'CIENCIAS SOCIALES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->SOCIALES4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'4','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EFD','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN FÍSICA Y DEPORTES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'5','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EM','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN MUSICAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');//$notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24+$notabi->MUSICA34),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24+$notabi->MUSICA34),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'6','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'APV','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('ARTES PLÁSTICAS Y VISUALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'7','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'MAT','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('MATEMÁTICAS'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'8','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'TTG','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('TÉCNICA TECNOLÓGICA GENERAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->INFORMATICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    				    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'9','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,14,'FQ','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('FISICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA1+$notabi->QUIMICA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA2+$notabi->QUIMICA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA3+$notabi->QUIMICA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA4+$notabi->QUIMICA4)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'10','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('QUÍMICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);		    
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA4,'TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');


		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'11','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CN','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('CIENCIAS NATURALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->CIENCIAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'12','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CFS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('COSMOVISIONES, FILOSOFIA Y PSICOLOGIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');

		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'13','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'VER','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,'','TBLR',0,'C','1');
		    				    	
				    $this->pdf->Ln(40);	
					
				}
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}
			if(($curso1=='QUINTO A')OR($curso1=='QUINTO B')OR($curso1=='SEXTO A')OR($curso1=='SEXTO B'))
			{		
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				ob_start();
				$this->pdf=new Pdf('Letter');
				foreach ($estudiante as $list) 
				{				
					$idest=$list->idest;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);
				
					$this->pdf->AddPage();
					$this->pdf->AliasNbPages();
					$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
					$this->pdf->SetFont('Arial','BU',15);
					$this->pdf->Cell(30);
		            $this->pdf->Cell(135,8,utf8_decode('RENDIMIENTO ACADÉMICO - '),0,0,'C');
		            $this->pdf->Ln('15');            
		            $this->pdf->Cell(30);            
					$this->pdf->setXY(15,45);
					$this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(35,5,utf8_decode('ID CURSO: '),0,0,'L');
		            $this->pdf->setXY(35,45);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($idcur),0,0,'L');
		            $this->pdf->setX(55);  
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(45,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		            $this->pdf->setX(75);  
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(15,5,utf8_decode($curso->curso),0,0,'L');
		            $this->pdf->SetX(97);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(55,5,utf8_decode('GESTION:'),0,0,'C');
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(55,5,utf8_decode($gestion),0,0,'C');
		            $this->pdf->Ln('6'); 

		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AÑO ESCOL: '),0,0,'L');
		    		$this->pdf->setX(35);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($curso->corto),0,0,'L');
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('NIVEL: '),0,0,'L');
		            $this->pdf->setX(75); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($curso->nivel),0,0,'L');	
		            $this->pdf->SetX(115);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(65,5,utf8_decode('UNID EDU:'),0,0,'L');
		            $this->pdf->SetX(138);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($curso->colegio),0,0,'L');
		            
		            $this->pdf->Line(10,60,205,60);		            
		            $this->pdf->Ln('12');
		            
		            $this->pdf->setX(15);
		            $this->pdf->SetFont('Arial','B',10);
		    		$this->pdf->Cell(30,5,utf8_decode('AP. PATERNO: '),0,0,'L');
		    		$this->pdf->setX(55);
		    		$this->pdf->SetFont('Arial','',10);
		    		$this->pdf->Cell(30,5,utf8_decode($list->appat),0,0,'L');
		    		$this->pdf->Ln('6');
		            $this->pdf->setX(15); 
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(60,5,utf8_decode('AP. MATERNO: '),0,0,'L');		            
		            $this->pdf->setX(55); 
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(60,5,utf8_decode($list->apmat),0,0,'L');	
		            $this->pdf->Ln('6');
		            $this->pdf->SetX(15);
		            $this->pdf->SetFont('Arial','B',10);
		            $this->pdf->Cell(15,5,utf8_decode('NOMBRES:'),0,0,'L');
		            $this->pdf->SetX(55);
		            $this->pdf->SetFont('Arial','',10);
		            $this->pdf->Cell(65,5,utf8_decode($list->nombres),0,0,'L');
		            $this->pdf->Ln('6');

		            
		    		$this->pdf->SetLeftMargin(15);
		    		$this->pdf->SetRightMargin(15);
		    		$this->pdf->SetFillColor(192,192,192);
		    		$this->pdf->SetFont('Arial', 'B', 8);
		    		$this->pdf->Ln(5);
		    		$this->pdf->Cell(8,21,'NUM','TBL',0,'L','1');
		    		$this->pdf->Cell(12,21,'SIGLA','TBL',0,'C','1');
		    		$this->pdf->Cell(60,21,'AREA','TBL',0,'C','1');
		    		$this->pdf->Cell(98,7,'VALORACION CUANTITATIVA','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(80,7,'BIMESTRE','TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,'PRO ANUAL','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetX(95);
		    		$this->pdf->Cell(10,7,'1ER','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'2DO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'3RO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'4TO','TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,'P.A.','TBLR',0,'C','1');
		    		$this->pdf->Ln(7);
		    		$this->pdf->SetFillColor(255,255,255);
		    		$this->pdf->SetFont('Arial', '', 8);
		    		$this->pdf->Cell(8,7,'1','TBL',0,'L','1');
		    		$this->pdf->Cell(12,7,'LCO','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUAJE','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->LENGUAJE4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->LENGUAJE1+$notabi->LENGUAJE2+$notabi->LENGUAJE3+$notabi->LENGUAJE4)/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'2','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'LEX','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'LENGUA EXTRANJERA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES11+$notabi->INGLES21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES12+$notabi->INGLES22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES13+$notabi->INGLES23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INGLES14+$notabi->INGLES24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round((($notabi->INGLES11+$notabi->INGLES21)+($notabi->INGLES12+$notabi->INGLES22)+($notabi->INGLES13+$notabi->INGLES23)+($notabi->INGLES14+$notabi->INGLES24))/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'3','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,14,'HC','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'HISTORIA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->HISTORIA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->HISTORIA1+$notabi->CIVICA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->HISTORIA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->HISTORIA2+$notabi->CIVICA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->HISTORIA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->HISTORIA3+$notabi->CIVICA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->HISTORIA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->HISTORIA4+$notabi->CIVICA4)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,round((round((($notabi->HISTORIA1+$notabi->CIVICA1)/2),0)+round((($notabi->HISTORIA2+$notabi->CIVICA2)/2),0)+round((($notabi->HISTORIA3+$notabi->CIVICA3)/2),0)+round((($notabi->HISTORIA4+$notabi->CIVICA4)/2),0))/4,0),'TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'4','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,'CIVICA','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->CIVICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->CIVICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->CIVICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,$notabi->CIVICA4,'TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->SetX(195);
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'5','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EFD','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN FÍSICA Y DEPORTES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->EDUFISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->EDUFISICA1+$notabi->EDUFISICA2+$notabi->EDUFISICA3+$notabi->EDUFISICA4)/4,0),'TBLR',0,'C','1');
		    		
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'6','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'EM','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('EDUCACIÓN MUSICAL'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');//$notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31  
		    		$this->pdf->Cell(10,7,($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24+$notabi->MUSICA34),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->MUSICA14+$notabi->MUSICA24+$notabi->MUSICA34),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round((($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31)+($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32)+($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33)+($notabi->MUSICA14+$notabi->MUSICA24+$notabi->MUSICA34))/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'7','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'APV','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('ARTES PLÁSTICAS Y VISUALES'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->ARTPLAST4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->ARTPLAST1+$notabi->ARTPLAST2+$notabi->ARTPLAST3+$notabi->ARTPLAST4)/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'8','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'MAT','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('MATEMÁTICAS'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->MATEMATICAS4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->MATEMATICAS1+$notabi->MATEMATICAS2+$notabi->MATEMATICAS3+$notabi->MATEMATICAS4)/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'9','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'TTE','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('TÉCNICA TECNOLÓGICA ESPECIALIZADA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA11+$notabi->INFORMATICA21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA11+$notabi->INFORMATICA21),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA12+$notabi->INFORMATICA22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA12+$notabi->INFORMATICA22),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA13+$notabi->INFORMATICA23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA13+$notabi->INFORMATICA23),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA14+$notabi->INFORMATICA24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,($notabi->INFORMATICA14+$notabi->INFORMATICA24),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round((($notabi->INFORMATICA11+$notabi->INFORMATICA21)+($notabi->INFORMATICA12+$notabi->INFORMATICA22)+($notabi->INFORMATICA13+$notabi->INFORMATICA23)+($notabi->INFORMATICA14+$notabi->INFORMATICA24))/4,0),'TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'10','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,14,'BG','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('BIOLOGIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->BIOLOGIA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->BIOLOGIA1+$notabi->GEOGRAFIA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->BIOLOGIA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->BIOLOGIA2+$notabi->GEOGRAFIA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->BIOLOGIA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->BIOLOGIA3+$notabi->GEOGRAFIA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->BIOLOGIA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->BIOLOGIA4+$notabi->GEOGRAFIA4)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,round((round((($notabi->BIOLOGIA1+$notabi->GEOGRAFIA1)/2),0)+round((($notabi->BIOLOGIA2+$notabi->GEOGRAFIA2)/2),0)+round((($notabi->BIOLOGIA3+$notabi->GEOGRAFIA3)/2),0)+round((($notabi->BIOLOGIA4+$notabi->GEOGRAFIA4)/2),0))/4,0),'TBLR',0,'C','1');

		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'11','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('GEOGRAFIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->GEOGRAFIA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->GEOGRAFIA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->GEOGRAFIA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,$notabi->GEOGRAFIA4,'TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->SetX(195);
		    				    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'12','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,14,'FQ','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('FISICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA1+$notabi->QUIMICA1)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA2+$notabi->QUIMICA2)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA3+$notabi->QUIMICA3)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->FISICA4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,14,round((($notabi->FISICA4+$notabi->QUIMICA4)/2),0),'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,14,round((round((($notabi->FISICA1+$notabi->QUIMICA1)/2),0)+round((($notabi->FISICA2+$notabi->QUIMICA2)/2),0)+round((($notabi->FISICA3+$notabi->QUIMICA3)/2),0)+round((($notabi->FISICA4+$notabi->QUIMICA4)/2),0))/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'13','TBLR',0,'L','1');
		    		$this->pdf->SetX(35);
		    		$this->pdf->Cell(60,7,utf8_decode('QUÍMICA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA1,'TBLR',0,'C','1');
		    		$this->pdf->SetX(115);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA2,'TBLR',0,'C','1');
		    		$this->pdf->SetX(135);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA3,'TBLR',0,'C','1');
		    		$this->pdf->SetX(155);
		    		$this->pdf->Cell(10,7,$notabi->QUIMICA4,'TBLR',0,'C','1');
		    		$this->pdf->SetX(175);
		    		$this->pdf->SetX(195);
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'14','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'CFS','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,utf8_decode('COSMOVISIONES, FILOSOFIA Y PSICOLOGIA'),'TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->COSMO4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->COSMO1+$notabi->COSMO2+$notabi->COSMO3+$notabi->COSMO4)/4,0),'TBLR',0,'C','1');
		    		
		    		$this->pdf->Ln(7);
		    		$this->pdf->Cell(8,7,'15','TBLR',0,'L','1');
		    		$this->pdf->Cell(12,7,'VER','TBLR',0,'C','1');
		    		$this->pdf->Cell(60,7,'VAL. ESPIRIT.  Y RELIGIONES','TBL',0,'L','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION1,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION2,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION3,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(10,7,$notabi->RELIGION4,'TBLR',0,'C','1');
		    		$this->pdf->Cell(18,7,round(($notabi->RELIGION1+$notabi->RELIGION2+$notabi->RELIGION3+$notabi->RELIGION4)/4,0),'TBLR',0,'C','1');		    

				    $this->pdf->Ln(40);	
					
				}
				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}
		}
	}

/****************** BONO JUANCITO PINTO ******************************/
	public function printjuancito($id)
	{			
			$notlimit=substr($id,0,strpos($id,"."));
			$bi2=substr($id,strpos($id,".")+1,1);
			$idcur=substr($id,strpos($id,".")+3,strpos($id,"_")-6);
			$gestion=substr($id,strpos($id,"_")+1,strlen($id));

			$curso=$this->estud->get_print_curso_pdf($idcur);

			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			$row[]=array(
						"nota"=>0,
						"nomb"=>'vacio'
				);
			
			$this->load->library('pdf');
			$idsql="primaria";
		
		if(($nivel=='PRIMARIA MAÑANA')OR($nivel=='PRIMARIA TARDE'))
		{			
			$i=0;
			$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
			$sie=$this->estud->get_print_sie($curso->colegio);
			$siecol=$sie->SIE;

			ob_start();
			$this->pdf=new Pdf('Letter');

			$this->pdf->AddPage();
			$this->pdf->AliasNbPages();
			$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
			$this->pdf->SetFont('Arial','BU',15);
			$this->pdf->Cell(30);
            $this->pdf->Cell(135,8,utf8_decode('REGISTRO DE CALIFICACIONES BIMESTRALES'),0,0,'C');           
            $this->pdf->Ln('15');            
            $this->pdf->Cell(30);            
			$this->pdf->setXY(15,45);
			$this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(35,5,utf8_decode('UNID EDU: '),0,0,'L');
            $this->pdf->setXY(35,45);
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,utf8_decode($curso->colegio),0,0,'L');
            $this->pdf->setX(115);  
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(45,5,utf8_decode('SIE: '),0,0,'L');
            $this->pdf->setX(125);  
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(15,5,$siecol,0,0,'L');
           
            $this->pdf->Ln('6'); 

            $this->pdf->setX(15);
            $this->pdf->SetFont('Arial','B',10);
    		$this->pdf->Cell(30,5,utf8_decode('NIVEL: '),0,0,'L');
    		$this->pdf->setX(35);
    		$this->pdf->SetFont('Arial','',10);
    		$this->pdf->Cell(30,5,utf8_decode("PRIMARIA COMUNITARIA VOCACIONAL"),0,0,'L');
            $this->pdf->setX(115); 
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Cell(60,5,utf8_decode('GRADO: '),0,0,'L');
            $this->pdf->setX(135); 
            $this->pdf->SetFont('Arial','',10);
            $this->pdf->Cell(60,5,utf8_decode($curso->curso)." ".utf8_decode($curso->nivel),0,0,'L');	
            
            $this->pdf->Line(10,60,205,60);		            
            $this->pdf->Ln('12');

            $this->pdf->SetLeftMargin(15);
    		$this->pdf->SetRightMargin(15);
    		$this->pdf->SetFillColor(192,192,192);
    		$this->pdf->SetFont('Arial', 'B', 8);
    		$this->pdf->Ln(5);
    		$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
    		$this->pdf->Ln(7);
    			

			foreach ($estudiante as $list) 
			{	
				$i++;
				if($i==28)
				{
					$this->pdf->SetFont('Arial', 'B', 8);
					$this->pdf->AddPage();
					$this->pdf->SetLeftMargin(15);
    				$this->pdf->SetRightMargin(15);
					$this->pdf->SetFillColor(192,192,192);
					$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
		    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
		    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
		    		$this->pdf->Ln(7);

				}
				$this->pdf->SetFont('Arial', '', 8);
				$this->pdf->SetFillColor(255,255,255);	

				$idest=$list->idest;
				$estobserv=$this->estud->get_print_observ($idest);
				//$observ=$estobserv->observ;				
				$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);	

				$prom1=round((round((($notabi->LENGUAJE1+$notabi->INGLES1)/2),0)+$notabi->SOCIALES1+$notabi->EDUFISICA1+$notabi->MUSICA1+$notabi->ARTPLAST1+$notabi->MATEMATICAS1+$notabi->INFORMATICA1+$notabi->CIENCIAS1+$notabi->RELIGION1)/9,0);
				$prom2=round((round((($notabi->LENGUAJE2+$notabi->INGLES2)/2),0)+$notabi->SOCIALES2+$notabi->EDUFISICA2+$notabi->MUSICA2+$notabi->ARTPLAST2+$notabi->MATEMATICAS2+$notabi->INFORMATICA2+$notabi->CIENCIAS2+$notabi->RELIGION2)/9,0);
				$prom3=round((round((($notabi->LENGUAJE3+$notabi->INGLES3)/2),0)+$notabi->SOCIALES3+$notabi->EDUFISICA3+$notabi->MUSICA3+$notabi->ARTPLAST3+$notabi->MATEMATICAS3+$notabi->INFORMATICA3+$notabi->CIENCIAS3+$notabi->RELIGION3)/9,0);

				$nf=round((($prom1+$prom2+$prom3)/3),3);

				$row[]=array(
						"nota"=>$nf,
						"nomb"=>strtoupper(utf8_decode($list->appat." ".$list->apmat." ".$list->nombres))
				);

	    		$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
	    		$this->pdf->Cell(70,7,strtoupper(utf8_decode($list->appat))." ".strtoupper(utf8_decode($list->apmat))." ".strtoupper(utf8_decode($list->nombres)),'TBL',0,'L','1');
	    		$this->pdf->Cell(20,7,$prom1,'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,$prom2,'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,$prom3,'TBL',0,'C','1');
	    		$this->pdf->Cell(30,7,"",'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);
			    
			}
			$this->pdf->Ln(40);

    		//$this->pdf->setXY(100,150);
			$this->pdf->SetFont('Arial','BU',11);
			$this->pdf->Cell(70,5,'                                                     ',0,0,'R');
			$this->pdf->SetFont('Arial','B',11);	
			$this->pdf->Cell(10,5,'                                                     ',0,0,'R');
			$this->pdf->SetFont('Arial','BU',11);
			$this->pdf->Cell(70,5,'                                                     ',0,0,'R');			
			$this->pdf->Ln(5);
			$this->pdf->SetFont('Arial','B',10);				
			$this->pdf->Cell(50,5,utf8_decode("DIRECTOR(A)"),0,0,'R');
			$this->pdf->SetFont('Arial','B',10);	
			$this->pdf->Cell(20,5,'                                                     ',0,0,'R');
			$this->pdf->Cell(60,5,utf8_decode("MAESTRO(A)"),0,0,'R');
			$this->pdf->Ln(5);
            $this->pdf->Cell(45,5,utf8_decode('FIRMA '),0,0,'R');
            $this->pdf->Cell(30,5,'                                                     ',0,0,'R');
            $this->pdf->Cell(50,5,utf8_decode('FIRMA '),0,0,'R');
            $this->pdf->SetFont('Arial','',8);


            $j=0;
			$this->pdf->AddPage();
			$this->pdf->SetAutoPageBreak(false);			
			$this->pdf->SetFont('Arial','BU',12);			
            $this->pdf->Cell(200,8,utf8_decode('CUADRO DE HONOR DE CURSO'),0,0,'C');            
            $this->pdf->SetFont('Arial','B',10);
            $this->pdf->Ln(7);
            $this->pdf->Cell(200,5,utf8_decode($curso->colegio),0,0,'C');            
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,utf8_decode($curso->curso.", ".$curso->nivel),0,0,'C');
            $this->pdf->Ln(5);
            $this->pdf->Cell(200,5,utf8_decode("PROMEDIO DE LOS BIMESTRES"),0,0,'C');
			$this->pdf->Ln(14);
			$this->pdf->SetFont('Arial', 'B', 8);
			$this->pdf->Cell(12,8,"NUM",'TBLR',0,'L','1');
			$this->pdf->Cell(80,8,'APELLIDOS Y NOMBRES','TBLR',0,'C','1');
			$this->pdf->Cell(35,8,'PROMEDIO BIMESTRE','TBLR',0,'C','1');
			$this->pdf->SetFont('Arial', '', 8);
			$this->pdf->SetFillColor(255,255,255); 
			$this->pdf->Ln(7);	
			

			arsort($row);

			foreach ($row as $honor)
			{
				$j++;
				if($j<=5)
				{
					$this->pdf->Cell(12,8,$j,'TBLR',0,'L','1');
					$this->pdf->Cell(80,8,$honor['nomb'],'TBLR',0,'L','1');
					$this->pdf->Cell(35,8,$honor['nota'],'TBLR',0,'R','1');
					$this->pdf->Ln(7);		
				}
				
			}

            $this->pdf->Ln(40);
			$this->pdf->Output("cuadro -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
			ob_end_flush();
			
		}
		
		if(($nivel=='SECUNDARIA MAÑANA')OR($nivel=='SECUNDARIA TARDE'))
		{
			
			$idsql="secundaria";

			$curso=$this->estud->get_print_curso_pdf($idcur);
			$sie=$this->estud->get_print_sie($curso->colegio);
			$siecol=$sie->SIE;
			
			$nivel=$curso->nivel;
			$curso1=$curso->curso;
			
			if(($curso1=='PRIMERO A')OR($curso1=='PRIMERO B')OR($curso1=='SEGUNDO A')OR($curso1=='SEGUNDO B'))
			{		
				$i=0;
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				ob_start();
				$this->pdf=new Pdf('Letter');

				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('REGISTRO DE CALIFICACIONES BIMESTRALES'),0,0,'C');
	            $this->pdf->Ln('15');            
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('UNID EDU: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->colegio),0,0,'L');
	            $this->pdf->setX(115);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('SIE: '),0,0,'L');
	            $this->pdf->setX(125);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,$siecol,0,0,'L');
	           
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('NIVEL: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode("SECUNDARIA COMUNITARIA PRODUCTIVA"),0,0,'L');
	            $this->pdf->setX(115); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('GRADO: '),0,0,'L');
	            $this->pdf->setX(135); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->curso)." ".utf8_decode($curso->nivel),0,0,'L');	
	           
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');

	            $this->pdf->SetLeftMargin(15);
	    		$this->pdf->SetRightMargin(15);
	    		$this->pdf->SetFillColor(192,192,192);
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);

				foreach ($estudiante as $list) 
				{
					$i++;
					if($i==28)
					{
						$this->pdf->SetFont('Arial', 'B', 8);
						$this->pdf->AddPage();
						$this->pdf->SetLeftMargin(15);
	    				$this->pdf->SetRightMargin(15);
						$this->pdf->SetFillColor(192,192,192);
						$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
			    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
			    		$this->pdf->Ln(7);

					}
					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);	

					$idest=$list->idest;					
					$estobserv=$this->estud->get_print_observ($idest);
					$observ=$estobserv->observ;
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);			

					$prom1=round(($notabi->LENGUAJE1+$notabi->QUECHUA1+($notabi->INGLES11+$notabi->INGLES21)+$notabi->SOCIALES1+$notabi->EDUFISICA1+$notabi->MUSICA1+$notabi->ARTPLAST1+$notabi->MATEMATICAS1+$notabi->INFORMATICA1+$notabi->INFORMATICA1+$notabi->INFORMATICA1+$notabi->CIENCIAS1+$notabi->COSMO1+$notabi->RELIGION1)/14,0);

					$prom2=round(($notabi->LENGUAJE2+$notabi->QUECHUA2+($notabi->INGLES12+$notabi->INGLES22)+$notabi->SOCIALES2+$notabi->EDUFISICA2+$notabi->MUSICA2+$notabi->ARTPLAST2+$notabi->MATEMATICAS2+$notabi->FISICA2+$notabi->QUIMICA2+$notabi->INFORMATICA2+$notabi->CIENCIAS2+$notabi->COSMO2+$notabi->RELIGION2)/14,0);

					$prom3=round(($notabi->LENGUAJE3+$notabi->QUECHUA3+($notabi->INGLES13+$notabi->INGLES23)+$notabi->SOCIALES3+$notabi->EDUFISICA3+$notabi->MUSICA3+$notabi->ARTPLAST3+$notabi->MATEMATICAS3+$notabi->FISICA3+$notabi->QUIMICA3+$notabi->INFORMATICA3+$notabi->CIENCIAS3+$notabi->COSMO3+$notabi->RELIGION3)/14,0);

							            
			        $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
		    		$this->pdf->Cell(70,7,strtoupper(utf8_decode($list->appat))." ".strtoupper(utf8_decode($list->apmat))." ".strtoupper(utf8_decode($list->nombres)),'TBL',0,'L','1');
		    		$this->pdf->Cell(20,7,$prom1,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom2,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom3,'TBL',0,'C','1');
		    		$this->pdf->Cell(30,7,$observ,'TBLR',0,'C','1');
		    		$this->pdf->Ln(7);		            

				}

				$this->pdf->Ln(40);
	    		//$this->pdf->setXY(100,150);
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','B',11);	
				$this->pdf->Cell(10,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');			
				$this->pdf->Ln(5);
				$this->pdf->SetFont('Arial','B',10);				
				$this->pdf->Cell(50,5,utf8_decode("DIRECTOR(A)"),0,0,'R');
				$this->pdf->SetFont('Arial','B',10);	
				$this->pdf->Cell(20,5,'                                                     ',0,0,'R');
				$this->pdf->Cell(60,5,utf8_decode("MAESTRO(A)"),0,0,'R');
				$this->pdf->Ln(5);
	            $this->pdf->Cell(45,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->Cell(30,5,'                                                     ',0,0,'R');
	            $this->pdf->Cell(50,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->SetFont('Arial','',8);

				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}
			
			if(($curso1=='TERCERO A')OR($curso1=='TERCERO B'))
			{		
				$i=0;							
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				$sie=$this->estud->get_print_sie($curso->colegio);
				$siecol=$sie->SIE;

				ob_start();
				$this->pdf=new Pdf('Letter');

				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);
	            $this->pdf->Cell(135,8,utf8_decode('REGISTRO DE CALIFICACIONES BIMESTRALES'),0,0,'C');
	            $this->pdf->Ln('15');                        
	            $this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('UNID EDU: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->colegio),0,0,'L');
	            $this->pdf->setX(115);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('SIE: '),0,0,'L');
	            $this->pdf->setX(125);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,$siecol,0,0,'L');
	           
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('NIVEL: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode("SECUNDARIA COMUNITARIA PRODUCTIVA"),0,0,'L');
	            $this->pdf->setX(115); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('GRADO: '),0,0,'L');
	            $this->pdf->setX(135); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->curso)." ".utf8_decode($curso->nivel),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');

				$this->pdf->SetLeftMargin(15);
	    		$this->pdf->SetRightMargin(15);
	    		$this->pdf->SetFillColor(192,192,192);
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);

				foreach ($estudiante as $list) 
				{				
					$i++;
					if($i==28)
					{
						$this->pdf->SetFont('Arial', 'B', 8);
						$this->pdf->AddPage();
						$this->pdf->SetLeftMargin(15);
	    				$this->pdf->SetRightMargin(15);
						$this->pdf->SetFillColor(192,192,192);
						$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
			    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
			    		$this->pdf->Ln(7);

					}
					$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);	

					$idest=$list->idest;					
					$estobserv=$this->estud->get_print_observ($idest);
					$observ=$estobserv->observ;	
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);	
												            
					$prom1=round(($notabi->LENGUAJE1+$notabi->QUECHUA1+($notabi->INGLES11+$notabi->INGLES21)+$notabi->SOCIALES1+$notabi->EDUFISICA1+($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31)+$notabi->ARTPLAST1+$notabi->MATEMATICAS1+$notabi->INFORMATICA1+$notabi->FISICA1+$notabi->QUIMICA1+$notabi->CIENCIAS1+$notabi->COSMO1+$notabi->RELIGION1)/14,0);

					$prom2=round(($notabi->LENGUAJE2+$notabi->QUECHUA2+($notabi->INGLES12+$notabi->INGLES22)+$notabi->SOCIALES2+$notabi->EDUFISICA2+($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32)+$notabi->ARTPLAST2+$notabi->MATEMATICAS2+$notabi->INFORMATICA2+$notabi->FISICA2+$notabi->QUIMICA2+$notabi->CIENCIAS2+$notabi->COSMO2+$notabi->RELIGION2)/14,0);

					$prom3=round(($notabi->LENGUAJE3+$notabi->QUECHUA3+($notabi->INGLES13+$notabi->INGLES23)+$notabi->SOCIALES3+$notabi->EDUFISICA3+($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33)+$notabi->ARTPLAST3+$notabi->MATEMATICAS3+$notabi->INFORMATICA3+$notabi->FISICA3+$notabi->QUIMICA3+$notabi->CIENCIAS3+$notabi->COSMO3+$notabi->RELIGION3)/14,0);

		            $this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
		    		$this->pdf->Cell(70,7,strtoupper(utf8_decode($list->appat))." ".strtoupper(utf8_decode($list->apmat))." ".strtoupper(utf8_decode($list->nombres)),'TBL',0,'L','1');
		    		$this->pdf->Cell(20,7,$prom1,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom2,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom3,'TBL',0,'C','1');
		    		$this->pdf->Cell(30,7,$observ,'TBLR',0,'C','1');
		    		$this->pdf->Ln(7);	

				}
				$this->pdf->Ln(40);
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','B',11);	
				$this->pdf->Cell(10,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');			
				$this->pdf->Ln(5);
				$this->pdf->SetFont('Arial','B',10);				
				$this->pdf->Cell(50,5,utf8_decode("DIRECTOR(A)"),0,0,'R');
				$this->pdf->SetFont('Arial','B',10);	
				$this->pdf->Cell(20,5,'                                                     ',0,0,'R');
				$this->pdf->Cell(60,5,utf8_decode("MAESTRO(A)"),0,0,'R');
				$this->pdf->Ln(5);
	            $this->pdf->Cell(45,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->Cell(30,5,'                                                     ',0,0,'R');
	            $this->pdf->Cell(50,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->SetFont('Arial','',8);

				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();
				
			}

			
			if(($curso1=='CUARTO A')OR($curso1=='CUARTO B'))
			{		
				$i=0;
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				$sie=$this->estud->get_print_sie($curso->colegio);
				$siecol=$sie->SIE;

				ob_start();
				$this->pdf=new Pdf('Letter');

				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);         
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('UNID EDU: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->colegio),0,0,'L');
	            $this->pdf->setX(115);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('SIE: '),0,0,'L');
	            $this->pdf->setX(125);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,$siecol,0,0,'L');
	           
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('NIVEL: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode("SECUNDARIA COMUNITARIA PRODUCTIVA"),0,0,'L');
	            $this->pdf->setX(115); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('GRADO: '),0,0,'L');
	            $this->pdf->setX(135); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->curso)." ".utf8_decode($curso->nivel),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');
			
				$this->pdf->SetLeftMargin(15);
	    		$this->pdf->SetRightMargin(15);
	    		$this->pdf->SetFillColor(192,192,192);
	    		$this->pdf->SetFont('Arial', 'B', 8);
	    		$this->pdf->Ln(5);
	    		$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);

				foreach ($estudiante as $list) 
				{				
					$i++;
					if($i==28)
					{

						$this->pdf->SetFont('Arial', 'B', 8);
						$this->pdf->AddPage();
						$this->pdf->SetLeftMargin(15);
	    				$this->pdf->SetRightMargin(15);
						$this->pdf->SetFillColor(192,192,192);
						$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
			    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    	}
			    	$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);	

					$idest=$list->idest;
					$estobserv=$this->estud->get_print_observ($idest);
					$observ=$estobserv->observ;					
					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$prom1=round(($notabi->LENGUAJE1+($notabi->INGLES11+$notabi->INGLES21)+$notabi->SOCIALES1+$notabi->EDUFISICA1+($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31)+$notabi->ARTPLAST1+$notabi->MATEMATICAS1+$notabi->INFORMATICA1+$notabi->FISICA1+$notabi->QUIMICA1+$notabi->CIENCIAS1+$notabi->COSMO1+$notabi->RELIGION1)/13,0);

					$prom2=round(($notabi->LENGUAJE2+($notabi->INGLES12+$notabi->INGLES22)+$notabi->SOCIALES2+$notabi->EDUFISICA2+($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32)+$notabi->ARTPLAST2+$notabi->MATEMATICAS2+$notabi->INFORMATICA2+$notabi->FISICA2+$notabi->QUIMICA2+$notabi->CIENCIAS2+$notabi->COSMO2+$notabi->RELIGION2)/13,0);

					$prom3=round(($notabi->LENGUAJE3+($notabi->INGLES13+$notabi->INGLES23)+$notabi->SOCIALES3+$notabi->EDUFISICA3+($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33)+$notabi->ARTPLAST3+$notabi->MATEMATICAS3+$notabi->INFORMATICA3+$notabi->FISICA3+$notabi->QUIMICA3+$notabi->CIENCIAS3+$notabi->COSMO3+$notabi->RELIGION3)/13,0);


					$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
		    		$this->pdf->Cell(70,7,strtoupper(utf8_decode($list->appat))." ".strtoupper(utf8_decode($list->apmat))." ".strtoupper(utf8_decode($list->nombres)),'TBL',0,'L','1');
		    		$this->pdf->Cell(20,7,$prom1,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom2,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom3,'TBL',0,'C','1');
		    		$this->pdf->Cell(30,7,$observ,'TBLR',0,'C','1');
		    		$this->pdf->Ln(7);	
				}
				$this->pdf->Ln(40);
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','B',11);	
				$this->pdf->Cell(10,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');			
				$this->pdf->Ln(5);
				$this->pdf->SetFont('Arial','B',10);				
				$this->pdf->Cell(50,5,utf8_decode("DIRECTOR(A)"),0,0,'R');
				$this->pdf->SetFont('Arial','B',10);	
				$this->pdf->Cell(20,5,'                                                     ',0,0,'R');
				$this->pdf->Cell(60,5,utf8_decode("MAESTRO(A)"),0,0,'R');
				$this->pdf->Ln(5);
	            $this->pdf->Cell(45,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->Cell(30,5,'                                                     ',0,0,'R');
	            $this->pdf->Cell(50,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->SetFont('Arial','',8);

				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}

			
			if(($curso1=='QUINTO A')OR($curso1=='QUINTO B')OR($curso1=='SEXTO A')OR($curso1=='SEXTO B'))
			{		
				$i=0;
				$estudiante=$this->estud->ejec_sql_estudiante($idcur,$gestion);
				$sie=$this->estud->get_print_sie($curso->colegio);
				$siecol=$sie->SIE;

				ob_start();
				$this->pdf=new Pdf('Letter');

				$this->pdf->AddPage();
				$this->pdf->AliasNbPages();
				$this->pdf->SetTitle("Boletin de Notas - Don Bosco");
				$this->pdf->SetFont('Arial','BU',15);
				$this->pdf->Cell(30);            
				$this->pdf->setXY(15,45);
				$this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(35,5,utf8_decode('UNID EDU: '),0,0,'L');
	            $this->pdf->setXY(35,45);
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,utf8_decode($curso->colegio),0,0,'L');
	            $this->pdf->setX(115);  
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(45,5,utf8_decode('SIE: '),0,0,'L');
	            $this->pdf->setX(125);  
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(15,5,$siecol,0,0,'L');
	           
	            $this->pdf->Ln('6'); 

	            $this->pdf->setX(15);
	            $this->pdf->SetFont('Arial','B',10);
	    		$this->pdf->Cell(30,5,utf8_decode('NIVEL: '),0,0,'L');
	    		$this->pdf->setX(35);
	    		$this->pdf->SetFont('Arial','',10);
	    		$this->pdf->Cell(30,5,utf8_decode("SECUNDARIA COMUNITARIA PRODUCTIVA"),0,0,'L');
	            $this->pdf->setX(115); 
	            $this->pdf->SetFont('Arial','B',10);
	            $this->pdf->Cell(60,5,utf8_decode('GRADO: '),0,0,'L');
	            $this->pdf->setX(135); 
	            $this->pdf->SetFont('Arial','',10);
	            $this->pdf->Cell(60,5,utf8_decode($curso->curso)." ".utf8_decode($curso->nivel),0,0,'L');
	            
	            $this->pdf->Line(10,60,205,60);		            
	            $this->pdf->Ln('12');

	            $this->pdf->SetFont('Arial', 'B', 8);			
				$this->pdf->SetLeftMargin(15);
				$this->pdf->SetRightMargin(15);
				$this->pdf->SetFillColor(192,192,192);
				$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
	    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
	    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
	    		$this->pdf->Ln(7);

				foreach ($estudiante as $list) 
				{				
					$i++;
					if($i==28)
					{

						$this->pdf->SetFont('Arial', 'B', 8);
						$this->pdf->AddPage();
						$this->pdf->SetLeftMargin(15);
	    				$this->pdf->SetRightMargin(15);
						$this->pdf->SetFillColor(192,192,192);
						$this->pdf->Cell(10,7,'NUM','TBL',0,'L','1');
			    		$this->pdf->Cell(70,7,'APELLIDOS Y NOMBRES','TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('1er BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('2do BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(20,7,utf8_decode('3ro BIM'),'TBL',0,'C','1');
			    		$this->pdf->Cell(30,7,utf8_decode('OBSERVACIONES'),'TBLR',0,'C','1');
			    		$this->pdf->Ln(7);
			    	}
			    	$this->pdf->SetFont('Arial', '', 8);
					$this->pdf->SetFillColor(255,255,255);	

					$idest=$list->idest;
					$estobserv=$this->estud->get_print_observ($idest);

					$observ=$estobserv->observ;

					$notabi=$this->estud->ejec_sql_boletin($idcur,$idest,$gestion,$idsql,$curso1);

					$prom1=round(($notabi->LENGUAJE1+($notabi->INGLES11+$notabi->INGLES21)+(($notabi->HISTORIA1+$notabi->CIVICA1)/2)+$notabi->EDUFISICA1+($notabi->MUSICA11+$notabi->MUSICA21+$notabi->MUSICA31)+$notabi->ARTPLAST1+$notabi->MATEMATICAS1+($notabi->INFORMATICA11+$notabi->INFORMATICA21)+(($notabi->FISICA1+$notabi->QUIMICA1)/2)+(($notabi->BIOLOGIA1+$notabi->GEOGRAFIA1)/2)+$notabi->COSMO1+$notabi->RELIGION1)/12,0);

					$prom2=round(($notabi->LENGUAJE2+($notabi->INGLES12+$notabi->INGLES22)+(($notabi->HISTORIA2+$notabi->CIVICA2)/2)+$notabi->EDUFISICA2+($notabi->MUSICA12+$notabi->MUSICA22+$notabi->MUSICA32)+$notabi->ARTPLAST2+$notabi->MATEMATICAS2+($notabi->INFORMATICA12+$notabi->INFORMATICA22)+(($notabi->FISICA2+$notabi->QUIMICA2)/2)+(($notabi->BIOLOGIA2+$notabi->GEOGRAFIA2)/2)+$notabi->COSMO2+$notabi->RELIGION2)/12,0);

					$prom3=round(($notabi->LENGUAJE3+($notabi->INGLES13+$notabi->INGLES23)+(($notabi->HISTORIA3+$notabi->CIVICA3)/2)+$notabi->EDUFISICA3+($notabi->MUSICA13+$notabi->MUSICA23+$notabi->MUSICA33)+$notabi->ARTPLAST3+$notabi->MATEMATICAS3+($notabi->INFORMATICA13+$notabi->INFORMATICA23)+(($notabi->FISICA3+$notabi->QUIMICA3)/2)+(($notabi->BIOLOGIA3+$notabi->GEOGRAFIA3)/2)+$notabi->COSMO3+$notabi->RELIGION3)/12,0);

					
					$this->pdf->Cell(10,7,$i,'TBL',0,'L','1');
		    		$this->pdf->Cell(70,7,strtoupper(utf8_decode($list->appat))." ".strtoupper(utf8_decode($list->apmat))." ".strtoupper(utf8_decode($list->nombres)),'TBL',0,'L','1');
		    		$this->pdf->Cell(20,7,$prom1,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom2,'TBL',0,'C','1');
		    		$this->pdf->Cell(20,7,$prom3,'TBL',0,'C','1');
		    		$this->pdf->Cell(30,7,$observ,'TBLR',0,'C','1');
		    		$this->pdf->Ln(7);	
				
			   					
				}
				$this->pdf->Ln(40);
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','B',11);	
				$this->pdf->Cell(10,5,'                                                     ',0,0,'R');
				$this->pdf->SetFont('Arial','BU',11);
				$this->pdf->Cell(70,5,'                                                     ',0,0,'R');			
				$this->pdf->Ln(5);
				$this->pdf->SetFont('Arial','B',10);				
				$this->pdf->Cell(50,5,utf8_decode("DIRECTOR(A)"),0,0,'R');
				$this->pdf->SetFont('Arial','B',10);	
				$this->pdf->Cell(20,5,'                                                     ',0,0,'R');
				$this->pdf->Cell(60,5,utf8_decode("MAESTRO(A)"),0,0,'R');
				$this->pdf->Ln(5);
	            $this->pdf->Cell(45,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->Cell(30,5,'                                                     ',0,0,'R');
	            $this->pdf->Cell(50,5,utf8_decode('FIRMA '),0,0,'R');
	            $this->pdf->SetFont('Arial','',8);

				$this->pdf->Output("Boletines -".$curso->corto."- ".$curso->nivel." -".$gestion.".pdf", 'I');
				ob_end_flush();

			}
		}
		
	}

	public function printxls($id)
	{
		/*
		require_once APPPATH."/third_party/phpexcel/phpexcel.php";
		require_once APPPATH."/third_party/phpexcel/PHPExcel/Writer/Excel2007.php";
		$list=$this->estud->get_print_estud_pdf($id);
		$curso=$this->estud->get_print_curso_pdf($id);

		//print_r($curso->corto);

		
		$this->objPHPExcel=new PHPExcel();
		$this->objPHPExcel->getProperties()->setCreator("");
		$this->objPHPExcel->getProperties()->setLastModifieldBy("");
		$this->objPHPExcel->getProperties()->setTitle("");
		$this->objPHPExcel->getProperties()->setSubject("");
		$this->objPHPExcel->getProperties()->setDescription("");
		
		
		$this->objPHPExcel->setActiveSheetIndex(0);

		$this->objPHPExcel->getActiveSheet()->SetCellValue('A1','IDEST');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('B1','RUDE');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('C1','CI');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('D1','CODIGO');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('E1','PATERNO');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('F1','MATERNO');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('G1','NOMBRES');
		$this->objPHPExcel->getActiveSheet()->SetCellValue('H1','GENERO');

		$row=2;

		foreach ($list as $estud) {
			
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->rude);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->ci);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->codigo);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->appaterno);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->apmaterno);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->nombres);
			$this->objPHPExcel->getActiveSheet()->SetCellValue('A'.$row,$estud->genero);

			$row++;
		}

		$filename="Lista Alumnos -".$curso->corto."- ".$curso->nivel." -".$curso->gestion.".xlsx";
		$this->objPHPExcel->getActiveSheet()->setTitle("Lista Alumnos ".$curso->corto);
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment;filename="'.$filename.'"');
		header('Cache-Control: max-age=0');

		$writer=PHPExcel_IOFactory::createWriter($objPHPExcel,'Excel2007');
		$writer->save('php://output');
		exit;
		*/


	}

	
	

}
